<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R2P265ZP7M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-R2P265ZP7M');
</script>
<!-- End Google Analytics -->


  
  <title>LET US GO ABROAD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="a blog for game programmer">
<meta property="og:type" content="website">
<meta property="og:title" content="LET US GO ABROAD">
<meta property="og:url" content="https://baemincheon.github.io/index.html">
<meta property="og:site_name" content="LET US GO ABROAD">
<meta property="og:description" content="a blog for game programmer">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="MinCheon Bae">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="LET US GO ABROAD" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">LET US GO ABROAD</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/2020/02/03/home-page/index.html">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://baemincheon.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="2024-difference-between-copy-and-cat-in-combining-files" class="article article-type-2024" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/05/13/difference-between-copy-and-cat-in-combining-files/" class="article-date">
  <time datetime="2024-05-13T13:46:37.000Z" itemprop="datePublished">2024-05-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/05/13/difference-between-copy-and-cat-in-combining-files/">Difference between copy and cat in combining files</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a><em><code>Overview</code></em></h1><p>There are some commands for combining files such as <code>copy</code> and <code>cat</code>. Respectively, <code>copy</code> is a command for Windows prompt and <code>cat</code> is a command for Unix prompt. You can check the specifications at official documentations below:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/copy">https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/copy</a></li>
<li><a target="_blank" rel="noopener" href="https://www.man7.org/linux/man-pages/man1/cat.1.html">https://www.man7.org/linux/man-pages/man1/cat.1.html</a></li>
</ul>
<h1 id="Comparison-1"><a href="#Comparison-1" class="headerlink" title="Comparison #1"></a><em><code>Comparison #1</code></em></h1><p>Suppose we have two text files, <code>a.txt</code> and <code>b.txt</code>. Each of them has simple contents.</p>
<img src="/2024/05/13/difference-between-copy-and-cat-in-combining-files/01.png" class="">

<img src="/2024/05/13/difference-between-copy-and-cat-in-combining-files/02.png" class="">

<p>We gotta combine them into one text file, <code>c.txt</code>.</p>
<p>In Windows, it would be like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\qmffk\Downloads&gt;copy a.txt + b.txt c.txt</span><br><span class="line">a.txt</span><br><span class="line">b.txt</span><br><span class="line">        1 file(s) copied.</span><br><span class="line"></span><br><span class="line">C:\Users\qmffk\Downloads&gt;type c.txt</span><br><span class="line">hello, a !hello, b !</span><br><span class="line">C:\Users\qmffk\Downloads&gt;</span><br></pre></td></tr></table></figure>

<p>In Linux, it would be like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">thanang@ROSS-DESKTOP:/mnt/d/test$ cat a.txt b.txt &gt; c.txt</span><br><span class="line">thanang@ROSS-DESKTOP:/mnt/d/test$ cat c.txt</span><br><span class="line">hello, a !hello, b !thanang@ROSS-DESKTOP:/mnt/d/test$</span><br></pre></td></tr></table></figure>

<p>Both look like the same, but there is a difference between two <code>c.txt</code>.</p>
<img src="/2024/05/13/difference-between-copy-and-cat-in-combining-files/03.png" class="">

<p>Using <a target="_blank" rel="noopener" href="https://winmerge.org/downloads/?lang=en">WinMerge</a>, we can see the additional character <code>1A</code> (in hex) at Windowsâ€™ <code>c.txt</code>. In short, the character <code>1A</code> (<code>26</code> in decimal) is appended for indicating an EOF (&#x3D; End Of File). This is why this is mentioned in the documentation. (For more information about the character <code>1A / 032 / SUB / Substitute</code>, visit <a target="_blank" rel="noopener" href="https://www.ascii-code.com/">here</a>)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">...You can copy an ASCII text file that uses an end-of-file character (CTRL+Z) to indicate the end of the file...</span><br><span class="line"></span><br><span class="line">...To copy a file called memo.doc to letter.doc in the current drive and ensure that an end-of-file character (CTRL+Z) is at the end of the copied file...</span><br></pre></td></tr></table></figure>

<p>So, how do we prevent from appending the EOF character ? This is also mentioned in the documentation.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The effect of /b depends on its position in the commandâ€“line string: - If /b follows source, the copy command copies the entire file, including any end-of-file character (CTRL+Z). - If /b follows destination, the copy command doesn&#x27;t add an end-of-file character (CTRL+Z).</span><br></pre></td></tr></table></figure>

<h1 id="Comparison-2"><a href="#Comparison-2" class="headerlink" title="Comparison #2"></a><em><code>Comparison #2</code></em></h1><p>Do combine <code>a.txt</code> and <code>b.txt</code> into <code>c.txt</code> again.</p>
<p>In Windows, it would be like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\qmffk\Downloads&gt;copy /b a.txt + b.txt c.txt</span><br><span class="line">a.txt</span><br><span class="line">b.txt</span><br><span class="line">        1 file(s) copied.</span><br><span class="line"></span><br><span class="line">C:\Users\qmffk\Downloads&gt;type c.txt</span><br><span class="line">hello, a !hello, b !</span><br><span class="line">C:\Users\qmffk\Downloads&gt;</span><br></pre></td></tr></table></figure>

<p>In Linux, it would be the same with before.</p>
<img src="/2024/05/13/difference-between-copy-and-cat-in-combining-files/04.png" class="">

<p>Using WinMerge, we can see they are the same.</p>
<p>So, you should plus the flag <code>/b</code> in <code>copy</code> commandline for experiencing the same result as <code>cat</code> in Unix.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2024/05/13/difference-between-copy-and-cat-in-combining-files/" data-id="clw53237z002tdkqmgm7pc5tk" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2024/05/13/difference-between-copy-and-cat-in-combining-files/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cat/" rel="tag">Cat</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Copy/" rel="tag">Copy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-migration-from-perforce-into-git-in-windows" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/12/04/migration-from-perforce-into-git-in-windows/" class="article-date">
  <time datetime="2023-12-04T13:10:03.000Z" itemprop="datePublished">2023-12-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/12/04/migration-from-perforce-into-git-in-windows/">Migration from Perforce into Git in Windows</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a><em><code>Overview</code></em></h1><p>Sometimes, you have to switch the version control system for some reason. In this post, I will cover how to migrate Perforce stream into Git repository. I have confirmed that the method in this post works only in Windows, but you might be able to accomplish the same result with a similar way.</p>
<h1 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a><em><code>Prerequisites</code></em></h1><p>First of all, you should have Git and Perforce installed. Any latest version would be okay. Plus, you should be able to use their commands through the command prompt. For instance, the commands below should be working:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; p4 -V</span><br><span class="line">Perforce - The Fast Software Configuration Management System.</span><br><span class="line">Copyright 1995-2023 Perforce Software.  All rights reserved.</span><br><span class="line">This product includes software developed by the OpenSSL Project</span><br><span class="line">for use in the OpenSSL Toolkit (http://www.openssl.org/)</span><br><span class="line">Version of OpenSSL Libraries: OpenSSL 1.1.1u  30 May 2023</span><br><span class="line">See &#x27;p4 help [ -l ] legal&#x27; for additional license information on</span><br><span class="line">these licenses and others.</span><br><span class="line">Extensions/scripting support built-in.</span><br><span class="line">Parallel sync threading built-in.</span><br><span class="line">Rev. P4/NTX64/2023.1/2468153 (2023/07/24).</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; git -v</span><br><span class="line">git version 2.42.0.windows.2</span><br></pre></td></tr></table></figure>

<p>Second, you should have Python installed. The version after 2.7 would be okay. (eg. 2.8 or 3.5) Plus, you should be able to use its commands through the command prompt. For instance, the commands below should be working:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; python -V</span><br><span class="line">Python 3.11.6</span><br></pre></td></tr></table></figure>

<p>The last one, you have to change your system locale settings if you had written the description of changelist with non-ascii codes. You can enable the option <code>Beta: Use Unicode UTF-8 for worldwide language support</code> from the depth of <code>Control Panel/All Control Panel Items/Region/Administrative/Change system locale...</code>.</p>
<img src="/2023/12/04/migration-from-perforce-into-git-in-windows/01.png" class="">

<p>Unless the option enabled, the commit message from migration result can be seen as <code>untranslatable</code> if the description was written with non-ascii codes.</p>
<img src="/2023/12/04/migration-from-perforce-into-git-in-windows/02.png" class="">

<p>With the option enabled, the commit message would be migrated properly just like the image below. So, check your descriptions in Perforce and change the system locale settings.</p>
<img src="/2023/12/04/migration-from-perforce-into-git-in-windows/03.png" class="">

<h1 id="Migration"><a href="#Migration" class="headerlink" title="Migration"></a><em><code>Migration</code></em></h1><p>Type the command of format <code>python &lt;path of git-p4&gt; clone //&lt;depot&gt;/&lt;stream&gt;/&lt;directory&gt;@all</code> in prompt. For instance, I can type the command like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; python &quot;C:\Program Files\Git\mingw64\libexec\git-core\git-p4&quot; clone //HellLady/mainline/HellLady@all</span><br></pre></td></tr></table></figure>

<p>Then, all changelists from the <code>//&lt;depot&gt;/&lt;stream&gt;/&lt;directory&gt;</code> will be migrated into a Git repository.</p>
<img src="/2023/12/04/migration-from-perforce-into-git-in-windows/04.png" class="">

<h1 id="Postscript"><a href="#Postscript" class="headerlink" title="Postscript"></a><em><code>Postscript</code></em></h1><p>That is all about the migration. ğŸ˜‚ So simple, but it was hard to know because the official document does not cover the usage in Windows. Anyway, I hope this would be helpful for you. Check <a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-p4">the official document</a> for more details if you also need other commands. Good luck. ğŸ¤</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2023/12/04/migration-from-perforce-into-git-in-windows/" data-id="clw53237t0016dkqmhfsb7ful" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2023/12/04/migration-from-perforce-into-git-in-windows/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Migration/" rel="tag">Migration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Perforce/" rel="tag">Perforce</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-conversion-from-universal-analytics-into-google-analytics-4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/" class="article-date">
  <time datetime="2023-04-10T14:15:57.000Z" itemprop="datePublished">2023-04-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/">Conversion from UA into GA4</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a><em><code>Overview</code></em></h1><p>Google noticed that the support for Universal Analytics will be ended in 2023&#x2F;06&#x2F;30. Check <a target="_blank" rel="noopener" href="https://support.google.com/analytics/answer/12938611">this document</a> for more details.</p>
<p>Therefore, I had to migrate my UA settings into GA4. Here is a solution for Hexo blog, which is the framework I am using for this blog.</p>
<h1 id="Google-Tag"><a href="#Google-Tag" class="headerlink" title="Google Tag"></a><em><code>Google Tag</code></em></h1><p>For activating Google Analytics, Google provides you a tag named as â€œGoogle Tagâ€. First of all, you should find out what tag should be installed. You can find out this at Google Analytics 4â€™s page.</p>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/02.png" class="">

<p>Click the button <code>Admin</code>.</p>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/03.png" class="">

<p>Click the button <code>Account Access Management</code>.</p>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/04.png" class="">

<p>Click the button <code>Data Streams</code>.</p>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/05.png" class="">

<p>Click the right arrow at your data stream.</p>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/06.png" class="">

<p>Click the right arrow at the option <code>Configure tag settings</code>.</p>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/07.png" class="">

<p>Click the button <code>Installation instructions</code>.</p>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/08.png" class="">

<p>Check out the code that you should include manually. This is the Google Tag for analytics.</p>
<h1 id="Theme-Config"><a href="#Theme-Config" class="headerlink" title="Theme Config"></a><em><code>Theme Config</code></em></h1><img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/01.png" class="">

<p>Most of themes for Hexo have the config file for Google Analytics. You can find it by just searching â€œgoogle_analyticsâ€ with text.</p>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/09.png" class="">

<p>Especially, <code>google-analytics.ejs</code> file would be containing the Google Tag.</p>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/10.png" class="">
<br/>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/11.png" class="">

<p>The tag is inserted at the front of page of every post in your blog, so you can check that with <code>View page source</code>. Thus, you should replace the Google Tag with new one. Copy the new one we have prepared and paste it to the <code>google-analytics.ejs</code> file. Here are the commits I used for that.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/BaeMinCheon/let-us-go-abroad/commit/076b8a509f1c317cd2b92d875d00945c1ac2a718">https://github.com/BaeMinCheon/let-us-go-abroad/commit/076b8a509f1c317cd2b92d875d00945c1ac2a718</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/BaeMinCheon/let-us-go-abroad/commit/b3ca2983b70daa46acbb8fb1387922ed0320a25f">https://github.com/BaeMinCheon/let-us-go-abroad/commit/b3ca2983b70daa46acbb8fb1387922ed0320a25f</a></li>
</ul>
<h1 id="Result"><a href="#Result" class="headerlink" title="Result"></a><em><code>Result</code></em></h1><p>After the setup, the data stream will be constructed. But, it would take some timeâ€¦about 1 day or 2 days ? So just keep calm and wait for that.</p>
<img src="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/12.png" class="">

<p>When it constructed successfully, you can see the result <code>DATA FLOWING</code> just like above at <code>GA4 / Admin / Account Access Management / Setup Assistant</code>.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/" data-id="clw53237t0012dkqmcizf2lq2" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GoogleAnalytics/" rel="tag">GoogleAnalytics</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-promotion-for-online-lecture-of-unrealengine-01" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/12/12/promotion-for-online-lecture-of-unrealengine-01/" class="article-date">
  <time datetime="2022-12-12T13:40:33.000Z" itemprop="datePublished">2022-12-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/12/12/promotion-for-online-lecture-of-unrealengine-01/">The promotion for online lecture of UnrealEngine</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <br/>

<img src="/2022/12/12/promotion-for-online-lecture-of-unrealengine-01/01.png" class="">

<br/>

<hr>
<p>Hello, this is Ross Bae, a game programmer.<br>I had a great opportunity to open a class with Coloso, a platform specializing in online classes.<br>The class is &lt;FPSê²Œì„ ê°œë°œë¡œ í•œ ë²ˆì— ì…ë¬¸í•˜ëŠ” ì–¸ë¦¬ì–¼ ì—”ì§„&gt;. And it is supported only in Korean yet.</p>
<p>Currently, UnrealEngine is widely used to the extent that it is used in world-famous games such as Battlegrounds, Fortnite, and Valorant. However, I have seen many people who feel hopeless due to the lack of systematically organized materials and lectures compared to their popularity, so I prepared this class.</p>
<p>In this class, I created a lecture by designing a curriculum so that you can learn the basic knowledge of the UnrealEngine by making FPS games with me, and cover from blueprints to scripting using C++.</p>
<p>You can learn the basic contents of game development using UnrealEngine as well as the knowledge and skills necessary to study UnrealEngine on your own, so it would be a good lecture for those who are interested in UnrealEngine.</p>
<p>It is not easy to get through the world of UnrealEngine using only Blueprint, so if you know how to handle C++ at all, it will be a great help. That is why I would like to deal with C++ in this lecture. However, you donâ€™t have to be afraid of streotypes about C++ because we provide training materials that would be helpful to C++ beginners.</p>
<p>For your information, you can take the course at a significant discount for the current Early Bird period. Therefore, if you are interested, please check the attached link below.</p>
<hr>
<p>ì•ˆë…•í•˜ì„¸ìš”, ê²Œì„ í”„ë¡œê·¸ë˜ë¨¸ ë°°ë¯¼ì²œì…ë‹ˆë‹¤<br>ì´ë²ˆì— ì œê°€ ì¢‹ì€ ê¸°íšŒë¡œ ì˜¨ë¼ì¸ í´ë˜ìŠ¤ ì „ë¬¸ í”Œë«í¼ ì½œë¡œì†Œì™€ í•¨ê»˜<br>&lt;FPSê²Œì„ ê°œë°œë¡œ í•œ ë²ˆì— ì…ë¬¸í•˜ëŠ” ì–¸ë¦¬ì–¼ ì—”ì§„&gt;<br>í´ë˜ìŠ¤ë¥¼ ì—´ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤</p>
<p>í˜„ì¬ ì–¸ë¦¬ì–¼ì—”ì§„ì€ ë°°í‹€ê·¸ë¼ìš´ë“œ, í¬íŠ¸ë‚˜ì´íŠ¸, ë°œë¡œë€íŠ¸ ë“±<br>ì„¸ê³„ì ìœ¼ë¡œ ì €ëª…í•œ ê²Œì„ì— ì“°ì¼ ì •ë„ë¡œ, ë„ë¦¬ ì‚¬ìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤<br>í•˜ì§€ë§Œ, ê·¸ ìœ ëª…ì„¸ì— ë¹„í•´ ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬ëœ ìë£Œë‚˜ ê°•ì˜ê°€ ë¶€ì¡±í•´<br>ë§‰ë§‰í•¨ì„ ëŠë¼ëŠ” ë¶„ë“¤ì„ ë§ì´ ë´ì™”ê¸° ë•Œë¬¸ì—, ì´ë²ˆ ê°•ì˜ë¥¼ ì¤€ë¹„í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤</p>
<p>ì´ë²ˆ í´ë˜ìŠ¤ì—ì„œ ì €ì™€ í•¨ê»˜ FPSê²Œì„ì„<br>ì§ì ‘ ë§Œë“¤ì–´ë³´ë©´ì„œ ì–¸ë¦¬ì–¼ì—”ì§„ì˜ ê¸°ë³¸ì§€ì‹ë“¤ì„ ìµí ìˆ˜ ìˆìœ¼ë©°<br>ë¸”ë£¨í”„ë¦°íŠ¸ë¶€í„° C++ ì„ í™œìš©í•œ ìŠ¤í¬ë¦½íŒ…ê¹Œì§€ ì»¤ë²„í•  ìˆ˜ ìˆë„ë¡<br>ì»¤ë¦¬í˜ëŸ¼ì„ ì„¤ê³„í•˜ì—¬ ê°•ì˜ë¥¼ ì œì‘í–ˆìŠµë‹ˆë‹¤</p>
<p>ì–¸ë¦¬ì–¼ì—”ì§„ì„ í™œìš©í•œ ê²Œì„ê°œë°œì— ê¸°ë³¸ì ì¸ ë‚´ìš©ë“¤ì€ ë¬¼ë¡ <br>ì–¸ë¦¬ì–¼ì—”ì§„ì„ ìŠ¤ìŠ¤ë¡œ ê³µë¶€í•˜ëŠ” ë°ì— í•„ìš”í•œ ì§€ì‹ê³¼ ê¸°ìˆ ë“¤ì„<br>ë°°ìš°ì‹¤ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, í‰ì†Œì— ì–¸ë¦¬ì–¼ì—”ì§„ì—<br>ê´€ì‹¬ì´ ìˆë˜ ë¶„ì´ì‹œë¼ë©´ ì¢‹ì€ ê°•ì˜ê°€ ë  ê²ƒì…ë‹ˆë‹¤</p>
<p>ë¸”ë£¨í”„ë¦°íŠ¸ë§Œìœ¼ë¡œëŠ” ì–¸ë¦¬ì–¼ì—”ì§„ì˜ ì„¸ìƒì„ í—¤ì³ë‚˜ê°€ê¸° ì‰½ì§€ ì•Šê¸°ì—<br>C++ ì„ ì¡°ê¸ˆì´ë¼ë„ ë‹¤ë£° ì¤„ ì•ˆë‹¤ë©´, í° ë„ì›€ì´ ë  ê²ƒì´ê¸°<br>ë•Œë¬¸ì— ì´ë²ˆ ê°•ì˜ì—ì„œ C++ ì„ ë‹¤ë£¨ê³ ì í•©ë‹ˆë‹¤<br>í•˜ì§€ë§Œ, C++ ì…ë¬¸ìë¥¼ ê³ ë ¤í•˜ì—¬ êµìœ¡ìë£Œë¥¼ ë³„ë„ë¡œ ë§Œë“¤ì–´<br>ì œê³µí•˜ë¯€ë¡œ C++ ì— ëŒ€í•œ ì„ ì…ê²¬ ë•Œë¬¸ì— ê²ë¨¹ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤</p>
<p>ì°¸ê³ ë¡œ, í˜„ì¬ ì–¼ë¦¬ë²„ë“œ(ì˜ˆì•½êµ¬ë§¤) ê¸°ê°„ìœ¼ë¡œ í¬ê²Œ í• ì¸ëœ ê¸ˆì•¡ìœ¼ë¡œ ìˆ˜ê°•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤<br>ë”°ë¼ì„œ, ê´€ì‹¬ ìˆëŠ” ë¶„ì€ ì²¨ë¶€ëœ ë§í¬ë¥¼ í†µí•´ ìì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•´ì£¼ì„¸ìš”</p>
<hr>
<p><a target="_blank" rel="noopener" href="https://bit.ly/3iMuyYb">https://bit.ly/3iMuyYb</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2022/12/12/promotion-for-online-lecture-of-unrealengine-01/" data-id="clw53237s000xdkqm114rdu8t" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2022/12/12/promotion-for-online-lecture-of-unrealengine-01/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Lecture/" rel="tag">Lecture</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-retargeting-animations-in-unreal-engine-5" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/10/04/retargeting-animations-in-unreal-engine-5/" class="article-date">
  <time datetime="2022-10-04T13:15:18.000Z" itemprop="datePublished">2022-10-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/10/04/retargeting-animations-in-unreal-engine-5/">Retargeting animations in UnrealEngine 5</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>Environment</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>UnrealEngine</td>
<td><code>version: 5.0.3</code></td>
</tr>
<tr>
<td>Windows 11 Pro</td>
<td><code>build: 22621.521</code></td>
</tr>
</tbody></table>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a><code>Overview</code></h1><p>It is common that an animation asset is binding at a certain <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/4.27/en-US/AnimatingObjects/SkeletalMeshAnimation/Skeleton/">skeleton asset</a>. So you might have experience that you could not utilize the skeleton Aâ€™s animation at the skeleton Bâ€™s animation. Because an animation data is made of trace of bones. Therefore, an animation asset would not be compatible when you attempt to apply it to the different skeleton asset.</p>
<p>Think about two skeletons, A and B. The skeleton A has a bone for head, but the skeleton B does not. An animation asset for the skeleton A would not be compatible with the skeleton B, because the skeleton B does not have a bone for head. Though, you might want to apply it, at least parts of animation without head. Fortunately, UnrealEngine provides you to reuse the animation assets by retargeting bones, even if the number of bones or position of bones are different. That is the â€œRetargeting animationsâ€.</p>
<h1 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a><code>Preparation</code></h1><p>I will explain you while showing an example. First, install the project <a target="_blank" rel="noopener" href="https://www.unrealengine.com/marketplace/en-US/product/lyra">Lyra</a>. You can purchase the project in the UnrealEngine marketplace and install it into your local system. After that, purchase <a target="_blank" rel="noopener" href="https://www.unrealengine.com/marketplace/en-US/product/animation-starter-pack">Animation Starter Pack</a>, too. Both of them are free.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/01.png" class="">

<p>Add <code>Animation Starter Pack</code> into the project <code>Lyra</code> you installed. Now, open it.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/02.png" class="">

<p>You can see the folder <code>AnimStarterPack</code> at the below of <code>Content</code>, and there are several animation assets fit for <code>SK_Mannequin</code>.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/03.png" class="">

<p>Open an animation asset, and you can see the list of animations available in the current skeleton.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/04.png" class="">

<p>Switch to the tab for skeleton, and you can see the skeleton asset with the hierarchy of bones. Okay, we have checked the asset <code>Animation Starter Pack</code>. Jump to the next, the project <code>Lyra</code>.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/05.png" class="">

<p>In the <code>Lyra</code>, there are one skeleton asset, but two skeleton meshes; <code>SKM_Manny</code> and <code>SKM_Quinn</code>. Each of them for male and female appearance.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/06.png" class="">

<p>The name of skeleton asset is the same with the asset <code>Animation Starter Pack</code> with <code>SK_Mannequin</code>. From now on, I will name the skeleton for <code>Lyra</code> as UE5 skeleton, and the skeleton for <code>Animation Starter Pack</code> as UE4 skeleton.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/07.png" class="">

<p>Also, you can find animation assets for UE5 skeleton at <code>Content/Characters/Heroes/Mannequin/Animations/Actions</code>. All we have to do is, retargeting animations from ue4 skeleton into ue5 skeleton, and retargeting animations from ue5 skeleton into ue4 skeleton.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/08.png" class="">

<p>Create a folder <code>RetargetedAnimations</code> at <code>Content/AnimStarterPack</code>. We will save the retargeted animations and so on here. First, you should create IK Rigs for each skeleton mesh.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/09.png" class="">
</br>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/10.png" class="">
</br>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/11.png" class="">

<p>Name them as <code>IKRigUE4</code> and <code>IKRigUE5</code>.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/12.png" class="">
</br>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/13.png" class="">

<p>They might look like this. Huh, it is time to setup the IK Rig.</p>
<h1 id="Setup-IK-Rig"><a href="#Setup-IK-Rig" class="headerlink" title="Setup IK Rig"></a><code>Setup IK Rig</code></h1><img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/14.png" class="">

<p>The IK Rig is used to define many properties, especially for retargeting animations. First of all, you should choose the root of retargeting. It is recommended to choose a <code>pelvis</code> in most cases. (Especially, when it is a human form.) Right click the <code>pelvis</code> and select the <code>Set Retarget Root</code>. Then, the text <code>(Retarget Root)</code> is displayed by the <code>pelvis</code>. After that, UnrealEngine will retarget the animations from the root, <code>pelvis</code>. Do it on both of IK Rig assets.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/15.png" class="">
</br>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/16.png" class="">

<p>Get back to the content browser, create a IK Retargeter. You should choose a source IK Rig to create a IK Retargeter. Choose the IKRigUE4, and name this as <code>UE4_TO_UE5</code>. Open it up.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/17.png" class="">

<p>The source IK Rig is the <code>IKRigUE4</code>. Therefore, you should assign <code>IKRigUE5</code> at the <code>Target IKRig Asset</code>.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/18.png" class="">

<p>Now you can see both of them in the viewport. Try to play an animation from the asset browser.</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/-Xmq0A8bWtA" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<p>Then, the target one will not be animating properly. Just like the video. As you have set the pelvis as a retarget root, it looks like only the pelvis is synchronized, while others are not. The problem is, the hierarchy of bones is different between two skeletons.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/19.png" class="">

<p>For instance, the UE4 skeleton has 3 bones for spine; <code>spine_01</code>, <code>spine_02</code>, and <code>spine_03</code>.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/20.png" class="">

<p>The UE5 skeleton has 5 bones for spine; <code>spine_01</code>, <code>spine_02</code>, <code>spine_03</code>, <code>spine_04</code>, and <code>spine_05</code>. UnrealEngine cannot retarget animations because the number and position of bones are different between two skeletons. So, you should specify how to match the bones, and you can do it with a chain.</p>
<h1 id="Setup-Chain"><a href="#Setup-Chain" class="headerlink" title="Setup Chain"></a><code>Setup Chain</code></h1><img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/21.png" class="">

<p>The IK Rig asset has a panel <code>IK Retargeting</code> beside a panel <code>Asset Browser</code>. You can specify some chains here, and it chains a part of bones as a group. UnrealEngine matches the group of same name when you attempt to retarget animations. Let me show you an example. Add new chain, and name it as <code>leg_left</code>. We are going to group bones for the left leg.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/22.png" class="">

<p>Check the bones. After the pelvis, left leg starts at <code>thigh_l</code> and ends at <code>ball_l</code>. So, set the <code>Start Bone</code> and <code>End Bone</code> of chain <code>leg_left</code>. You have set the chain for left leg in UE4 skeleton. Next, you should set the chain in UE5 skeleton, too.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/23.png" class="">

<p>Create a chain <code>leg_left</code>. Check the bones for left leg. Set the <code>Start Bone</code> and <code>End Bone</code>. Then, we are good to go.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/24.png" class="">

<p>Back to the retargeter asset, click the panel <code>Chain Mapping</code>. And click the button <code>Auto-Map Chains</code>. The <code>Auto-Map Chains</code> will match the chains of similar name. You can also match the chains of different name, but you should do it manually in that case.</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/EK2101WQNC0" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<p>Try to play some animations. You can notice there is a change. Yes, as you can see in the video, the left leg is synchronized. All you have to do is, create chains and match them.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/25.png" class="">

<p>I recommend you to create the chains; <code>leg_right</code>, <code>spine</code>, <code>arm_left</code>, <code>arm_right</code>, <code>head</code>. Here are the chain settings I used for UE4 skeleton.</p>
<table>
<thead>
<tr>
<th>Chain Name</th>
<th>Start Bone</th>
<th>End Bone</th>
</tr>
</thead>
<tbody><tr>
<td>leg_left</td>
<td>thigh_l</td>
<td>ball_l</td>
</tr>
<tr>
<td>leg_right</td>
<td>thigh_r</td>
<td>ball_r</td>
</tr>
<tr>
<td>spine</td>
<td>spine_01</td>
<td>spine_03</td>
</tr>
<tr>
<td>arm_left</td>
<td>clavicle_l</td>
<td>hand_l</td>
</tr>
<tr>
<td>arm_right</td>
<td>clavicle_l</td>
<td>hand_r</td>
</tr>
<tr>
<td>head</td>
<td>neck_01</td>
<td>head</td>
</tr>
</tbody></table>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/26.png" class="">

<p>Unfortunately, UnrealEngine does not support to copy the chain settings yet. So, you should write the same settings in UE5 skeleton.</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/6UqOYwRcv_4" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<p>Back to the retargeter asset, again. Click the button <code>Auto-Map Chains</code>, and try to play some animations. It looks like the video. Does it look like perfect ? No, focus on their hands. You shoud care about fingers, too. (Even for toes if the animation covers them ğŸ¤£)</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/27.png" class="">

<p>I will show you an example for index finger, rest of fingers are your work.</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/L-m4X-hfExY" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<p>After the work for all fingers, it should look like this video.</p>
<h1 id="Edit-Pose"><a href="#Edit-Pose" class="headerlink" title="Edit Pose"></a><code>Edit Pose</code></h1><img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/28.png" class="">

<p>Sometimes, you might want to retarget animations but two skeleton are different each other. Suppose you have a skeleton of pose A, and a skeleton of pose T.</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/w9triL2bnVY" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<p>In this situation, the retargeted animations look weird even you set the chains well. Just like the video. Ohâ€¦it is like the necromorph in the Dead Spaceâ€¦ğŸ˜± It happens due to the pose, the two skeletons are different on the pose. You should edit oneâ€™s pose so that they have the same pose.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/29.png" class="">

<p>Here, I will edit the skeleton of pose T. Let me edit the pose as A. First, click the button <code>Edit Pose</code>.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/30.png" class="">

<p>We have returned to the base pose. Now you can select bones of the target IK Rig.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/31.png" class="">

<p>I recommend you to change the property <code>Target Actor Offset</code> if you need. You can check the rotation more precisely when it is set by 0.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/32.png" class="">
</br>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/33.png" class="">

<p>I have editted the pose by this settings;</p>
<ul>
<li>Rotating the upper arm by -60 degrees on the axis Y.</li>
<li>Rotating the lower arm by +40 degrees on the axis Z.</li>
</ul>
<p>Do this settings on two arms.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/34.png" class="">

<p>Now it seems okay. Then, set a proper value to <code>Target Actor Offset</code>. Click the button <code>Edit Pose</code> to leave the edit mode.</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/poPoFTkDmgk" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<p>You would see the result just like the video. Quite better than before. But, there is onething you should remember about the feature <code>Edit Pose</code>. It is that, you cannot rotate bones not in any chain.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/35.png" class="">

<p>Suppose an IK Rig asset does not have a chain for right leg. As you can see in the screenshot, there is only a chain for left leg. Go to the retargeter asset.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/36.png" class="">

<p>You cannot see the section for right leg, even you have entered the edit mode. So, it is crucial that creating necessary chains before you attempt to edit pose in the retargeter asset.</p>
<h1 id="Export"><a href="#Export" class="headerlink" title="Export"></a><code>Export</code></h1><img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/37.png" class="">

<p>Get back to the UE4 &amp; UE5 skeletons. You could play animations for UE4 skeleton via the <code>Asset Browser</code> in the retargeter asset <code>UE4_TO_UE5</code>. Plus, you can export selected animations to create animation assets for UE5 skeleton, which is the target skeleton.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/38.png" class="">
</br>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/39.png" class="">

<p>Export animations at <code>Content/AnimStarterPack/RetargetedAnimations</code>.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/40.png" class="">

<p>When you open it up, you can see the asset is using the skeletal mesh for UE5 skeleton. Great. It is simple that retargeting animations in opposite direction; UE5 -&gt; UE4.</p>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/41.png" class="">

<ul>
<li>Create a retargeter asset based on <code>IKRigUE5</code>.</li>
<li>Set the <code>Target IKRig Asset</code> as <code>IKRigUE4</code>.</li>
<li>Click the button <code>Auto-Map Chains</code>.</li>
<li>Select animations you want to export.</li>
<li>Export them, profit !</li>
</ul>
<img src="/2022/10/04/retargeting-animations-in-unreal-engine-5/42.png" class="">

<p>You can see it is using the skeletal mesh for UE4 skeleton. ğŸ˜</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2022/10/04/retargeting-animations-in-unreal-engine-5/" data-id="clw53237s0010dkqmfacg2p83" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2022/10/04/retargeting-animations-in-unreal-engine-5/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Animation/" rel="tag">Animation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Retargeting/" rel="tag">Retargeting</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-how-the-rich-text-block-works-in-unrealengine" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/" class="article-date">
  <time datetime="2022-07-28T11:59:20.000Z" itemprop="datePublished">2022-07-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/">How the RichTextBlock works in UnrealEngine (part.1)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>Environment</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>UnrealEngine</td>
<td><code>branch: 5.0</code></td>
</tr>
<tr>
<td>Visual Studio 2022</td>
<td><code>version: 17.2.6</code></td>
</tr>
<tr>
<td>Windows 11 Pro</td>
<td><code>build: 22000.795</code></td>
</tr>
</tbody></table>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a><em><code>Overview</code></em></h1><p>We have learned about the <code>TextBlock</code> in UnrealEngine at <a href="https://baemincheon.github.io/2022/03/22/how-the-text-wrap-works-in-unrealengine/">the previous post</a>. As we saw, the <code>TextBlock</code> provides the function to split a long text into multiple lines. But, it was only for the text, combinations of character.</p>
<p>Sometimes, we want to put something that is not a character in the middle of text. For example, you may want to put an image for key icon into the text that describes characterâ€™s skill. Maybe, you want to highlight a part of the text by coloring it. Furthermore, you could want to put a â€œwidgetâ€ in the middle of text. The widget would interact with the playerâ€™s action so that they can have better experience of the user interface.</p>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/01.png" class="">
<blockquote>
<p>An option description in PUBG Xbox.</p>
</blockquote>
<p>UnrealEngine has a solution for that, <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/UMG/UserGuide/UMGRichTextBlock/">the RichTextBlock widget</a>. You can put an image or anything else in the middle of text. Plus, it also supports auto-wrapping just like at the <code>TextBlock</code>. Now you know why its name is the â€œRichâ€TextBlock. Then, let us check out how the <code>RichTextBlock</code> widget is implemented and how it works.</p>
<h1 id="An-example"><a href="#An-example" class="headerlink" title="An example"></a><em><code>An example</code></em></h1><p>Already there is a tutorial in <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/UMG/UserGuide/UMGRichTextBlock/">the document</a>, but I will show you an another example including how to make your custom <code>RichTextBlock</code> decorator. Suppose you want to display the text like the screenshot below.</p>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/02.png" class="">

<p>The size of <code>SizeBox</code> is (512, 512). The text used in <code>RichTextBlock</code> is here:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Test &lt;Emphasis&gt; Test &lt;/&gt; &lt;somewidget id=&quot;Ferris_02&quot;/&gt; Test &lt;somewidget id=&quot;Ferris_01&quot;/&gt; Test aaa aaa aaa aaa aaa aaa aaa aaa &lt;img id=&quot;Ferris_01&quot;/&gt; aaa &lt;somewidget id=&quot;Ferris_02&quot;/&gt; aaa</span><br></pre></td></tr></table></figure>

<p>As we can see, the images are put in the middle of text. The <code>RichTextBlock</code> parses the input text and decorates the text with your configurations. Without some configurations, the tags such as <code>&lt;Emphasis&gt;</code> and <code>&lt;somewidget&gt;</code> would be displayed as a plain text. Yes, you should do some configurations for using the <code>RichTextBlock</code>.</p>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/03.png" class="">

<p>I have already set some properties, <code>TextStyleSet</code> and <code>DecoratorClasses</code>.</p>
<h1 id="RichTextStyle"><a href="#RichTextStyle" class="headerlink" title="RichTextStyle"></a><em><code>RichTextStyle</code></em></h1><p>The <code>TextStyleSet</code> is used for decorating a text just like a markup. You can specify a font, size, color, and so on with it. I made two data rows in the data table, and that is why some of text was displayed with green color. Check the screenshot below.</p>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/04.png" class="">
<br/>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/05.png" class="">

<p>The <code>RichTextBlock</code> decorates rest of text if you make a <code>Default</code> row. That is why the text not embraced with tags was displayed with white color.</p>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/06.png" class="">

<p>Without the <code>TextStyleSet</code>, the <code>RichTextBlock</code> cannot display the text properly. You can make a data table containing <code>RichTextStyleRow</code> with the instructions.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. Right click on contents browser.</span><br><span class="line">2. find the item `Data Table` at the category `Miscellaneous`, and click it.</span><br><span class="line">3. The dialog `Pick Row Structure` pops up.</span><br><span class="line">4. Click the drop down, and select `RichTextStyleRow`.</span><br></pre></td></tr></table></figure>

<p>Now, you can manipulate the data table. But, you should be careful that the name of data row is the same with the name of tag in the <code>RichTextBlock</code>.</p>
<h1 id="RichImage"><a href="#RichImage" class="headerlink" title="RichImage"></a><em><code>RichImage</code></em></h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Simple struct for rich text styles */</span></span><br><span class="line"><span class="built_in">USTRUCT</span>(Blueprintable, BlueprintType)</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">UMG_API</span> FRichImageRow : <span class="keyword">public</span> FTableRowBase</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_USTRUCT_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, Category = Appearance)</span><br><span class="line">	FSlateBrush Brush;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Allows you to setup an image decorator that can be configured</span></span><br><span class="line"><span class="comment"> * to map certain keys to certain images.  We recommend you subclass this</span></span><br><span class="line"><span class="comment"> * as a blueprint to configure the instance.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Understands the format &lt;img id=&quot;NameOfBrushInTable&quot;&gt;&lt;/&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">UCLASS</span>(Abstract, Blueprintable)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UMG_API</span> URichTextBlockImageDecorator : <span class="keyword">public</span> URichTextBlockDecorator</span><br></pre></td></tr></table></figure>

<p>UnrealEngine provides a decorator class, <code>URichTextBlockImageDecorator</code>. It helps you add an image widget in the middle of text.</p>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/07.png" class="">

<p>Without it, the <code>RichTextBlock</code> cannot create an image from the tag <code>img</code>. You can make a data table containing <code>RichImageRow</code> with the instructions.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. Right click on contents browser.</span><br><span class="line">2. find the item `Data Table` at the category `Miscellaneous`, and click it.</span><br><span class="line">3. The dialog `Pick Row Structure` pops up.</span><br><span class="line">4. Click the drop down, and select `RichImageRow`.</span><br></pre></td></tr></table></figure>

<p>Now, you can manipulate the data table. Also, you should be careful that the name of data row is the same with the name of tag in the <code>RichTextBlock</code> as I mentioned at the <code>RichTextStyle</code>. So, remember it because this mechanism will work on other cases (Decorators using their own data table) too.</p>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/08.png" class="">

<p>However, you need one step more to apply the data table.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Engine/Source/Runtime/UMG/Public/Components/RichTextBlock.h</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**  */</span></span><br><span class="line"><span class="built_in">UPROPERTY</span>(EditAnywhere, Category=Appearance, meta=(RequiredAssetDataTags = <span class="string">&quot;RowStructure=RichTextStyleRow&quot;</span>))</span><br><span class="line">TObjectPtr&lt;<span class="keyword">class</span> <span class="title class_">UDataTable</span>&gt; TextStyleSet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**  */</span></span><br><span class="line"><span class="built_in">UPROPERTY</span>(EditAnywhere, Category=Appearance)</span><br><span class="line">TArray&lt;TSubclassOf&lt;URichTextBlockDecorator&gt;&gt; DecoratorClasses;</span><br></pre></td></tr></table></figure>

<p>The <code>TextStyleSet</code> needs only a data table, but the <code>DecoratorClasses</code> takes a class inherits <code>URichTextBlockDecorator</code>. That is why <code>URichTextBlockImageDecorator</code> inherits that.</p>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/11.png" class="">
<br/>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/10.png" class="">
<br/>
<img src="/2022/07/28/how-the-rich-text-block-works-in-unrealengine/09.png" class="">

<p>So, you should create a blueprint class inherits <code>URichTextBlockImageDecorator</code> because the class <code>URichTextBlockImageDecorator</code> has the UCLASS keyword <code>Abstract</code>. And, assign it into the <code>DecoratorClasses</code> at the <code>RichTextBlock</code> widget. The blueprint class should reference the data table for images.</p>
<h1 id="Custom-decorator"><a href="#Custom-decorator" class="headerlink" title="Custom decorator"></a><em><code>Custom decorator</code></em></h1><p>I have written a custom decorator for this example, the <code>URichTextBlockSomeWidgetDecorator</code>. As you can see in the example, it displays a combination of image and text. First of all, the code for this class is here.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/BaeMinCheon/109b251f1c88ae3f7e73dd711d0cc153">RichTextBlockSomeWidgetDecorator.h</a></li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/BaeMinCheon/6521a88bce86bd4cd60b7b383cf45637">RichTextBlockSomeWidgetDecorator.cpp</a></li>
</ul>
<p>And the followings are the major changes.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestRichTextBlock</span> : ModuleRules</span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TestRichTextBlock</span><span class="params">(ReadOnlyTargetRules Target)</span> : base(Target)</span></span><br><span class="line"><span class="function">	&#123;</span></span><br><span class="line">		PCHUsage = PCHUsageMode.UseExplicitOrSharedPCHs;</span><br><span class="line"></span><br><span class="line">		PublicDependencyModuleNames.<span class="built_in">AddRange</span>(<span class="keyword">new</span> string[] &#123; <span class="string">&quot;Core&quot;</span>, <span class="string">&quot;CoreUObject&quot;</span>, <span class="string">&quot;Engine&quot;</span>, <span class="string">&quot;InputCore&quot;</span>, <span class="string">&quot;HeadMountedDisplay&quot;</span>, <span class="string">&quot;UMG&quot;</span>, <span class="string">&quot;Slate&quot;</span>, <span class="string">&quot;SlateCore&quot;</span> &#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You must add the modules at your <code>Build.cs</code>: <code>UMG</code>, <code>Slate</code>, and <code>SlateCore</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">FRichInlineSomeWidget::Supports</span><span class="params">(<span class="type">const</span> FTextRunParseResults&amp; RunParseResult, <span class="type">const</span> FString&amp; Text)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">bool</span> Result = <span class="literal">false</span>;</span><br><span class="line">	<span class="type">const</span> <span class="type">bool</span> IsContainId = RunParseResult.MetaData.<span class="built_in">Contains</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">	<span class="type">const</span> <span class="type">bool</span> IsNameSomeWidget = RunParseResult.Name == <span class="built_in">TEXT</span>(<span class="string">&quot;somewidget&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (IsContainId &amp;&amp; IsNameSomeWidget)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">const</span> FTextRange&amp; IdRange = RunParseResult.MetaData[<span class="built_in">TEXT</span>(<span class="string">&quot;id&quot;</span>)];</span><br><span class="line">		<span class="type">const</span> FString TagId = Text.<span class="built_in">Mid</span>(IdRange.BeginIndex, IdRange.EndIndex - IdRange.BeginIndex);</span><br><span class="line">		<span class="type">const</span> <span class="type">bool</span> bWarnIfMissing = <span class="literal">false</span>;</span><br><span class="line">		Result = Decorator-&gt;<span class="built_in">FindSomeWidgetRow</span>(*TagId, bWarnIfMissing) != <span class="literal">nullptr</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> Result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>I have changed the tag that my decorator supports. <code>img -&gt; somewidget</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">SRichInlineSomeWidget::Construct</span><span class="params">(<span class="type">const</span> FArguments&amp; InArgs, <span class="type">const</span> FRichSomeWidgetRow* Row, <span class="type">const</span> FTextBlockStyle&amp; TextStyle, TOptional&lt;int32&gt; Width, TOptional&lt;int32&gt; Height, EStretch::Type Stretch)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> FSlateBrush* InBrush = &amp;(Row-&gt;Brush);</span><br><span class="line">	<span class="built_in">check</span>(InBrush)</span><br><span class="line">	<span class="type">const</span> FText InText = Row-&gt;Text;</span><br><span class="line">	<span class="type">const</span> TSharedRef&lt;FSlateFontMeasure&gt; FontMeasure = FSlateApplication::<span class="built_in">Get</span>().<span class="built_in">GetRenderer</span>()-&gt;<span class="built_in">GetFontMeasureService</span>();</span><br><span class="line">	<span class="type">const</span> <span class="type">float</span> MaxHeight = FontMeasure-&gt;<span class="built_in">GetMaxCharacterHeight</span>(TextStyle.Font, <span class="number">1.0f</span>);</span><br><span class="line">	<span class="type">float</span> IconHeight = FMath::<span class="built_in">Max</span>(MaxHeight, InBrush-&gt;ImageSize.Y);</span><br><span class="line">	<span class="keyword">if</span> (Height.<span class="built_in">IsSet</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		IconHeight = Height.<span class="built_in">GetValue</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">float</span> IconWidth = IconHeight;</span><br><span class="line">	<span class="keyword">if</span> (Width.<span class="built_in">IsSet</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		IconWidth = Width.<span class="built_in">GetValue</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	ChildSlot</span><br><span class="line">	[</span><br><span class="line">		<span class="built_in">SNew</span>(SBox)</span><br><span class="line">		[</span><br><span class="line">			<span class="built_in">SNew</span>(SHorizontalBox)</span><br><span class="line"></span><br><span class="line">			+SHorizontalBox::<span class="built_in">Slot</span>()</span><br><span class="line">			.<span class="built_in">AutoWidth</span>()</span><br><span class="line">			.<span class="built_in">VAlign</span>(VAlign_Center)</span><br><span class="line">			[</span><br><span class="line">				<span class="built_in">SNew</span>(SImage)</span><br><span class="line">				.<span class="built_in">Image</span>(InBrush)</span><br><span class="line">			]</span><br><span class="line"></span><br><span class="line">			+SHorizontalBox::<span class="built_in">Slot</span>()</span><br><span class="line">			.<span class="built_in">AutoWidth</span>()</span><br><span class="line">			.<span class="built_in">VAlign</span>(VAlign_Center)</span><br><span class="line">			[</span><br><span class="line">				<span class="built_in">SNew</span>(STextBlock)</span><br><span class="line">				.<span class="built_in">Text</span>(InText)</span><br><span class="line">			]</span><br><span class="line">		]</span><br><span class="line">	];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Used the max value for <code>IconHeight</code> because I wanted to display the image properly. Plus, the decorator has a <code>TextBlock</code> for descripting an image. In the example, a text <code>Ferris_01</code> or <code>Ferris_02</code> is located on the right of Ferrisâ€™ image.</p>
<p>So, you can create a custom decorator like this. Rest works are just similar with <code>RichImage</code>, creating some blueprint classes (decorator and data table) and assigning each other. Let your decorator have awesome functions :)</p>
<h1 id="Preview-of-Part-2"><a href="#Preview-of-Part-2" class="headerlink" title="Preview of Part #2"></a><em><code>Preview of Part #2</code></em></h1><p>At this part, we have seen how to use the <code>RichTextBlock</code> and how to make a custom decorator.</p>
<ul>
<li>Only for a text, you should create a data table and assign it.</li>
<li>For other content, you should create a custom decorator and assign it. But, UnrealEngine has already made a default decorator for an image, <code>URichTextBlockImageDecorator</code>.</li>
<li>When creating a custom decorator, you should know them below:<ul>
<li>Specify an unique tag name. There should be no confliction.</li>
<li>Design a widget layout with Slate. You can reference many examples from engine codes, just find all references of <code>ChildSlot</code>.</li>
<li>Create a SWidget version of your widget if you want to put your widget into the custom decorator. As you can see, the <code>SNew</code> accepts only the class inherits <code>SWidget</code>. In most of cases, it is okay to inherit the class <code>SLeafWidget</code>.</li>
</ul>
</li>
</ul>
<p>At next part, we would find out how does the <code>RichTextBlock</code> wrap its contents. It will be interesting because the <code>RichTextBlock</code> can have an image as a content.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2022/07/28/how-the-rich-text-block-works-in-unrealengine/" data-id="clw53237r000sdkqmaiy003a1" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2022/07/28/how-the-rich-text-block-works-in-unrealengine/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RichTextBlock/" rel="tag">RichTextBlock</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TextBlock/" rel="tag">TextBlock</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-how-the-text-wrap-works-in-unrealengine" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/03/22/how-the-text-wrap-works-in-unrealengine/" class="article-date">
  <time datetime="2022-03-21T15:07:38.000Z" itemprop="datePublished">2022-03-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/03/22/how-the-text-wrap-works-in-unrealengine/">How the text wrap works in UnrealEngine</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>Environment</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>UnrealEngine</td>
<td><code>branch: 5.0</code></td>
</tr>
<tr>
<td>Visual Studio 2022</td>
<td><code>version: 17.1.1</code></td>
</tr>
<tr>
<td>Windows 11 Pro</td>
<td><code>build: 22000.556</code></td>
</tr>
</tbody></table>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a><em><code>Overview</code></em></h1><img src="/2022/03/22/how-the-text-wrap-works-in-unrealengine/01.png" class="">

<p>A TextBlock has an option <code>AutoWrapText</code> and the option makes the TextBlock can wrap its text. Thanks to the option, we can display a text without concerning about breaking lines. For general cases of text, even the option works within very short time, almost 1 tick. How does it possible ? What is the implementation of that option ? Let us find out it in this post.</p>
<img src="/2022/03/22/how-the-text-wrap-works-in-unrealengine/02.png" class="">
<img src="/2022/03/22/how-the-text-wrap-works-in-unrealengine/03.png" class="">

<p>The TextBlock upper has the option turned on. Contrary, the TextBlock lower has the option turned off.</p>
<h1 id="Where-is-the-code"><a href="#Where-is-the-code" class="headerlink" title="Where is the code"></a><em><code>Where is the code</code></em></h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TextWidgetTypes.h</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** True if we&#x27;re wrapping text automatically based on the computed horizontal space for this widget. */</span></span><br><span class="line"><span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadOnly, Category=Wrapping)</span><br><span class="line">uint8 AutoWrapText:<span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>The option is loacted in the class <code>UTextLayoutWidget</code>. We can see the option as the class <code>UTextBlock</code> inherites <code>UTextLayoutWidget</code>. Unfortunately, the variable is not directly used for wrapping text, but used for saving the value of option.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UTextBlock::SynchronizeProperties</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">SynchronizeProperties</span>();</span><br><span class="line"></span><br><span class="line">	TAttribute&lt;FText&gt; TextBinding = <span class="built_in">GetDisplayText</span>();</span><br><span class="line">	TAttribute&lt;FSlateColor&gt; ColorAndOpacityBinding = <span class="built_in">PROPERTY_BINDING</span>(FSlateColor, ColorAndOpacity);</span><br><span class="line">	TAttribute&lt;FLinearColor&gt; ShadowColorAndOpacityBinding = <span class="built_in">PROPERTY_BINDING</span>(FLinearColor, ShadowColorAndOpacity);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( MyTextBlock.<span class="built_in">IsValid</span>() )</span><br><span class="line">	&#123;</span><br><span class="line">		MyTextBlock-&gt;<span class="built_in">SetText</span>( TextBinding );</span><br><span class="line">		MyTextBlock-&gt;<span class="built_in">SetFont</span>( Font );</span><br><span class="line">		MyTextBlock-&gt;<span class="built_in">SetStrikeBrush</span>( &amp;StrikeBrush );</span><br><span class="line">		MyTextBlock-&gt;<span class="built_in">SetColorAndOpacity</span>( ColorAndOpacityBinding );</span><br><span class="line">		MyTextBlock-&gt;<span class="built_in">SetShadowOffset</span>( ShadowOffset );</span><br><span class="line">		MyTextBlock-&gt;<span class="built_in">SetShadowColorAndOpacity</span>( ShadowColorAndOpacityBinding );</span><br><span class="line">		MyTextBlock-&gt;<span class="built_in">SetMinDesiredWidth</span>( MinDesiredWidth );</span><br><span class="line">		MyTextBlock-&gt;<span class="built_in">SetTransformPolicy</span>( TextTransformPolicy );</span><br><span class="line">		MyTextBlock-&gt;<span class="built_in">SetOverflowPolicy</span>(TextOverflowPolicy);</span><br><span class="line"></span><br><span class="line">		Super::<span class="built_in">SynchronizeTextLayoutProperties</span>( *MyTextBlock );</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>When you turn on or turn off the option <code>AutoWrapText</code>, widgetâ€™s <code>SynchronizeProperties()</code> would be called. By the code <code>Super::SynchronizeTextLayoutProperties(*MyTextBlock);</code> executed, Parentâ€™s <code>SynchronizeProperties(TWidgetType&amp;)</code> is called.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Synchronize the properties with the given widget. A template as the Slate widgets conform to the same API, but don&#x27;t derive from a common base. */</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> TWidgetType&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SynchronizeTextLayoutProperties</span><span class="params">(TWidgetType&amp; InWidget)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ShapedTextOptions.<span class="built_in">SynchronizeShapedTextProperties</span>(InWidget);</span><br><span class="line"></span><br><span class="line">    InWidget.<span class="built_in">SetJustification</span>(Justification);</span><br><span class="line">    InWidget.<span class="built_in">SetAutoWrapText</span>(!!AutoWrapText);</span><br><span class="line">    InWidget.<span class="built_in">SetWrapTextAt</span>(WrapTextAt != <span class="number">0</span> ? WrapTextAt : <span class="built_in">TAttribute</span>&lt;<span class="type">float</span>&gt;());</span><br><span class="line">    InWidget.<span class="built_in">SetWrappingPolicy</span>(WrappingPolicy);</span><br><span class="line">    InWidget.<span class="built_in">SetMargin</span>(Margin);</span><br><span class="line">    InWidget.<span class="built_in">SetLineHeightPercentage</span>(LineHeightPercentage);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In this function, <code>InWidget</code> is our TextBlock. And it would call the function <code>SetAutoWrapText(bool)</code> for updating the option.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UTextBlock::SetAutoWrapText</span><span class="params">(<span class="type">bool</span> InAutoWrapText)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	AutoWrapText = InAutoWrapText;</span><br><span class="line">	<span class="keyword">if</span>(MyTextBlock.<span class="built_in">IsValid</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		MyTextBlock-&gt;<span class="built_in">SetAutoWrapText</span>(InAutoWrapText);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Good. The parameter <code>InAutoWrapText</code> updates the variable <code>AutoWrapText</code> and <code>MyTextBlock</code>. The variable <code>MyTextBlock</code> is <code>TSharedPtr&lt;STextBlock&gt;</code>. Now, the time to jump to <code>STextBlock</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">STextBlock::SetAutoWrapText</span><span class="params">(TAttribute&lt;<span class="type">bool</span>&gt; InAutoWrapText)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	AutoWrapText.<span class="built_in">Assign</span>(*<span class="keyword">this</span>, <span class="built_in">MoveTemp</span>(InAutoWrapText), <span class="number">0.f</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here, in <code>STextBlock</code> the variable <code>AutoWrapText</code> holds the value of option. The function <code>Assign()</code> just saves the value its inside. The value of <code>AutoWrapText</code> is used in two positions.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// STextBlock.cpp</span></span><br><span class="line"><span class="function">FVector2D <span class="title">STextBlock::ComputeDesiredSize</span><span class="params">(<span class="type">float</span> LayoutScaleMultiplier)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">SCOPE_CYCLE_COUNTER</span>(Stat_SlateTextBlockCDS);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (bSimpleTextMode)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">const</span> FVector2D LocalShadowOffset = <span class="built_in">GetShadowOffset</span>();</span><br><span class="line"></span><br><span class="line">		<span class="type">const</span> <span class="type">float</span> LocalOutlineSize = (<span class="type">float</span>)(<span class="built_in">GetFont</span>().OutlineSettings.OutlineSize);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Account for the outline width impacting both size of the text by multiplying by 2</span></span><br><span class="line">		<span class="comment">// Outline size in Y is accounted for in MaxHeight calculation in Measure()</span></span><br><span class="line">		<span class="function"><span class="type">const</span> FVector2D <span class="title">ComputedOutlineSize</span><span class="params">(LocalOutlineSize * <span class="number">2.f</span>, LocalOutlineSize)</span></span>;</span><br><span class="line">		<span class="type">const</span> FVector2D TextSize = FSlateApplication::<span class="built_in">Get</span>().<span class="built_in">GetRenderer</span>()-&gt;<span class="built_in">GetFontMeasureService</span>()-&gt;<span class="built_in">Measure</span>(BoundText.<span class="built_in">Get</span>(), <span class="built_in">GetFont</span>()) + ComputedOutlineSize + LocalShadowOffset;</span><br><span class="line"></span><br><span class="line">		CachedSimpleDesiredSize = <span class="built_in">FVector2f</span>(FMath::<span class="built_in">Max</span>(MinDesiredWidth.<span class="built_in">Get</span>(), TextSize.X), TextSize.Y);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">FVector2D</span>(CachedSimpleDesiredSize.<span class="built_in">GetValue</span>());</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// ComputeDesiredSize will also update the text layout cache if required</span></span><br><span class="line">		<span class="type">const</span> FVector2D TextSize = TextLayoutCache-&gt;<span class="built_in">ComputeDesiredSize</span>(</span><br><span class="line">			FSlateTextBlockLayout::<span class="built_in">FWidgetDesiredSizeArgs</span>(</span><br><span class="line">				BoundText.<span class="built_in">Get</span>(),</span><br><span class="line">				HighlightText.<span class="built_in">Get</span>(),</span><br><span class="line">				WrapTextAt.<span class="built_in">Get</span>(),</span><br><span class="line">				AutoWrapText.<span class="built_in">Get</span>(),</span><br><span class="line">				WrappingPolicy.<span class="built_in">Get</span>(),</span><br><span class="line">				<span class="built_in">GetTransformPolicyImpl</span>(),</span><br><span class="line">				Margin.<span class="built_in">Get</span>(),</span><br><span class="line">				LineHeightPercentage.<span class="built_in">Get</span>(),</span><br><span class="line">				Justification.<span class="built_in">Get</span>()),</span><br><span class="line">			LayoutScaleMultiplier, <span class="built_in">GetComputedTextStyle</span>());</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">FVector2D</span>(FMath::<span class="built_in">Max</span>(MinDesiredWidth.<span class="built_in">Get</span>(), TextSize.X), TextSize.Y);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Callstack</span></span><br><span class="line">UnrealEditor-Slate.dll!STextBlock::<span class="built_in">ComputeDesiredSize</span>(<span class="type">float</span> LayoutScaleMultiplier) Line <span class="number">300</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">CacheDesiredSize</span>(<span class="type">float</span> InLayoutScaleMultiplier) Line <span class="number">936</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Prepass_Internal</span>(<span class="type">float</span> InLayoutScaleMultiplier) Line <span class="number">1714</span>	C++</span><br><span class="line">[Inline Frame] UnrealEditor-SlateCore.dll!SWidget::Prepass_ChildLoop::__l2::&lt;lambda_a0677895c4614612fd5b4c5f4771eae9&gt;::<span class="built_in">operator</span>()(SWidget &amp;) Line <span class="number">1751</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!FChildren::ForEachWidget&lt;&lt;lambda_a0677895c4614612fd5b4c5f4771eae9&gt;&gt;(SWidget::Prepass_ChildLoop::__l2::&lt;lambda_a0677895c4614612fd5b4c5f4771eae9&gt; Pred) Line <span class="number">67</span>	C++</span><br><span class="line">[Inline Frame] UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Prepass_ChildLoop</span>(<span class="type">float</span>) Line <span class="number">1721</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Prepass_Internal</span>(<span class="type">float</span> InLayoutScaleMultiplier) Line <span class="number">1708</span>	C++</span><br><span class="line">...</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Prepass_Internal</span>(<span class="type">float</span> InLayoutScaleMultiplier) Line <span class="number">1708</span>	C++</span><br><span class="line">[Inline Frame] UnrealEditor-SlateCore.dll!SWidget::Prepass_ChildLoop::__l2::&lt;lambda_a0677895c4614612fd5b4c5f4771eae9&gt;::<span class="built_in">operator</span>()(SWidget &amp;) Line <span class="number">1751</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!FChildren::ForEachWidget&lt;&lt;lambda_a0677895c4614612fd5b4c5f4771eae9&gt;&gt;(SWidget::Prepass_ChildLoop::__l2::&lt;lambda_a0677895c4614612fd5b4c5f4771eae9&gt; Pred) Line <span class="number">67</span>	C++</span><br><span class="line">[Inline Frame] UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Prepass_ChildLoop</span>(<span class="type">float</span>) Line <span class="number">1721</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Prepass_Internal</span>(<span class="type">float</span> InLayoutScaleMultiplier) Line <span class="number">1708</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">SlatePrepass</span>(<span class="type">float</span> InLayoutScaleMultiplier) Line <span class="number">690</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!<span class="built_in">PrepassWindowAndChildren</span>(TSharedRef&lt;SWindow,<span class="number">1</span>&gt; WindowToPrepass) Line <span class="number">1197</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!FSlateApplication::<span class="built_in">DrawPrepass</span>(TSharedPtr&lt;SWindow,<span class="number">1</span>&gt; DrawOnlyThisWindow) Line <span class="number">1249</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!FSlateApplication::<span class="built_in">PrivateDrawWindows</span>(TSharedPtr&lt;SWindow,<span class="number">1</span>&gt; DrawOnlyThisWindow) Line <span class="number">1294</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!FSlateApplication::<span class="built_in">DrawWindows</span>() Line <span class="number">1060</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!FSlateApplication::<span class="built_in">TickAndDrawWidgets</span>(<span class="type">float</span> DeltaTime) Line <span class="number">1625</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!FSlateApplication::<span class="built_in">Tick</span>(ESlateTickType TickType) Line <span class="number">1482</span>	C++</span><br><span class="line">UnrealEditor.exe!FEngineLoop::<span class="built_in">Tick</span>() Line <span class="number">5325</span>	C++</span><br><span class="line">[Inline Frame] UnrealEditor.exe!<span class="built_in">EngineTick</span>() Line <span class="number">62</span>	C++</span><br><span class="line">UnrealEditor.exe!<span class="built_in">GuardedMain</span>(<span class="type">const</span> <span class="type">wchar_t</span> * CmdLine) Line <span class="number">183</span>	C++</span><br><span class="line">UnrealEditor.exe!<span class="built_in">GuardedMainWrapper</span>(<span class="type">const</span> <span class="type">wchar_t</span> * CmdLine) Line <span class="number">147</span>	C++</span><br><span class="line">UnrealEditor.exe!<span class="built_in">LaunchWindowsStartup</span>(HINSTANCE__ * hInInstance, HINSTANCE__ * hPrevInstance, <span class="type">char</span> * __formal, <span class="type">int</span> nCmdShow, <span class="type">const</span> <span class="type">wchar_t</span> * CmdLine) Line <span class="number">283</span>	C++</span><br><span class="line">UnrealEditor.exe!<span class="built_in">WinMain</span>(HINSTANCE__ * hInInstance, HINSTANCE__ * hPrevInstance, <span class="type">char</span> * pCmdLine, <span class="type">int</span> nCmdShow) Line <span class="number">330</span>	C++</span><br><span class="line">[External Code]</span><br></pre></td></tr></table></figure>

<p>First, an execution flow by Prepass.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// STextBlock.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function">int32 <span class="title">STextBlock::OnPaint</span><span class="params">( <span class="type">const</span> FPaintArgs&amp; Args, <span class="type">const</span> FGeometry&amp; AllottedGeometry, <span class="type">const</span> FSlateRect&amp; MyCullingRect, FSlateWindowElementList&amp; OutDrawElements, int32 LayerId, <span class="type">const</span> FWidgetStyle&amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled )</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">SCOPE_CYCLE_COUNTER</span>(Stat_SlateTextBlockOnPaint);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (bSimpleTextMode)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// Draw the optional shadow</span></span><br><span class="line">		<span class="type">const</span> FLinearColor LocalShadowColorAndOpacity = <span class="built_in">GetShadowColorAndOpacity</span>();</span><br><span class="line">		<span class="type">const</span> FVector2D LocalShadowOffset = <span class="built_in">GetShadowOffset</span>();</span><br><span class="line">		<span class="type">const</span> <span class="type">bool</span> ShouldDropShadow = LocalShadowColorAndOpacity.A &gt; <span class="number">0.f</span> &amp;&amp; LocalShadowOffset.<span class="built_in">SizeSquared</span>() &gt; <span class="number">0.f</span>;</span><br><span class="line"></span><br><span class="line">		<span class="type">const</span> <span class="type">bool</span> bShouldBeEnabled = <span class="built_in">ShouldBeEnabled</span>(bParentEnabled);</span><br><span class="line"></span><br><span class="line">		<span class="type">const</span> FText&amp; LocalText = BoundText.<span class="built_in">Get</span>();</span><br><span class="line">		FSlateFontInfo LocalFont = <span class="built_in">GetFont</span>();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (ShouldDropShadow)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">const</span> int32 OutlineSize = LocalFont.OutlineSettings.OutlineSize;</span><br><span class="line">			<span class="keyword">if</span> (!LocalFont.OutlineSettings.bApplyOutlineToDropShadows)</span><br><span class="line">			&#123;</span><br><span class="line">				LocalFont.OutlineSettings.OutlineSize = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			FSlateDrawElement::<span class="built_in">MakeText</span>(</span><br><span class="line">				OutDrawElements,</span><br><span class="line">				LayerId,</span><br><span class="line">				AllottedGeometry.<span class="built_in">ToOffsetPaintGeometry</span>(LocalShadowOffset),</span><br><span class="line">				LocalText,</span><br><span class="line">				LocalFont,</span><br><span class="line">				bShouldBeEnabled ? ESlateDrawEffect::None : ESlateDrawEffect::DisabledEffect,</span><br><span class="line">				InWidgetStyle.<span class="built_in">GetColorAndOpacityTint</span>() * LocalShadowColorAndOpacity</span><br><span class="line">			);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Restore outline size for main text</span></span><br><span class="line">			LocalFont.OutlineSettings.OutlineSize = OutlineSize;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// actual text should appear above the shadow</span></span><br><span class="line">			++LayerId;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Draw the text itself</span></span><br><span class="line">		FSlateDrawElement::<span class="built_in">MakeText</span>(</span><br><span class="line">			OutDrawElements,</span><br><span class="line">			LayerId,</span><br><span class="line">			AllottedGeometry.<span class="built_in">ToPaintGeometry</span>(),</span><br><span class="line">			LocalText,</span><br><span class="line">			LocalFont,</span><br><span class="line">			bShouldBeEnabled ? ESlateDrawEffect::None : ESlateDrawEffect::DisabledEffect,</span><br><span class="line">			InWidgetStyle.<span class="built_in">GetColorAndOpacityTint</span>() * <span class="built_in">GetColorAndOpacity</span>().<span class="built_in">GetColor</span>(InWidgetStyle)</span><br><span class="line">			);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">const</span> FVector2D LastDesiredSize = TextLayoutCache-&gt;<span class="built_in">GetDesiredSize</span>();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// OnPaint will also update the text layout cache if required</span></span><br><span class="line">		LayerId = TextLayoutCache-&gt;<span class="built_in">OnPaint</span>(Args, AllottedGeometry, MyCullingRect, OutDrawElements, LayerId, InWidgetStyle, <span class="built_in">ShouldBeEnabled</span>(bParentEnabled));</span><br><span class="line"></span><br><span class="line">		<span class="type">const</span> FVector2D NewDesiredSize = TextLayoutCache-&gt;<span class="built_in">GetDesiredSize</span>();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// <span class="doctag">HACK:</span> Due to the nature of wrapping and layout, we may have been arranged in a different box than what we were cached with.  Which</span></span><br><span class="line">		<span class="comment">// might update wrapping, so make sure we always set the desired size to the current size of the text layout, which may have changed</span></span><br><span class="line">		<span class="comment">// during paint.</span></span><br><span class="line">		<span class="type">const</span> <span class="type">bool</span> bCanWrap = WrapTextAt.<span class="built_in">Get</span>() &gt; <span class="number">0</span> || AutoWrapText.<span class="built_in">Get</span>();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (bCanWrap &amp;&amp; !NewDesiredSize.<span class="built_in">Equals</span>(LastDesiredSize))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">const_cast</span>&lt;STextBlock*&gt;(<span class="keyword">this</span>)-&gt;<span class="built_in">Invalidate</span>(EInvalidateWidgetReason::Layout);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> LayerId;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Callstack</span></span><br><span class="line">UnrealEditor-Slate.dll!STextBlock::<span class="built_in">OnPaint</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">255</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Paint</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">1543</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SPanel::<span class="built_in">PaintArrangedChildren</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FArrangedChildren &amp; ArrangedChildren, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">31</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SPanel::<span class="built_in">OnPaint</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">12</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Paint</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">1543</span>	C++</span><br><span class="line">...</span><br><span class="line">UnrealEditor-SlateCore.dll!SPanel::<span class="built_in">PaintArrangedChildren</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FArrangedChildren &amp; ArrangedChildren, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">31</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SPanel::<span class="built_in">OnPaint</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">12</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Paint</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">1543</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SOverlay::<span class="built_in">OnPaint</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">200</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Paint</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">1543</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SCompoundWidget::<span class="built_in">OnPaint</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">46</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWidget::<span class="built_in">Paint</span>(<span class="type">const</span> FPaintArgs &amp; Args, <span class="type">const</span> FGeometry &amp; AllottedGeometry, <span class="type">const</span> FSlateRect &amp; MyCullingRect, FSlateWindowElementList &amp; OutDrawElements, <span class="type">int</span> LayerId, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">1543</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWindow::<span class="built_in">PaintSlowPath</span>(<span class="type">const</span> FSlateInvalidationContext &amp; Context) Line <span class="number">2073</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!FSlateInvalidationRoot::<span class="built_in">PaintInvalidationRoot</span>(<span class="type">const</span> FSlateInvalidationContext &amp; Context) Line <span class="number">399</span>	C++</span><br><span class="line">UnrealEditor-SlateCore.dll!SWindow::<span class="built_in">PaintWindow</span>(<span class="type">double</span> CurrentTime, <span class="type">float</span> DeltaTime, FSlateWindowElementList &amp; OutDrawElements, <span class="type">const</span> FWidgetStyle &amp; InWidgetStyle, <span class="type">bool</span> bParentEnabled) Line <span class="number">2105</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!FSlateApplication::<span class="built_in">DrawWindowAndChildren</span>(<span class="type">const</span> TSharedRef&lt;SWindow,<span class="number">1</span>&gt; &amp; WindowToDraw, FDrawWindowArgs &amp; DrawWindowArgs) Line <span class="number">1106</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!FSlateApplication::<span class="built_in">PrivateDrawWindows</span>(TSharedPtr&lt;SWindow,<span class="number">1</span>&gt; DrawOnlyThisWindow) Line <span class="number">1338</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!FSlateApplication::<span class="built_in">DrawWindows</span>() Line <span class="number">1060</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!FSlateApplication::<span class="built_in">TickAndDrawWidgets</span>(<span class="type">float</span> DeltaTime) Line <span class="number">1625</span>	C++</span><br><span class="line">UnrealEditor-Slate.dll!FSlateApplication::<span class="built_in">Tick</span>(ESlateTickType TickType) Line <span class="number">1482</span>	C++</span><br><span class="line">UnrealEditor.exe!FEngineLoop::<span class="built_in">Tick</span>() Line <span class="number">5325</span>	C++</span><br><span class="line">[Inline Frame] UnrealEditor.exe!<span class="built_in">EngineTick</span>() Line <span class="number">62</span>	C++</span><br><span class="line">UnrealEditor.exe!<span class="built_in">GuardedMain</span>(<span class="type">const</span> <span class="type">wchar_t</span> * CmdLine) Line <span class="number">183</span>	C++</span><br><span class="line">UnrealEditor.exe!<span class="built_in">GuardedMainWrapper</span>(<span class="type">const</span> <span class="type">wchar_t</span> * CmdLine) Line <span class="number">147</span>	C++</span><br><span class="line">UnrealEditor.exe!<span class="built_in">LaunchWindowsStartup</span>(HINSTANCE__ * hInInstance, HINSTANCE__ * hPrevInstance, <span class="type">char</span> * __formal, <span class="type">int</span> nCmdShow, <span class="type">const</span> <span class="type">wchar_t</span> * CmdLine) Line <span class="number">283</span>	C++</span><br><span class="line">UnrealEditor.exe!<span class="built_in">WinMain</span>(HINSTANCE__ * hInInstance, HINSTANCE__ * hPrevInstance, <span class="type">char</span> * pCmdLine, <span class="type">int</span> nCmdShow) Line <span class="number">330</span>	C++</span><br><span class="line">[External Code]	</span><br></pre></td></tr></table></figure>

<p>Second, an execution flow by Paint.</p>
<p>The flows are branched at <code>FSlateApplication::PrivateDrawWindows()</code>. In the function, <code>DrawPrepass()</code> is called at line #1292, and <code>DrawWindowAndChildren()</code> is called at line #1338. Respectively, Prepass and Paint. Engine just invalidate the widget in Paint flow, so we only need to look into Prepass flow.</p>
<h1 id="Calculating-a-length-of-text-wrap"><a href="#Calculating-a-length-of-text-wrap" class="headerlink" title="Calculating a length of text wrap"></a><em><code>Calculating a length of text wrap</code></em></h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">FVector2D <span class="title">FSlateTextBlockLayout::ComputeDesiredSize</span><span class="params">(<span class="type">const</span> FWidgetDesiredSizeArgs&amp; InWidgetArgs, <span class="type">const</span> <span class="type">float</span> InScale, <span class="type">const</span> FTextBlockStyle&amp; InTextStyle)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// Cache the wrapping rules so that we can recompute the wrap at width in paint.</span></span><br><span class="line">	CachedWrapTextAt = InWidgetArgs.WrapTextAt;</span><br><span class="line">	bCachedAutoWrapText = InWidgetArgs.AutoWrapText;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> ETextTransformPolicy PreviousTransformPolicy = TextLayout-&gt;<span class="built_in">GetTransformPolicy</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Set the text layout information</span></span><br><span class="line">	TextLayout-&gt;<span class="built_in">SetScale</span>(InScale);</span><br><span class="line">	TextLayout-&gt;<span class="built_in">SetWrappingWidth</span>(<span class="built_in">CalculateWrappingWidth</span>());</span><br><span class="line">	TextLayout-&gt;<span class="built_in">SetWrappingPolicy</span>(InWidgetArgs.WrappingPolicy);</span><br><span class="line">	TextLayout-&gt;<span class="built_in">SetTransformPolicy</span>(InWidgetArgs.TransformPolicy);</span><br><span class="line">	TextLayout-&gt;<span class="built_in">SetMargin</span>(InWidgetArgs.Margin);</span><br><span class="line">	TextLayout-&gt;<span class="built_in">SetJustification</span>(InWidgetArgs.Justification);</span><br><span class="line">	TextLayout-&gt;<span class="built_in">SetLineHeightPercentage</span>(InWidgetArgs.LineHeightPercentage);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Has the transform policy changed? If so we need a full refresh as that is destructive to the model text</span></span><br><span class="line">	<span class="keyword">if</span> (PreviousTransformPolicy != TextLayout-&gt;<span class="built_in">GetTransformPolicy</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		Marshaller-&gt;<span class="built_in">MakeDirty</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Has the style used for this text block changed?</span></span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">IsStyleUpToDate</span>(InTextStyle))</span><br><span class="line">	&#123;</span><br><span class="line">		TextLayout-&gt;<span class="built_in">SetDefaultTextStyle</span>(InTextStyle);</span><br><span class="line">		Marshaller-&gt;<span class="built_in">MakeDirty</span>(); <span class="comment">// will regenerate the text using the new default style</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">bool</span> bRequiresTextUpdate = <span class="literal">false</span>;</span><br><span class="line">		<span class="type">const</span> FText&amp; TextToSet = InWidgetArgs.Text;</span><br><span class="line">		<span class="keyword">if</span> (!TextLastUpdate.<span class="built_in">IdenticalTo</span>(TextToSet))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// The pointer used by the bound text has changed, however the text may still be the same - check that now</span></span><br><span class="line">			<span class="keyword">if</span> (!TextLastUpdate.<span class="built_in">IsDisplayStringEqualTo</span>(TextToSet))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">// The source text has changed, so update the internal text</span></span><br><span class="line">				bRequiresTextUpdate = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Update this even if the text is lexically identical, as it will update the pointer compared by IdenticalTo for the next Tick</span></span><br><span class="line">			TextLastUpdate = <span class="built_in">FTextSnapshot</span>(TextToSet);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (bRequiresTextUpdate || Marshaller-&gt;<span class="built_in">IsDirty</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">UpdateTextLayout</span>(TextToSet);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">const</span> FText&amp; HighlightTextToSet = InWidgetArgs.HighlightText;</span><br><span class="line">		<span class="keyword">if</span> (!HighlightTextLastUpdate.<span class="built_in">IdenticalTo</span>(HighlightTextToSet))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// The pointer used by the bound text has changed, however the text may still be the same - check that now</span></span><br><span class="line">			<span class="keyword">if</span> (!HighlightTextLastUpdate.<span class="built_in">IsDisplayStringEqualTo</span>(HighlightTextToSet))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">UpdateTextHighlights</span>(HighlightTextToSet);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Update this even if the text is lexically identical, as it will update the pointer compared by IdenticalTo for the next Tick</span></span><br><span class="line">			HighlightTextLastUpdate = <span class="built_in">FTextSnapshot</span>(HighlightTextToSet);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// We need to update our size if the text layout has become dirty</span></span><br><span class="line">	TextLayout-&gt;<span class="built_in">UpdateIfNeeded</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> TextLayout-&gt;<span class="built_in">GetSize</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The function <code>FSlateTextBlockLayout::ComputeDesiredSize()</code> is called during Prepass flow. Here, <code>bCachedAutoWrapText</code> caches the value of <code>InWidgetArgs.AutoWrapText</code>. This will be used at <code>CalculateWrappingWidth()</code> later.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">float</span> <span class="title">FSlateTextBlockLayout::CalculateWrappingWidth</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// Text wrapping can either be used defined (WrapTextAt), automatic (bAutoWrapText and CachedSize), </span></span><br><span class="line">	<span class="comment">// or a mixture of both. Take whichever has the smallest value (&gt;1)</span></span><br><span class="line">	<span class="type">float</span> WrappingWidth = CachedWrapTextAt;</span><br><span class="line">	<span class="keyword">if</span> (bCachedAutoWrapText &amp;&amp; CachedSize.X &gt;= <span class="number">1.0f</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		WrappingWidth = (WrappingWidth &gt;= <span class="number">1.0f</span>) ? FMath::<span class="built_in">Min</span>(WrappingWidth, CachedSize.X) : CachedSize.X;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> FMath::<span class="built_in">Max</span>(<span class="number">0.0f</span>, WrappingWidth);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>CachedWrapTextAt</code> will be the same with the value set by option <code>WrapTextAt</code> in editor. And, the <code>CachedSize</code> depends on the size of panel where the TextBlock resides in. In the example we are using, the variables would have a value like below:</p>
<ul>
<li><code>CachedWrapTextAt</code> &#x3D; 0</li>
<li><code>CachedSize.X</code> &#x3D; 100</li>
</ul>
<p>Because the width of SizeBox is 100 and we set the option <code>WrapTextAt</code> as 0. The function determines the length of wrapping, but it is not for the logic about how to divide texts or how to break lines. So, look back on <code>FSlateTextBlockLayout::ComputeDesiredSize()</code>.</p>
<h1 id="UpdateLayout-when-it-is-dirty"><a href="#UpdateLayout-when-it-is-dirty" class="headerlink" title="UpdateLayout when it is dirty"></a><em><code>UpdateLayout when it is dirty</code></em></h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SlateTextBlockLayout.cpp</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="comment">// We need to update our size if the text layout has become dirty</span></span><br><span class="line">TextLayout-&gt;<span class="built_in">UpdateIfNeeded</span>();</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// TextLayout.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTextLayout::UpdateIfNeeded</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (CachedLayoutGeneration != GSlateLayoutGeneration)</span><br><span class="line">	&#123;</span><br><span class="line">		CachedLayoutGeneration = GSlateLayoutGeneration;</span><br><span class="line">		DirtyFlags |= ETextLayoutDirtyState::Layout;</span><br><span class="line">		<span class="built_in">DirtyAllLineModels</span>(ELineModelDirtyState::All);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> <span class="type">bool</span> bHasChangedLayout = !!(DirtyFlags &amp; ETextLayoutDirtyState::Layout);</span><br><span class="line">	<span class="type">const</span> <span class="type">bool</span> bHasChangedHighlights = !!(DirtyFlags &amp; ETextLayoutDirtyState::Highlights);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( bHasChangedLayout )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// if something has changed then create a new View</span></span><br><span class="line">		<span class="built_in">UpdateLayout</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// If the layout has changed, we always need to update the highlights</span></span><br><span class="line">	<span class="keyword">if</span> ( bHasChangedLayout || bHasChangedHighlights)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">UpdateHighlights</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In the function, there is some code to call <code>FTextLayout::UpdateIfNeeded()</code>. Oh, the <code>UpdateLayout()</code> looks like the one we wanted. The code will be executed when <code>bHasChangedLayout</code> is true, and the value is usually set by <code>SetWrappingWidth()</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTextLayout::SetWrappingWidth</span><span class="params">( <span class="type">float</span> Value )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">bool</span> WasWrapping = WrappingWidth &gt; <span class="number">0.0f</span>;</span><br><span class="line">	<span class="type">const</span> <span class="type">bool</span> IsWrapping = Value &gt; <span class="number">0.0f</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( WrappingWidth != Value )</span><br><span class="line">	&#123;</span><br><span class="line">		WrappingWidth = Value; </span><br><span class="line">		DirtyFlags |= ETextLayoutDirtyState::Layout;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ( WasWrapping != IsWrapping )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// Changing from wrapping/not-wrapping will affect the wrapping information for *all lines*</span></span><br><span class="line">			<span class="comment">// Clear out the entire cache so it gets regenerated on the text call to FlowLayout</span></span><br><span class="line">			<span class="built_in">DirtyAllLineModels</span>(ELineModelDirtyState::WrappingInformation);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Suppose you switch the option <code>AutoWrapText</code> from false into true. Here, <code>DirtyFlags</code> will flag the <code>ETextLayoutDirtyState::Layout</code>, which is 1. Therefore, <code>!!(DirtyFlags &amp; ETextLayoutDirtyState::Layout)</code> turns into 1. The <code>bHasChangedLayout</code> becomes 1, too.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTextLayout::UpdateLayout</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">SCOPE_CYCLE_COUNTER</span>(STAT_SlateTextLayout);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">ClearView</span>();</span><br><span class="line">	<span class="built_in">BeginLayout</span>();</span><br><span class="line"></span><br><span class="line">	<span class="built_in">FlowLayout</span>();</span><br><span class="line">	<span class="built_in">JustifyLayout</span>();</span><br><span class="line">	<span class="built_in">MarginLayout</span>();</span><br><span class="line"></span><br><span class="line">	<span class="built_in">EndLayout</span>();</span><br><span class="line"></span><br><span class="line">	DirtyFlags &amp;= ~ETextLayoutDirtyState::Layout;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>ClearView()</code> and <code>BeginLayout()</code> are not important in this post. Plus, they do not something important either.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTextLayout::FlowLayout</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">float</span> WrappingDrawWidth = <span class="built_in">GetWrappingDrawWidth</span>();</span><br><span class="line"></span><br><span class="line">	TArray&lt; TSharedRef&lt; ILayoutBlock &gt; &gt; SoftLine;</span><br><span class="line">	<span class="keyword">for</span> (int32 LineModelIndex = <span class="number">0</span>; LineModelIndex &lt; LineModels.<span class="built_in">Num</span>(); LineModelIndex++)</span><br><span class="line">	&#123;</span><br><span class="line">		FLineModel&amp; LineModel = LineModels[ LineModelIndex ];</span><br><span class="line">		<span class="built_in">CalculateLineTextDirection</span>(LineModel);</span><br><span class="line">		<span class="built_in">FlushLineTextShapingCache</span>(LineModel);</span><br><span class="line">		<span class="built_in">CreateLineWrappingCache</span>(LineModel);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">FlowLineLayout</span>(LineModelIndex, WrappingDrawWidth, SoftLine);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In the <code>FlowLayout()</code>, the code that calls <code>CreateLineWrappingCache()</code> is a point since the <code>CreateLineWrappingCache()</code> creates data for wrapping text.</p>
<h1 id="Break-lines-1-3-Separating-text-into-slices"><a href="#Break-lines-1-3-Separating-text-into-slices" class="headerlink" title="Break lines (1/3); Separating text into slices"></a><em><code>Break lines (1/3); Separating text into slices</code></em></h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTextLayout::CreateLineWrappingCache</span><span class="params">(FLineModel&amp; LineModel)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!(LineModel.DirtyFlags &amp; ELineModelDirtyState::WrappingInformation))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	LineModel.BreakCandidates.<span class="built_in">Empty</span>();</span><br><span class="line">	LineModel.DirtyFlags &amp;= ~ELineModelDirtyState::WrappingInformation;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (int32 RunIndex = <span class="number">0</span>; RunIndex &lt; LineModel.Runs.<span class="built_in">Num</span>(); RunIndex++)</span><br><span class="line">	&#123;</span><br><span class="line">		LineModel.Runs[RunIndex].<span class="built_in">ClearCache</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> <span class="type">bool</span> IsWrapping = WrappingWidth &gt; <span class="number">0.0f</span>;</span><br><span class="line">	<span class="keyword">if</span> (!IsWrapping)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// If we&#x27;ve not yet been provided with a custom line break iterator, then just use the default one</span></span><br><span class="line">	<span class="keyword">if</span> (!LineBreakIterator.<span class="built_in">IsValid</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		LineBreakIterator = FBreakIterator::<span class="built_in">CreateLineBreakIterator</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	LineBreakIterator-&gt;<span class="built_in">SetStringRef</span>(&amp;LineModel.Text.<span class="built_in">Get</span>());</span><br><span class="line"></span><br><span class="line">	int32 PreviousBreak = <span class="number">0</span>;</span><br><span class="line">	int32 CurrentBreak = <span class="number">0</span>;</span><br><span class="line">	int32 CurrentRunIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>( ( CurrentBreak = LineBreakIterator-&gt;<span class="built_in">MoveToNext</span>() ) != INDEX_NONE )</span><br><span class="line">	&#123;</span><br><span class="line">		LineModel.BreakCandidates.<span class="built_in">Add</span>( <span class="built_in">CreateBreakCandidate</span>(<span class="comment">/*OUT*/</span>CurrentRunIndex, LineModel, PreviousBreak, CurrentBreak) );</span><br><span class="line">		PreviousBreak = CurrentBreak;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	LineBreakIterator-&gt;<span class="built_in">ClearString</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In this function, we found some variables that have a name of <code>LineBreak</code>. Let us check what the line break iterator does.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">TSharedRef&lt;IBreakIterator&gt; <span class="title">FBreakIterator::CreateLineBreakIterator</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">MakeShareable</span>(<span class="keyword">new</span> <span class="built_in">FICULineBreakIterator</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>LinBreakIterator</code> is a line break iterator using the implementation of <a target="_blank" rel="noopener" href="https://github.com/unicode-org/icu/blob/main/icu4c/source/common/unicode/brkiter.h">ICU(International Components for Unicode)â€™s break iterator</a>. The break iterator does a job of finding a location of boundaries in text. Visit <a target="_blank" rel="noopener" href="https://unicode-org.github.io/icu-docs/apidoc/dev/icu4c/classicu_1_1BreakIterator.html#details">here</a> for more details. To summarize, the break iterator can find where each word ends. For example, we have a text of <code>Text Block Test</code> and the break iterator can find locations just like this <code>Text (HERE)Block (HERE)Test(HERE)</code>. So, let us see how it works.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">int32 <span class="title">FICULineBreakIterator::MoveToNextImpl</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	TSharedRef&lt;icu::BreakIterator&gt; LineBrkIt = <span class="built_in">GetInternalLineBreakIterator</span>();</span><br><span class="line">	FICUTextCharacterIterator&amp; CharIt = <span class="built_in">static_cast</span>&lt;FICUTextCharacterIterator&amp;&gt;(LineBrkIt-&gt;<span class="built_in">getText</span>());</span><br><span class="line"></span><br><span class="line">	int32 InternalPosition = CharIt.<span class="built_in">SourceIndexToInternalIndex</span>(CurrentPosition);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// For Hangul using per-word wrapping, we walk forward to the last Hangul character in the word and use that as the starting point for the </span></span><br><span class="line">	<span class="comment">// line-break iterator, as this will correctly handle the remaining Geumchik wrapping rules, without also causing per-syllable wrapping</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">GetHangulTextWrappingMethod</span>() == EHangulTextWrappingMethod::PerWord)</span><br><span class="line">	&#123;</span><br><span class="line">		CharIt.<span class="built_in">setIndex32</span>(InternalPosition);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">IsHangul</span>(CharIt.<span class="built_in">current32</span>()))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// Walk to the end of the Hangul characters</span></span><br><span class="line">			<span class="keyword">while</span> (CharIt.<span class="built_in">hasNext</span>() &amp;&amp; <span class="built_in">IsHangul</span>(CharIt.<span class="built_in">next32</span>()))</span><br><span class="line">			&#123;</span><br><span class="line">				InternalPosition = CharIt.<span class="built_in">getIndex</span>();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	InternalPosition = LineBrkIt-&gt;<span class="built_in">following</span>(InternalPosition);</span><br><span class="line">	CurrentPosition = CharIt.<span class="built_in">InternalIndexToSourceIndex</span>(InternalPosition);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> CurrentPosition;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>MoveToNext()</code> calls the <code>MoveToNextImpl()</code>. And, the <code>MoveToNextImpl()</code> change the <code>InternalPosition</code>, which is used for finding a location in text.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UnrealEngine/Engine/Source/ThirdParty/ICU/icu4c-64_1/include/unicode/brkiter.h</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Advance the iterator to the first boundary following the specified offset.</span></span><br><span class="line"><span class="comment"> * The value returned is always greater than the offset or</span></span><br><span class="line"><span class="comment"> * the value BreakIterator.DONE</span></span><br><span class="line"><span class="comment"> * @param offset the offset to begin scanning.</span></span><br><span class="line"><span class="comment"> * @return The first boundary after the specified offset.</span></span><br><span class="line"><span class="comment"> * @stable ICU 2.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">int32_t</span> <span class="title">following</span><span class="params">(<span class="type">int32_t</span> offset)</span> </span>= <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>The <code>InternalPosition</code> is passed into <code>following</code> and it is the code of ICU library.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[index] 0123456789...</span><br><span class="line">[array] Text Block Test</span><br><span class="line"></span><br><span class="line">[flow]</span><br><span class="line">PreviousBreak = 0, CurrentBreak = 0</span><br><span class="line">MoveToNext()</span><br><span class="line">PreviousBreak = 0, CurrentBreak = 5</span><br><span class="line">CreateBreakCandidate()</span><br><span class="line">PreviousBreak = 5, CurrentBreak = 5</span><br><span class="line">MoveToNext()</span><br><span class="line">PreviousBreak = 5, CurrentBreak = 11</span><br><span class="line">CreateBreakCandidate()</span><br><span class="line">PreviousBreak = 11, CurrentBreak = 11</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>In our test text, the flow looks like above.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">FBreakCandidate</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">/** Range inclusive of trailing whitespace, as used to visually display and interact with the text */</span></span><br><span class="line">	FTextRange ActualRange;</span><br><span class="line">	<span class="comment">/** Range exclusive of trailing whitespace, as used to perform wrapping on a word boundary */</span></span><br><span class="line">	FTextRange TrimmedRange;</span><br><span class="line">	<span class="comment">/** Measured size inclusive of trailing whitespace, as used to visually display and interact with the text */</span></span><br><span class="line">	FVector2D ActualSize;</span><br><span class="line">	<span class="comment">/** Measured width exclusive of trailing whitespace, as used to perform wrapping on a word boundary */</span></span><br><span class="line">	<span class="type">float</span> TrimmedWidth;</span><br><span class="line">	<span class="comment">/** If this break candidate has trailing whitespace, this is the width of the first character of the trailing whitespace */</span></span><br><span class="line">	<span class="type">float</span> FirstTrailingWhitespaceCharWidth;</span><br><span class="line"></span><br><span class="line">	int16 MaxAboveBaseline;</span><br><span class="line">	int16 MaxBelowBaseline;</span><br><span class="line"></span><br><span class="line">	int8 Kerning;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> TEXT_LAYOUT_DEBUG</span></span><br><span class="line">	FString DebugSlice;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>A <code>FBreakCandidate</code> will be inserted into <code>BreakCandidates</code> each iteration. It seems the <code>FBreakCandidate</code> knows the size of word (or a part of text). What happened in <code>CreateBreakCandidate()</code> ? How could they know the actual size of text ?</p>
<h1 id="Break-lines-2-3-Measuring-size-of-each-slice"><a href="#Break-lines-2-3-Measuring-size-of-each-slice" class="headerlink" title="Break lines (2/3); Measuring size of each slice"></a><em><code>Break lines (2/3); Measuring size of each slice</code></em></h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">FTextLayout::FBreakCandidate <span class="title">FTextLayout::CreateBreakCandidate</span><span class="params">( int32&amp; OutRunIndex, FLineModel&amp; Line, int32 PreviousBreak, int32 CurrentBreak )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="comment">// We need to consider the Runs when detecting and measuring the text lengths of Lines because</span></span><br><span class="line">	<span class="comment">// the font style used makes a difference.</span></span><br><span class="line">	<span class="type">const</span> int32 FirstRunIndexChecked = OutRunIndex;</span><br><span class="line">	<span class="keyword">for</span> (; OutRunIndex &lt; Line.Runs.<span class="built_in">Num</span>(); OutRunIndex++)</span><br><span class="line">	&#123;</span><br><span class="line">		FRunModel&amp; Run = Line.Runs[ OutRunIndex ];</span><br><span class="line">		<span class="type">const</span> FTextRange Range = Run.<span class="built_in">GetTextRange</span>();</span><br><span class="line"></span><br><span class="line">		FVector2D SliceSize;</span><br><span class="line">		FVector2D SliceSizeWithoutTrailingWhitespace;</span><br><span class="line">		int32 StopIndex = PreviousBreak;</span><br><span class="line"></span><br><span class="line">		WhitespaceStopIndex = StopIndex = FMath::<span class="built_in">Min</span>( Range.EndIndex, CurrentBreak );</span><br><span class="line">		int32 BeginIndex = FMath::<span class="built_in">Max</span>( PreviousBreak, Range.BeginIndex );</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>( WhitespaceStopIndex &gt; BeginIndex &amp;&amp; FText::<span class="built_in">IsWhitespace</span>( (*Line.Text)[ WhitespaceStopIndex - <span class="number">1</span> ] ) )</span><br><span class="line">		&#123;</span><br><span class="line">			--WhitespaceStopIndex;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ( BeginIndex == StopIndex )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// This slice is empty, no need to adjust anything</span></span><br><span class="line">			SliceSize = SliceSizeWithoutTrailingWhitespace = FVector2D::ZeroVector;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> ( BeginIndex == WhitespaceStopIndex )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// This slice contains only whitespace, no need to adjust SliceSizeWithoutTrailingWhitespace</span></span><br><span class="line">			SliceSize = Run.<span class="built_in">Measure</span>( BeginIndex, StopIndex, Scale, RunTextContext );</span><br><span class="line">			SliceSizeWithoutTrailingWhitespace = FVector2D::ZeroVector;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> ( WhitespaceStopIndex != StopIndex )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// This slice contains trailing whitespace, measure the text size, then add on the whitespace size</span></span><br><span class="line">			SliceSize = SliceSizeWithoutTrailingWhitespace = Run.<span class="built_in">Measure</span>( BeginIndex, WhitespaceStopIndex, Scale, RunTextContext );</span><br><span class="line">			<span class="type">const</span> <span class="type">float</span> WhitespaceWidth = Run.<span class="built_in">Measure</span>( WhitespaceStopIndex, StopIndex, Scale, RunTextContext ).X;</span><br><span class="line">			SliceSize.X += WhitespaceWidth;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// We also need to measure the width of the first piece of trailing whitespace</span></span><br><span class="line">			<span class="keyword">if</span> ( WhitespaceStopIndex + <span class="number">1</span> == StopIndex )</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">// Only have one piece of whitespace</span></span><br><span class="line">				FirstTrailingWhitespaceCharWidth = WhitespaceWidth;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">// Deliberately use the run version of Measure as we don&#x27;t want the run model to cache this measurement since it may be out of order and break the binary search</span></span><br><span class="line">				FirstTrailingWhitespaceCharWidth = Run.<span class="built_in">GetRun</span>()-&gt;<span class="built_in">Measure</span>( WhitespaceStopIndex, WhitespaceStopIndex + <span class="number">1</span>, Scale, RunTextContext ).X;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// This slice contains no whitespace, both sizes are the same and can use the same measurement</span></span><br><span class="line">			SliceSize = SliceSizeWithoutTrailingWhitespace = Run.<span class="built_in">Measure</span>( BeginIndex, StopIndex, Scale, RunTextContext );</span><br><span class="line">		&#125;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>CreateBreakCandidate()</code> function is quite big size, about 200 lines. But the core of function is to calculate a size of slice. Do you remember the variable <code>CurrentBreak</code> that indicates where each slice ends ? Here, the function make a slice according to <code>CurrentBreak</code> and trim it. Trimming happens in <code>while</code> statement, which decreases the <code>WhitespaceStopIndex</code> until it indicates an end of last word.</p>
<img src="/2022/03/22/how-the-text-wrap-works-in-unrealengine/04.png" class="">

<p>The <code>WhitespaceStopIndex</code> would be 4 in our test text. That is because the index of first whitespace is 4 in <code>Text Block Test</code>. Eventually, we will enter the function <code>Measure()</code> as the slice is not empty. The only case that <code>Measure()</code> not called is when <code>BeginIndex == StopIndex</code> is true, in other words <code>CurrentBreak == 0</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TextLayout.cpp</span></span><br><span class="line">FVector2D FTextLayout::FRunModel::<span class="built_in">Measure</span>(int32 BeginIndex, int32 EndIndex, <span class="type">float</span> InScale, <span class="type">const</span> FRunTextContext&amp; InTextContext)</span><br><span class="line">&#123;</span><br><span class="line">	FVector2D Size = Run-&gt;<span class="built_in">Measure</span>(BeginIndex, EndIndex, InScale, InTextContext);</span><br><span class="line"></span><br><span class="line">	MeasuredRanges.<span class="built_in">Add</span>( <span class="built_in">FTextRange</span>( BeginIndex, EndIndex ) );</span><br><span class="line">	MeasuredRangeSizes.<span class="built_in">Add</span>(Size);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> Size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SlateTextRun.cpp</span></span><br><span class="line"><span class="function">FVector2D <span class="title">FSlateTextRun::Measure</span><span class="params">( int32 BeginIndex, int32 EndIndex, <span class="type">float</span> Scale, <span class="type">const</span> FRunTextContext&amp; TextContext )</span> <span class="type">const</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function"><span class="type">const</span> FVector2D <span class="title">ShadowOffsetToApply</span><span class="params">((EndIndex == Range.EndIndex) ? FMath::Abs(Style.ShadowOffset.X * Scale) : <span class="number">0.0f</span>, FMath::Abs(Style.ShadowOffset.Y * Scale))</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Offset the measured shaped text by the outline since the outline was not factored into the size of the text</span></span><br><span class="line">	<span class="comment">// Need to add the outline offsetting to the beginning and the end because it surrounds both sides.</span></span><br><span class="line">	<span class="type">const</span> <span class="type">float</span> ScaledOutlineSize = Style.Font.OutlineSettings.OutlineSize * Scale;</span><br><span class="line">	<span class="function"><span class="type">const</span> FVector2D <span class="title">OutlineSizeToApply</span><span class="params">((BeginIndex == Range.BeginIndex ? ScaledOutlineSize : <span class="number">0</span>) + (EndIndex == Range.EndIndex ? ScaledOutlineSize : <span class="number">0</span>), ScaledOutlineSize)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (EndIndex - BeginIndex == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">FVector2D</span>(<span class="number">0</span>, <span class="built_in">GetMaxHeight</span>(Scale)) + ShadowOffsetToApply + OutlineSizeToApply;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use the full text range (rather than the run range) so that text that spans runs will still be shaped correctly</span></span><br><span class="line">	<span class="keyword">return</span> ShapedTextCacheUtil::<span class="built_in">MeasureShapedText</span>(TextContext.ShapedTextCache, <span class="built_in">FCachedShapedTextKey</span>(<span class="built_in">FTextRange</span>(<span class="number">0</span>, Text-&gt;<span class="built_in">Len</span>()), Scale, TextContext, Style.Font), <span class="built_in">FTextRange</span>(BeginIndex, EndIndex), **Text) + ShadowOffsetToApply + OutlineSizeToApply;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We will get a FVector2D from <code>FSlateTextRun::Measure()</code>, which is the size of slice. The code <code>Run-&gt;Measure()</code> is the same with calling <code>ShapedTextCacheUtil::MeasureShapedText()</code> when you are using a TextBlock. Calculating shadow offset is not important in this post, so we need to focus on <code>ShapedTextCacheUtil::MeasureShapedText()</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ShapedTextFwd.h</span></span><br><span class="line"><span class="keyword">typedef</span> TSharedRef&lt;<span class="type">const</span> FShapedGlyphSequence&gt; FShapedGlyphSequenceRef;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ShapedTextCache.cpp</span></span><br><span class="line"><span class="function">FVector2D <span class="title">ShapedTextCacheUtil::MeasureShapedText</span><span class="params">(<span class="type">const</span> FShapedTextCacheRef&amp; InShapedTextCache, <span class="type">const</span> FCachedShapedTextKey&amp; InRunKey, <span class="type">const</span> FTextRange&amp; InMeasureRange, <span class="type">const</span> TCHAR* InText)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// Get the shaped text for the entire run and try and take a sub-measurement from it - this can help minimize the amount of text shaping that needs to be done when measuring text</span></span><br><span class="line">	FShapedGlyphSequenceRef ShapedText = InShapedTextCache-&gt;<span class="built_in">FindOrAddShapedText</span>(InRunKey, InText);</span><br><span class="line"></span><br><span class="line">	TOptional&lt;int32&gt; MeasuredWidth = ShapedText-&gt;<span class="built_in">GetMeasuredWidth</span>(InMeasureRange.BeginIndex, InMeasureRange.EndIndex);</span><br><span class="line">	<span class="keyword">if</span> (!MeasuredWidth.<span class="built_in">IsSet</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		FCachedShapedTextKey MeasureKey = InRunKey;</span><br><span class="line">		MeasureKey.TextRange = InMeasureRange;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Couldn&#x27;t measure the sub-range, try and measure from a shape of the specified range</span></span><br><span class="line">		ShapedText = InShapedTextCache-&gt;<span class="built_in">FindOrAddShapedText</span>(MeasureKey, InText);</span><br><span class="line">		MeasuredWidth = ShapedText-&gt;<span class="built_in">GetMeasuredWidth</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">check</span>(MeasuredWidth.<span class="built_in">IsSet</span>());</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">FVector2D</span>(MeasuredWidth.<span class="built_in">GetValue</span>(), ShapedText-&gt;<span class="built_in">GetMaxTextHeight</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>As you can see, the <code>FShapedGlyphSequenceRef</code> is a shared reference of <code>FShapedGlyphSequence</code>. Then, what the hell is <code>FShapedGlyphSequence</code> ? And what it does ?</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">FShapedGlyphSequenceRef <span class="title">FShapedTextCache::FindOrAddShapedText</span><span class="params">(<span class="type">const</span> FCachedShapedTextKey&amp; InKey, <span class="type">const</span> TCHAR* InText)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	FShapedGlyphSequencePtr ShapedText = <span class="built_in">FindShapedText</span>(InKey);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!ShapedText.<span class="built_in">IsValid</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		ShapedText = <span class="built_in">AddShapedText</span>(InKey, InText);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ShapedText.<span class="built_in">ToSharedRef</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">FShapedGlyphSequencePtr <span class="title">FShapedTextCache::FindShapedText</span><span class="params">(<span class="type">const</span> FCachedShapedTextKey&amp; InKey)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	FShapedGlyphSequencePtr ShapedText = CachedShapedText.<span class="built_in">FindRef</span>(InKey);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (ShapedText.<span class="built_in">IsValid</span>() &amp;&amp; !ShapedText-&gt;<span class="built_in">IsDirty</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> ShapedText;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">FShapedGlyphSequenceRef <span class="title">FShapedTextCache::AddShapedText</span><span class="params">(<span class="type">const</span> FCachedShapedTextKey&amp; InKey, FShapedGlyphSequenceRef InShapedText)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	CachedShapedText.<span class="built_in">Add</span>(InKey, InShapedText);</span><br><span class="line">	<span class="keyword">return</span> InShapedText;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>First, engine tries to find if there is already existing one. If not, creates new one and insert it into the cache.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// FontCache.h</span></span><br><span class="line"><span class="comment">/** Information for rendering a shaped text sequence */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SLATECORE_API</span> FShapedGlyphSequence</span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="comment">/** Array of glyphs in this sequence. This data will be ordered so that you can iterate and draw left-to-right, which means it will be backwards for right-to-left languages */</span></span><br><span class="line">	TArray&lt;FShapedGlyphEntry&gt; GlyphsToRender;</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Information for rendering one glyph in a shaped text sequence */</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FShapedGlyphEntry</span></span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="comment">/** The index of this glyph from the source text. The source indices may skip characters if the sequence contains ligatures, additionally, some characters produce multiple glyphs leading to duplicate source indices */</span></span><br><span class="line">	int32 SourceIndex = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">/** The amount to advance in X before drawing the next glyph in the sequence */</span></span><br><span class="line">	int16 XAdvance = <span class="number">0</span>;</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line"><span class="comment">// FontCache.cpp</span></span><br><span class="line">FShapedGlyphSequence::<span class="built_in">FShapedGlyphSequence</span>(TArray&lt;FShapedGlyphEntry&gt; InGlyphsToRender, <span class="type">const</span> int16 InTextBaseline, <span class="type">const</span> uint16 InMaxTextHeight, <span class="type">const</span> UObject* InFontMaterial, <span class="type">const</span> FFontOutlineSettings&amp; InOutlineSettings, <span class="type">const</span> FSourceTextRange&amp; InSourceTextRange)</span><br><span class="line">	: <span class="built_in">GlyphsToRender</span>(<span class="built_in">MoveTemp</span>(InGlyphsToRender))</span><br><span class="line">	, <span class="built_in">TextBaseline</span>(InTextBaseline)</span><br><span class="line">	, <span class="built_in">MaxTextHeight</span>(InMaxTextHeight)</span><br><span class="line">	, <span class="built_in">FontMaterial</span>(InFontMaterial)</span><br><span class="line">	, <span class="built_in">OutlineSettings</span>(InOutlineSettings)</span><br><span class="line">	, <span class="built_in">SequenceWidth</span>(<span class="number">0</span>)</span><br><span class="line">	, <span class="built_in">GlyphFontFaces</span>()</span><br><span class="line">	, <span class="built_in">SourceIndicesToGlyphData</span>(InSourceTextRange)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">const</span> int32 NumGlyphsToRender = GlyphsToRender.<span class="built_in">Num</span>();</span><br><span class="line">	<span class="keyword">for</span> (int32 CurrentGlyphIndex = <span class="number">0</span>; CurrentGlyphIndex &lt; NumGlyphsToRender; ++CurrentGlyphIndex)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">const</span> FShapedGlyphEntry&amp; CurrentGlyph = GlyphsToRender[CurrentGlyphIndex];</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Track unique font faces</span></span><br><span class="line">		<span class="keyword">if</span> (CurrentGlyph.FontFaceData-&gt;FontFace.<span class="built_in">IsValid</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			GlyphFontFaces.<span class="built_in">AddUnique</span>(CurrentGlyph.FontFaceData-&gt;FontFace);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Update the measured width</span></span><br><span class="line">		SequenceWidth += CurrentGlyph.XAdvance;</span><br><span class="line">		...</span><br></pre></td></tr></table></figure>

<p>The <code>FShapedGlyphSequence</code> has a TArray of <code>FShapedGlyphEntry</code>. And the <code>FShapedGlyphEntry</code> has several properties such as <code>SourceIndex</code> and <code>XAdvance</code>. Looks like the <code>FShapedGlyphEntry</code> has properties responding each character in text, and the <code>FShapedGlyphSequence</code> has properties responding whole text. The properties are for how to render the text appropriately. So here, we can regard the term <code>Glyph</code> as one single character.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SlateTextShaper.cpp</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FSlateTextShaper::PerformKerningOnlyTextShaping</span><span class="params">(<span class="type">const</span> TCHAR* InText, <span class="type">const</span> int32 InTextStart, <span class="type">const</span> int32 InTextLen, <span class="type">const</span> FSlateFontInfo&amp; InFontInfo, <span class="type">const</span> <span class="type">float</span> InFontScale, TArray&lt;FShapedGlyphEntry&gt;&amp; OutGlyphsToRender)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">for</span> (int32 SequenceCharIndex = <span class="number">0</span>; SequenceCharIndex &lt; KerningOnlyTextSequenceEntry.TextLength; ++SequenceCharIndex)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">const</span> int32 CurrentCharIndex = KerningOnlyTextSequenceEntry.TextStartIndex + SequenceCharIndex;</span><br><span class="line">		<span class="type">const</span> TCHAR CurrentChar = InText[CurrentCharIndex];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (!<span class="built_in">InsertSubstituteGlyphs</span>(InText, CurrentCharIndex, ShapedGlyphFaceData, AdvanceCache, OutGlyphsToRender, LetterSpacingScaled))</span><br><span class="line">		&#123;</span><br><span class="line">			uint32 GlyphIndex = <span class="built_in">FT_Get_Char_Index</span>(KerningOnlyTextSequenceEntry.FaceAndMemory-&gt;<span class="built_in">GetFace</span>(), CurrentChar);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// If the given font can&#x27;t render that character (as the fallback font may be missing), try again with the fallback character</span></span><br><span class="line">			<span class="keyword">if</span> (CurrentChar != <span class="number">0</span> &amp;&amp; GlyphIndex == <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				GlyphIndex = <span class="built_in">FT_Get_Char_Index</span>(KerningOnlyTextSequenceEntry.FaceAndMemory-&gt;<span class="built_in">GetFace</span>(), SlateFontRendererUtils::InvalidSubChar);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			int16 XAdvance = <span class="number">0</span>;</span><br><span class="line">			&#123;</span><br><span class="line">				FT_Fixed CachedAdvanceData = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">if</span> (AdvanceCache-&gt;<span class="built_in">FindOrCache</span>(GlyphIndex, CachedAdvanceData))</span><br><span class="line">				&#123;</span><br><span class="line">					XAdvance = FreeTypeUtils::<span class="built_in">Convert26Dot6ToRoundedPixel</span>&lt;int16&gt;((CachedAdvanceData + (<span class="number">1</span>&lt;&lt;<span class="number">9</span>)) &gt;&gt; <span class="number">10</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="type">const</span> int32 CurrentGlyphEntryIndex = OutGlyphsToRender.<span class="built_in">AddDefaulted</span>();</span><br><span class="line">			FShapedGlyphEntry&amp; ShapedGlyphEntry = OutGlyphsToRender[CurrentGlyphEntryIndex];</span><br><span class="line">			ShapedGlyphEntry.FontFaceData = ShapedGlyphFaceData;</span><br><span class="line">			ShapedGlyphEntry.GlyphIndex = GlyphIndex;</span><br><span class="line">			ShapedGlyphEntry.SourceIndex = CurrentCharIndex;</span><br><span class="line">			ShapedGlyphEntry.XAdvance = XAdvance;</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>Usually, the <code>XAdvande</code> is determined at <code>FSlateTextShaper::PerformKerningOnlyTextShaping()</code>. Engine uses <a target="_blank" rel="noopener" href="https://gitlab.freedesktop.org/freetype/freetype">the FreeType library</a> for getting a estimated size of character when it rendered. The <code>GlyphIndex</code> is calculated based on font and character value.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">FFreeTypeAdvanceCache::FindOrCache</span><span class="params">(<span class="type">const</span> uint32 InGlyphIndex, FT_Fixed&amp; OutCachedAdvance)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// Try and find the advance from the cache...</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">const</span> FT_Fixed* FoundCachedAdvance = AdvanceMap.<span class="built_in">Find</span>(InGlyphIndex);</span><br><span class="line">		<span class="keyword">if</span> (FoundCachedAdvance)</span><br><span class="line">		&#123;</span><br><span class="line">			OutCachedAdvance = *FoundCachedAdvance;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	FreeTypeUtils::<span class="built_in">ApplySizeAndScale</span>(Face, FontSize, FontScale);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// No cached data, go ahead and add an entry for it...</span></span><br><span class="line">	<span class="type">const</span> FT_Error Error = <span class="built_in">FT_Get_Advance</span>(Face, InGlyphIndex, LoadFlags, &amp;OutCachedAdvance);</span><br><span class="line">	<span class="keyword">if</span> (Error == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (!<span class="built_in">FT_IS_SCALABLE</span>(Face) &amp;&amp; <span class="built_in">FT_HAS_FIXED_SIZES</span>(Face))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// Fixed size fonts don&#x27;t support scaling, but we calculated the scale to use for the glyph in ApplySizeAndScale</span></span><br><span class="line">			OutCachedAdvance = <span class="built_in">FT_MulFix</span>(OutCachedAdvance, ((LoadFlags &amp; FT_LOAD_VERTICAL_LAYOUT) ? Face-&gt;size-&gt;metrics.y_scale : Face-&gt;size-&gt;metrics.x_scale));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		AdvanceMap.<span class="built_in">Add</span>(InGlyphIndex, OutCachedAdvance);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The code <code>AdvanceCache-&gt;FindOrCache(GlyphIndex, CachedAdvanceData)</code> finds at cache, but it creates new one and cache it if could not find. The <code>FT_Get_Advance()</code> returns the result with parameter <code>&amp;OutCachedAdvance</code>. We can get a size of single character through the function because the value <code>GlyphIndex</code> includes information of font and character value.</p>
<img src="/2022/03/22/how-the-text-wrap-works-in-unrealengine/05.png" class="">

<p>In our test text <code>Text Block Test</code>, the result is like below:</p>
<table>
<thead>
<tr>
<th>Index</th>
<th>Character</th>
<th>GlyphIndex</th>
<th>XAdvance</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td><code>T</code></td>
<td>55</td>
<td>18</td>
</tr>
<tr>
<td>1</td>
<td><code>e</code></td>
<td>72</td>
<td>17</td>
</tr>
<tr>
<td>2</td>
<td><code>x</code></td>
<td>91</td>
<td>16</td>
</tr>
<tr>
<td>3</td>
<td><code>t</code></td>
<td>87</td>
<td>11</td>
</tr>
<tr>
<td>4</td>
<td><code> </code></td>
<td>3</td>
<td>8</td>
</tr>
<tr>
<td>5</td>
<td><code>B</code></td>
<td>37</td>
<td>20</td>
</tr>
<tr>
<td>6</td>
<td><code>l</code></td>
<td>79</td>
<td>9</td>
</tr>
<tr>
<td>7</td>
<td><code>o</code></td>
<td>82</td>
<td>18</td>
</tr>
<tr>
<td>8</td>
<td><code>c</code></td>
<td>70</td>
<td>17</td>
</tr>
<tr>
<td>9</td>
<td><code>k</code></td>
<td>78</td>
<td>17</td>
</tr>
<tr>
<td>10</td>
<td><code> </code></td>
<td>3</td>
<td>8</td>
</tr>
<tr>
<td>11</td>
<td><code>T</code></td>
<td>55</td>
<td>18</td>
</tr>
<tr>
<td>12</td>
<td><code>e</code></td>
<td>72</td>
<td>17</td>
</tr>
<tr>
<td>13</td>
<td><code>s</code></td>
<td>86</td>
<td>17</td>
</tr>
<tr>
<td>14</td>
<td><code>t</code></td>
<td>87</td>
<td>11</td>
</tr>
</tbody></table>
<img src="/2022/03/22/how-the-text-wrap-works-in-unrealengine/07.png" class="">

<p>You can see that the same character has the same XAdvance value. For example, The character <code>T</code> has <code>55</code> of GlyphIndex and <code>18</code> of XAdvance. Go back to the <code>ShapedTextCacheUtil::MeasureShapedText()</code>, that is why the <code>MeasuredWidth</code> has a value of <code>220 â‰’ 222 = 18 + 17 + ... + 17 + 11</code>. The difference <code>2</code> occurs by the kerning.</p>
<img src="/2022/03/22/how-the-text-wrap-works-in-unrealengine/06.png" class="">

<p>The final width may differ a little bit because some combination of characters need a kerning. For example, though <code>e</code> and <code>k</code> have the same XAdvance value <code>17</code>, a combination <code>Te</code> has a small size than a combination <code>Tk</code>. Because in the combination <code>Te</code>, <code>e</code> can stick to <code>T</code> closer than <code>k</code> in <code>Tk</code>. In other words, a character <code>T</code> can have XAdvance of <code>17</code> in the combinations such as <code>Ta/Tc/Td</code>, and so on. Otherwise such as <code>Tb/Tf/Th</code>, it can have XAdvance of <code>18</code>.</p>
<h1 id="Break-lines-3-3-Creating-lines-with-wrapping"><a href="#Break-lines-3-3-Creating-lines-with-wrapping" class="headerlink" title="Break lines (3/3); Creating lines with wrapping"></a><em><code>Break lines (3/3); Creating lines with wrapping</code></em></h1><img src="/2022/03/22/how-the-text-wrap-works-in-unrealengine/08.png" class="">

<p>Go back to the <code>FTextLayout::CreateLineWrappingCache()</code>, now we can wrap text according to size (exactly, width) of each slice. All slices are stored at the container <code>BreakCandidates</code>. In our test text <code>Text Block Test</code>, the result is like below:</p>
<table>
<thead>
<tr>
<th>BreakCandidates</th>
<th>ActualRange</th>
<th>TrimmedRange</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td><code>Text </code> [0, 5)</td>
<td><code>Text</code> [0, 4)</td>
</tr>
<tr>
<td>1</td>
<td><code>Block </code> [5, 11)</td>
<td><code>Block</code> [5, 10)</td>
</tr>
<tr>
<td>2</td>
<td><code>Test</code> [11, 15)</td>
<td><code>Test</code> [11, 15)</td>
</tr>
</tbody></table>
<p>â€» <code>[0, 5)</code> is equal to <code>[0, 4]</code></p>
<p>Do you remember there is a code calls <code>FTextLayout::FlowLineLayout()</code> in <code>FTextLayout::FlowLayout()</code> ?</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTextLayout::FlowLineLayout</span><span class="params">(<span class="type">const</span> int32 LineModelIndex, <span class="type">const</span> <span class="type">float</span> WrappingDrawWidth, TArray&lt;TSharedRef&lt;ILayoutBlock&gt;&gt;&amp; SoftLine)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="type">float</span> CurrentWidth = <span class="number">0.0f</span>;</span><br><span class="line">	<span class="keyword">for</span> (int32 BreakIndex = <span class="number">0</span>; BreakIndex &lt; LineModel.BreakCandidates.<span class="built_in">Num</span>(); BreakIndex++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">const</span> FBreakCandidate&amp; Break = LineModel.BreakCandidates[ BreakIndex ];</span><br><span class="line"></span><br><span class="line">		<span class="type">const</span> <span class="type">bool</span> IsLastBreak = BreakIndex + <span class="number">1</span> == LineModel.BreakCandidates.<span class="built_in">Num</span>();</span><br><span class="line">		<span class="type">const</span> <span class="type">bool</span> IsFirstBreakOnSoftLine = CurrentWidth == <span class="number">0.0f</span>;</span><br><span class="line">		<span class="type">const</span> int8 Kerning = ( IsFirstBreakOnSoftLine ) ? Break.Kerning : <span class="number">0</span>;</span><br><span class="line">		<span class="type">const</span> <span class="type">bool</span> BreakDoesFit = CurrentWidth + Break.ActualSize.X + Kerning &lt;= WrappingDrawWidth;</span><br><span class="line">		<span class="type">const</span> <span class="type">bool</span> BreakWithoutTrailingWhitespaceDoesFit = CurrentWidth + Break.TrimmedWidth + Kerning &lt;= WrappingDrawWidth;</span><br><span class="line">		...</span><br></pre></td></tr></table></figure>

<p>Here, we accumulate a width of each BreakCandidate on <code>CurrentWidth</code>. And wrapping text occurs whenever <code>CurrentWidth</code> almost reaches to <code>WrappingDrawWidth</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( !BreakDoesFit || IsLastBreak )</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">bool</span> IsFirstBreak = BreakIndex == <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> FBreakCandidate&amp; FinalBreakOnSoftLine = ( !IsFirstBreak &amp;&amp; !IsFirstBreakOnSoftLine &amp;&amp; !BreakWithoutTrailingWhitespaceDoesFit ) ? LineModel.BreakCandidates[ --BreakIndex ] : Break;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// We want the wrapped line width to contain the first piece of trailing whitespace for a line, however we only do this if we have trailing whitespace</span></span><br><span class="line">	<span class="comment">// otherwise very long non-breaking words can cause the wrapped line width to expand beyond the desired wrap width</span></span><br><span class="line">	<span class="type">float</span> WrappedLineWidth = CurrentWidth;</span><br><span class="line">	<span class="keyword">if</span> ( BreakWithoutTrailingWhitespaceDoesFit )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// This break has trailing whitespace</span></span><br><span class="line">		WrappedLineWidth += ( FinalBreakOnSoftLine.TrimmedWidth + FinalBreakOnSoftLine.FirstTrailingWhitespaceCharWidth );</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// This break is longer than the wrapping point, so make sure and clamp the line size to the given wrapping width</span></span><br><span class="line">		WrappedLineWidth += FinalBreakOnSoftLine.ActualSize.X;</span><br><span class="line">		WrappedLineWidth = FMath::<span class="built_in">Min</span>(WrappedLineWidth, WrappingDrawWidth);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// We want wrapped lines to ignore any trailing whitespace when justifying</span></span><br><span class="line">	<span class="comment">// If FinalBreakOnSoftLine isn&#x27;t the current Break, then the size of FinalBreakOnSoftLine (including its trailing whitespace) will have already</span></span><br><span class="line">	<span class="comment">// been added to CurrentWidth, so we need to remove that again before adding the trimmed width (which is the width we should justify with)</span></span><br><span class="line">	<span class="comment">// We should not attempt to adjust the last break on a soft-line as that might have explicit trailing whitespace</span></span><br><span class="line">	TOptional&lt;<span class="type">float</span>&gt; JustifiedLineWidth;</span><br><span class="line">	<span class="keyword">if</span> ( &amp;FinalBreakOnSoftLine != &amp;LineModel.BreakCandidates.<span class="built_in">Last</span>() )</span><br><span class="line">	&#123;</span><br><span class="line">		JustifiedLineWidth = CurrentWidth - (&amp;FinalBreakOnSoftLine == &amp;Break ? <span class="number">0.0f</span> : FinalBreakOnSoftLine.ActualSize.X) + FinalBreakOnSoftLine.TrimmedWidth;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">CreateLineViewBlocks</span>( LineModelIndex, FinalBreakOnSoftLine.ActualRange.EndIndex, WrappedLineWidth, JustifiedLineWidth, <span class="comment">/*OUT*/</span>CurrentRunIndex, <span class="comment">/*OUT*/</span>CurrentRendererIndex, <span class="comment">/*OUT*/</span>PreviousBlockEnd, SoftLine );</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( CurrentRunIndex &lt; LineModel.Runs.<span class="built_in">Num</span>() &amp;&amp; FinalBreakOnSoftLine.ActualRange.EndIndex == LineModel.Runs[ CurrentRunIndex ].<span class="built_in">GetTextRange</span>().EndIndex )</span><br><span class="line">	&#123;</span><br><span class="line">		++CurrentRunIndex;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	PreviousBlockEnd = FinalBreakOnSoftLine.ActualRange.EndIndex;</span><br><span class="line"></span><br><span class="line">	CurrentWidth = <span class="number">0.0f</span>;</span><br><span class="line">	SoftLine.<span class="built_in">Reset</span>();</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>Usually, when wrapping text needed, the codes above would be executed. <code>FinalBreakOnSoftLine</code> indicates the BreakCandidate that needs a new line after itself. In our test text <code>Text Block Test</code>, <code>Text </code> could be assigned.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTextLayout::CreateLineViewBlocks</span><span class="params">( int32 LineModelIndex, <span class="type">const</span> int32 StopIndex, <span class="type">const</span> <span class="type">float</span> WrappedLineWidth, <span class="type">const</span> TOptional&lt;<span class="type">float</span>&gt;&amp; JustificationWidth, int32&amp; OutRunIndex, int32&amp; OutRendererIndex, int32&amp; OutPreviousBlockEnd, TArray&lt; TSharedRef&lt; ILayoutBlock &gt; &gt;&amp; OutSoftLine )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="comment">// Add the new block</span></span><br><span class="line">	&#123;</span><br><span class="line">		FBlockDefinition BlockDefine;</span><br><span class="line">		BlockDefine.ActualRange = <span class="built_in">FTextRange</span>(BlockBeginIndex, BlockStopIndex);</span><br><span class="line">		BlockDefine.Renderer = BlockRenderer;</span><br><span class="line"></span><br><span class="line">		OutSoftLine.<span class="built_in">Add</span>( Run.<span class="built_in">CreateBlock</span>( BlockDefine, Scale, <span class="built_in">FLayoutBlockTextContext</span>(RunTextContext, BlockTextDirection) ) );</span><br><span class="line">		OutPreviousBlockEnd = BlockStopIndex;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Update the soft line bounds based on this new block (needed within this loop due to bi-directional text, as the extents of the line array are not always the start and end of the range)</span></span><br><span class="line">		<span class="type">const</span> FTextRange&amp; BlockRange = OutSoftLine.<span class="built_in">Last</span>()-&gt;<span class="built_in">GetTextRange</span>();</span><br><span class="line">		SoftLineRange.BeginIndex = FMath::<span class="built_in">Min</span>(SoftLineRange.BeginIndex, BlockRange.BeginIndex);</span><br><span class="line">		SoftLineRange.EndIndex   = FMath::<span class="built_in">Max</span>(SoftLineRange.EndIndex, BlockRange.EndIndex);</span><br><span class="line">	&#125;</span><br><span class="line">	...</span><br><span class="line">	FTextLayout::FLineView LineView;</span><br><span class="line">	LineView.Offset = CurrentOffset;</span><br><span class="line">	LineView.Size = LineSize;</span><br><span class="line">	LineView.TextHeight = UnscaleLineHeight;</span><br><span class="line">	LineView.JustificationWidth = JustificationWidth.<span class="built_in">Get</span>(LineView.Size.X);</span><br><span class="line">	LineView.Range = SoftLineRange;</span><br><span class="line">	LineView.TextBaseDirection = LineModel.TextBaseDirection;</span><br><span class="line">	LineView.ModelIndex = LineModelIndex;</span><br><span class="line">	LineView.Blocks.<span class="built_in">Append</span>( OutSoftLine );</span><br><span class="line"></span><br><span class="line">	LineViews.<span class="built_in">Add</span>( LineView );</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>The function <code>FTextLayout::CreateLineViewBlocks()</code> creates new <code>FTextLayout::FLineView</code> and adds it into initialized <code>LineViews</code>. We already cleared the <code>LineViews</code> at the function <code>FTextLayout::ClearView()</code>. In our test txt, after all process, the <code>LineViews</code> will have the value like below:</p>
<table>
<thead>
<tr>
<th>LineViews</th>
<th>Range</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>[0, 5)</td>
</tr>
<tr>
<td>1</td>
<td>[5, 11)</td>
</tr>
<tr>
<td>2</td>
<td>[11, 15)</td>
</tr>
</tbody></table>
<img src="/2022/03/22/how-the-text-wrap-works-in-unrealengine/09.png" class="">

<p>Finally, we found that the result of wrapping text. All of prerequisites are for splitting a text. Now we understand how the text can be wrapped in UnrealEngine.</p>
<h1 id="Wrap-up"><a href="#Wrap-up" class="headerlink" title="Wrap-up"></a><em><code>Wrap-up</code></em></h1><p>Text wrapping in UnrealEngine can be divided into 3 major steps.</p>
<ol>
<li><p><code>Separating a text into slices</code><br>Find where each word ends using ICU library.<br>Separate text into slices based on the indices.</p>
</li>
<li><p><code>Measuring size of each slice</code><br>Estimate size of rendered character using FreeType library.<br>Apply several modifications such as kerning, shadow, and so on.</p>
</li>
<li><p><code>Creating lines with wrapping</code><br>Add width until it reaches the wrapping width.<br>When it reaches, create new line.</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2022/03/22/how-the-text-wrap-works-in-unrealengine/" data-id="clw53237r000qdkqm3soxc8fp" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2022/03/22/how-the-text-wrap-works-in-unrealengine/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TextBlock/" rel="tag">TextBlock</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TextWrap/" rel="tag">TextWrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-how-to-rename-your-project-in-unrealengine" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/02/22/how-to-rename-your-project-in-unrealengine/" class="article-date">
  <time datetime="2022-02-22T13:36:08.000Z" itemprop="datePublished">2022-02-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/02/22/how-to-rename-your-project-in-unrealengine/">How to rename your project in UnrealEngine</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>Environment</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>UnrealEngine</td>
<td><code>branch: 5.0</code></td>
</tr>
<tr>
<td>Visual Studio 2022</td>
<td><code>version: 17.0.4</code></td>
</tr>
<tr>
<td>Windows 11 Pro</td>
<td><code>build: 22000.493</code></td>
</tr>
</tbody></table>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a><em><code>Overview</code></em></h1><p>Sometimes, you might need to rename your project in some reasons.</p>
<ul>
<li>Just you may be bored with that name.</li>
<li>To unify the name same with your team name.</li>
<li>Due to change on design of gameâ€¦etc.</li>
</ul>
<p>Unfortunately, in those situations, UnrealEngine does not provide any feature to rename your project.<br>So, in this post, we gonna find out how to rename your project manually.</p>
<h1 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a><em><code>Prerequisites</code></em></h1><img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/01.png" class="">

<p>Suppose we have a project created from template <code>Third Person</code> with options above.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[ProjectRoot]/Source/SomeProjectA/SomeProjectACharacter.<span class="function">h</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">UCLASS</span><span class="params">(config=Game)</span></span></span><br><span class="line"><span class="function"><span class="keyword">class</span> ASomeProjectACharacter : public ACharacter</span></span><br><span class="line"><span class="function">&#123;</span></span><br><span class="line">    <span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Camera boom positioning the camera behind the character */</span></span><br><span class="line">    <span class="built_in">UPROPERTY</span>(VisibleAnywhere, BlueprintReadOnly, Category = Camera, meta = (AllowPrivateAccess = <span class="string">&quot;true&quot;</span>))</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">USpringArmComponent</span>* CameraBoom;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/** Returns CameraBoom subobject **/</span></span><br><span class="line">    <span class="function">FORCEINLINE <span class="keyword">class</span> USpringArmComponent* <span class="title">GetCameraBoom</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> CameraBoom; &#125;</span><br><span class="line">    <span class="comment">/** Returns FollowCamera subobject **/</span></span><br><span class="line">    <span class="function">FORCEINLINE <span class="keyword">class</span> UCameraComponent* <span class="title">GetFollowCamera</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> FollowCamera; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UFUCTION</span>(BlueprintPure)</span><br><span class="line">    <span class="function"><span class="type">const</span> FString <span class="title">GetSomeString</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">TEXT</span>(<span class="string">&quot;SomeString&quot;</span>); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>After the project created, make a simple function <code>GetSomeString()</code> in the character class, which returns some string. We will try to migrate the function for example later in this post. Now, build editor with the combo <code>Development Editor + Win64</code> and run it.</p>
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/02.png" class="">

<p>You can find a character blueprint created from template in the <code>Content/ThirdPersonCPP/Blueprints/ThirdPersonCharacter</code>. Furthermore, the blueprint has a parent class as the cpp class <code>SomeProjectACharacter</code>. It means that the blueprint can use the function we have just made.</p>
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/03.png" class="">

<p>I think it would be proper to print that string when character spawned. Make some blueprint nodes for printing that string. Now, compile and save it.</p>
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/04.png" class="">

<p>Check it works out. You should be able to see that string <code>SomeString</code> through the screen. Great.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.../SomeProjectA&gt; git log</span><br><span class="line">commit 32688a379adc5fad30ae7ba9765816684c62d05e (HEAD -&gt; master)</span><br><span class="line">Author: MinCheon Bae &lt;baemincheon@gmail.com&gt;</span><br><span class="line"></span><br><span class="line">    Initial commit</span><br><span class="line">.../SomeProjectA&gt; git status</span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br></pre></td></tr></table></figure>

<p>I setup the project directory as git repository to clarify what is changed. You do not have to follow this, it is optional. But, you should prepare a gitignore fits in UnrealEngine if you want to follow this. (For example, <a target="_blank" rel="noopener" href="https://github.com/github/gitignore/blob/main/UnrealEngine.gitignore">https://github.com/github/gitignore/blob/main/UnrealEngine.gitignore</a>)</p>
<p>We are all prepared, and let us change the name of project from <code>SomeProjectA</code> into <code>OtherProjectB</code>.</p>
<h1 id="Step-1-Clean-up"><a href="#Step-1-Clean-up" class="headerlink" title="Step #1; Clean-up"></a><em><code>Step #1; Clean-up</code></em></h1><p>First of all, we should remove some files. Some files and folders are generated by other files, so we do not have to care about that files would be generated later. Thus, we would better remove those files or folders listed below:</p>
<ul>
<li><code>.vs/</code></li>
<li><code>Binaries/</code></li>
<li><code>DerivedDataCache/</code></li>
<li><code>Intermediate/</code></li>
<li><code>Saved/</code></li>
<li><code>[ProjectName].sln</code></li>
</ul>
<p>You can check if the files or folders are generated. Remove them and generate VisualStudio project files. Then, files and folders related to VisualStudio would be generated. And you can build your project from VisualStudio project. After all, you will see the files and folders listed above are restored.</p>
<p>Plus, that is why gitignore for UnrealEngine contains those files or folders. We do not need them to be version-controlled.</p>
<h1 id="Step-2-Change-contents-of-files"><a href="#Step-2-Change-contents-of-files" class="headerlink" title="Step #2; Change contents of files"></a><em><code>Step #2; Change contents of files</code></em></h1><p>Now it is time to rename the project. There are some files usually contain the name of project in its contents. Therefore, we should change that part of contents. In this goal, we will manipulate the files likeâ€¦</p>
<ul>
<li>all of files in <code>Config/</code><ul>
<li><code>.ini</code> files such as <code>DefaultEngine.ini</code></li>
</ul>
</li>
<li>all of files in <code>Source/</code></li>
<li><code>[ProjectName].uproject</code></li>
</ul>
<p>Maybe there some files contain the name of project in the folder <code>Content/</code>. Such as an absolute path of media file, and a blueprint class inherites a cpp class whose name contains the name of project. However, basically the files in <code>Content/</code> are binary type. So, manipulating its contents as text might not ensure a result we expect. In worst case, the manipulation could break some references between blueprints. That is why we handle only the files of text type in this step.</p>
<p>By the way, I recommend you to use <a target="_blank" rel="noopener" href="https://notepad-plus-plus.org/">notepad++</a> when manipulating multiple text files, and I will use that in this post. It is open source and provides powerful features. The tool supports Windows and you can install it for ease. You do not have to install it, but I will show an example based on the tool.</p>
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/05.png" class="">

<p>Open the notepad++ and drag your project folder from file explorer into notepad++. Now notepad++ would show the folder as list view at the left sidebar.</p>
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/06.png" class="">
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/07.png" class="">

<p>Right click on <code>Config/</code> and select <code>Find in Files...</code>. Then, a dialog for search would appear.</p>
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/08.png" class="">

<p>Click the tab <code>Find in Files</code> and type <code>SomeProjectA</code> and <code>OtherProjectB</code> respectively at <code>Find what</code> and <code>Replace with</code>. After that, click <code>Replace in Files</code>.</p>
<p>Repeat the steps on <code>Source/</code> folder.</p>
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/09.png" class="">

<p>Open the <code>.uproject</code> file and Replace in similar manner.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.../SomeProjectA&gt; git status</span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   Config/DefaultEngine.ini</span><br><span class="line">        modified:   SomeProjectA.uproject</span><br><span class="line">        modified:   Source/SomeProjectA.Target.cs</span><br><span class="line">        modified:   Source/SomeProjectA/SomeProjectA.Build.cs</span><br><span class="line">        modified:   Source/SomeProjectA/SomeProjectA.cpp</span><br><span class="line">        modified:   Source/SomeProjectA/SomeProjectACharacter.cpp</span><br><span class="line">        modified:   Source/SomeProjectA/SomeProjectACharacter.h</span><br><span class="line">        modified:   Source/SomeProjectA/SomeProjectAGameMode.cpp</span><br><span class="line">        modified:   Source/SomeProjectA/SomeProjectAGameMode.h</span><br><span class="line">        modified:   Source/SomeProjectAEditor.Target.cs</span><br></pre></td></tr></table></figure>

<p>We can see some files changed. Now the contents of file get ready.</p>
<h1 id="Step-3-Change-name-of-files"><a href="#Step-3-Change-name-of-files" class="headerlink" title="Step #3; Change name of files"></a><em><code>Step #3; Change name of files</code></em></h1><p>We have changed the contents of files. Next, let us change the name of files. This also works whole project without <code>Content/</code> folder with the same reason I mentioned.</p>
<p>Open a powershell prompt and type the command like below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%ProjectRoot% &gt; Get-ChildItem -Recurse -Path Config/* | Rename-Item -NewName &#123; $_.Name.replace(&quot;SomeProjectA&quot;,&quot;OtherProjectB&quot;) &#125;</span><br></pre></td></tr></table></figure>

<p>This will change the name of all files in <code>Config/</code> folder.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%ProjectRoot% &gt; Get-ChildItem -Recurse -Path Source/* | Rename-Item -NewName &#123; $_.Name.replace(&quot;SomeProjectA&quot;,&quot;OtherProjectB&quot;) &#125;</span><br></pre></td></tr></table></figure>

<p>Apply this on <code>Source/</code> folder, too. After that, change the name of <code>.uproject</code> file and <code>[ProjectRoot]</code> folder manually.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">.../OtherProjectB&gt; git status</span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add/rm &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   Config/DefaultEngine.ini</span><br><span class="line">        deleted:    SomeProjectA.uproject</span><br><span class="line">        deleted:    Source/SomeProjectA.Target.cs</span><br><span class="line">        deleted:    Source/SomeProjectA/SomeProjectA.Build.cs</span><br><span class="line">        deleted:    Source/SomeProjectA/SomeProjectA.cpp</span><br><span class="line">        deleted:    Source/SomeProjectA/SomeProjectA.h</span><br><span class="line">        deleted:    Source/SomeProjectA/SomeProjectACharacter.cpp</span><br><span class="line">        deleted:    Source/SomeProjectA/SomeProjectACharacter.h</span><br><span class="line">        deleted:    Source/SomeProjectA/SomeProjectAGameMode.cpp</span><br><span class="line">        deleted:    Source/SomeProjectA/SomeProjectAGameMode.h</span><br><span class="line">        deleted:    Source/SomeProjectAEditor.Target.cs</span><br><span class="line"></span><br><span class="line">Untracked files:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span><br><span class="line">        OtherProjectB.uproject</span><br><span class="line">        Source/OtherProjectB.Target.cs</span><br><span class="line">        Source/OtherProjectB/</span><br><span class="line">        Source/OtherProjectBEditor.Target.cs</span><br></pre></td></tr></table></figure>

<p>Check the result with <code>git status</code> again.</p>
<h1 id="Step-4-Redirect-blueprints"><a href="#Step-4-Redirect-blueprints" class="headerlink" title="Step #4; Redirect blueprints"></a><em><code>Step #4; Redirect blueprints</code></em></h1><p>Generating VisualStudio project files okay. Building editor on VisualStudio project okay. But, there is one last task to do.</p>
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/10.png" class="">

<p>We skipped blueprint files in previous steps. But, some blueprint assets could try to use old cpp classes or codes. Therefore, you will see the dialog while opening the editor. The CDO has been broken.</p>
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/11.png" class="">

<p>Some of blueprint classes lost their parent cpp class or get broken. Especially, the blueprint class <code>ThirdPersonCharacter</code> was disconnected with its parent, old cpp class <code>SomeProjectACharacter</code>.  We need to fix it.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// DefaultEngine.ini</span><br><span class="line"></span><br><span class="line">[/Script/Engine.Engine]</span><br><span class="line">+ActiveGameNameRedirects=(OldGameName=&quot;SomeProjectA&quot;,NewGameName=&quot;/Script/OtherProjectB&quot;)</span><br><span class="line">+ActiveGameNameRedirects=(OldGameName=&quot;/Script/SomeProjectA&quot;,NewGameName=&quot;/Script/OtherProjectB&quot;)</span><br><span class="line">+ActiveClassRedirects=(OldClassName=&quot;SomeProjectAGameMode&quot;,NewClassName=&quot;OtherProjectBGameMode&quot;)</span><br><span class="line">+ActiveClassRedirects=(OldClassName=&quot;SomeProjectACharacter&quot;,NewClassName=&quot;OtherProjectBCharacter&quot;)</span><br></pre></td></tr></table></figure>

<p>Fortunately, UnrealEngine provides redirecting blueprint classes. You can set the redirection settings in <code>DefaultEngine.ini</code>. I have set the settings like above, and engine will redirect <code>SomeProjectA</code> things into <code>OtherProjectB</code> things. You should create more settings if you need. Because the example settings are from template and your project may have more classes whose CDO broken.</p>
<p>After setting up the redirection, remove <code>Binaries/</code> + <code>DerivedDataCache/</code> + <code>Saved/</code> folders. And repeat build the editor.</p>
<img src="/2022/02/22/how-to-rename-your-project-in-unrealengine/12.png" class="">

<p>Finally we meet again ! The string <code>SomeString</code> was the text we prepared. We have done renaming a project and restoring whole project.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2022/02/22/how-to-rename-your-project-in-unrealengine/" data-id="clw53237s000vdkqmfkbf9uno" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2022/02/22/how-to-rename-your-project-in-unrealengine/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-how-to-create-or-remove-cpp-class-in-unrealengine" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/" class="article-date">
  <time datetime="2022-01-11T13:08:04.000Z" itemprop="datePublished">2022-01-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/">How to create or remove CPP class in UnrealEngine</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>Environment</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>UnrealEngine</td>
<td><code>branch: 5.0</code></td>
</tr>
<tr>
<td>Visual Studio 2022</td>
<td><code>version: 17.0.4</code></td>
</tr>
<tr>
<td>Windows 11 Pro</td>
<td><code>build: 22000.376</code></td>
</tr>
</tbody></table>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a><em><code>Overview</code></em></h1><p>Developing your UnrealEngine project with only the blueprint is not easy because the blueprint has some limitations on functionalities than the native, CPP. For instance, in blueprint you can access the source code tagged by <code>BlueprintCallable</code>, <code>BlueprintType</code>, <code>BlueprintReadOnly</code>, or those series. But, in CPP you can access all of the source code as possible and even you can modify the source code of engine. In other words, using only blueprint is like using a part of UnrealEngine. So eventually, you would want to create CPP class for more functionalities. This post covers that topic; how to create CPP class in UnrealEngine.</p>
<p>Plus, not only creating something but removing something is important. I will tell you how to remove CPP class in UnrealEngine, too. Let us create a project from ThirdPerson template with the options below. I named it as <code>Unreal_5_0</code>. </p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/01.png" class="">

<h1 id="Creating-CPP-class-method-1"><a href="#Creating-CPP-class-method-1" class="headerlink" title="Creating CPP class; method #1"></a><em><code>Creating CPP class; method #1</code></em></h1><img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/02.png" class="">

<p>Open the <code>Content Drawer</code> and click <code>All/C++ Classes</code> folder. After the steps, you can see the option <code>New C++ Class...</code> when you click the <code>Add</code> button. Click it.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/03.png" class="">

<p>In this dialog, you can select a parent of new CPP class. <code>Common Classes</code> tab contains the most commonly used classes, so you should switch to <code>All Classes</code> tab and find an appropriate class if needed.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/04.png" class="">

<p>I chose the class <code>UserWidget</code> as a parent of new CPP class. Click the button <code>Next&gt;</code>.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/05.png" class="">

<p>In this dialog, you can name the new CPP class and save it with some options. I will left the name as default, <code>My[ParentClassName]</code>. The combobox beside name is for selecting a module to include this class. Our project created from ThirdPerson template starts with only one module whose name is the same with project, in this case <code>Unreal_5_0</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GameProjectUtils.h</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Where is this class located within the Source folder? */</span></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">EClassLocation</span> : uint8</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/** The class is going to a user defined location (outside of the Public, Private, or Classes) folder for this module */</span></span><br><span class="line">    UserDefined,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The class is going to the Public folder for this module */</span></span><br><span class="line">    Public,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The class is going to the Private folder for this module */</span></span><br><span class="line">    Private,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The class is going to the Classes folder for this module */</span></span><br><span class="line">    Classes,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>The radio button <code>Class Type</code> is for selecting a location of new CPP class. The enum value is <code>UserDefined</code> in default, but it would be forced to <code>Public</code> or <code>Private</code> when you select one of the radio buttons.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SNewClassDialog.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SNewClassDialog::OnClassLocationChanged</span><span class="params">(GameProjectUtils::EClassLocation InLocation)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> FString AbsoluteClassPath = FPaths::<span class="built_in">ConvertRelativePathToFull</span>(NewClassPath) / <span class="string">&quot;&quot;</span>; <span class="comment">// Ensure trailing /</span></span><br><span class="line"></span><br><span class="line">	GameProjectUtils::EClassLocation TmpClassLocation = GameProjectUtils::EClassLocation::UserDefined;</span><br><span class="line">	GameProjectUtils::<span class="built_in">GetClassLocation</span>(AbsoluteClassPath, *SelectedModuleInfo, TmpClassLocation);</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> FString RootPath = SelectedModuleInfo-&gt;ModuleSourcePath;</span><br><span class="line">	<span class="type">const</span> FString PublicPath = RootPath / <span class="string">&quot;Public&quot;</span> / <span class="string">&quot;&quot;</span>;		<span class="comment">// Ensure trailing /</span></span><br><span class="line">	<span class="type">const</span> FString PrivatePath = RootPath / <span class="string">&quot;Private&quot;</span> / <span class="string">&quot;&quot;</span>;		<span class="comment">// Ensure trailing /</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Update the class path to be rooted to the Public or Private folder based on InVisibility</span></span><br><span class="line">	<span class="keyword">switch</span> (InLocation)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> GameProjectUtils::EClassLocation::Public:</span><br><span class="line">		<span class="keyword">if</span> (AbsoluteClassPath.<span class="built_in">StartsWith</span>(PrivatePath))</span><br><span class="line">		&#123;</span><br><span class="line">			NewClassPath = AbsoluteClassPath.<span class="built_in">Replace</span>(*PrivatePath, *PublicPath);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (AbsoluteClassPath.<span class="built_in">StartsWith</span>(RootPath))</span><br><span class="line">		&#123;</span><br><span class="line">			NewClassPath = AbsoluteClassPath.<span class="built_in">Replace</span>(*RootPath, *PublicPath);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			NewClassPath = PublicPath;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">case</span> GameProjectUtils::EClassLocation::Private:</span><br><span class="line">		<span class="keyword">if</span> (AbsoluteClassPath.<span class="built_in">StartsWith</span>(PublicPath))</span><br><span class="line">		&#123;</span><br><span class="line">			NewClassPath = AbsoluteClassPath.<span class="built_in">Replace</span>(*PublicPath, *PrivatePath);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (AbsoluteClassPath.<span class="built_in">StartsWith</span>(RootPath))</span><br><span class="line">		&#123;</span><br><span class="line">			NewClassPath = AbsoluteClassPath.<span class="built_in">Replace</span>(*RootPath, *PrivatePath);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			NewClassPath = PrivatePath;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Will update ClassVisibility correctly</span></span><br><span class="line">	<span class="built_in">UpdateInputValidity</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>With these codes, the radio buttons just change the location of new CPP class. The new CPP class would be included in <code>Public</code> folder when you clicked a radio button <code>Public</code>, vice versa. This setting makes some differences especially onto accessibility.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GameProjectUtils.cpp</span></span><br><span class="line"><span class="comment">// GameProjectUtils::GenerateClassHeaderFile()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( <span class="built_in">GetClassLocation</span>(NewHeaderFileName, ModuleInfo, ClassPathLocation) )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// If this class isn&#x27;t Private, make sure and include the API macro so it can be linked within other modules</span></span><br><span class="line">    <span class="keyword">if</span> ( ClassPathLocation != EClassLocation::Private )</span><br><span class="line">    &#123;</span><br><span class="line">        ModuleAPIMacro = ModuleInfo.ModuleName.<span class="built_in">ToUpper</span>() + <span class="string">&quot;_API &quot;</span>; <span class="comment">// include a trailing space for the template formatting</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Definitions.Unreal_5_0.h</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNREAL_5_0_API DLLEXPORT</span></span><br></pre></td></tr></table></figure>

<p>Only the class of location for <code>Private</code> cannot have the macro <code>[ModuleName]_API</code>. And the macro is defined as <code>DLLEXPORT</code>. The attribute is used to export codes in MSVC, visit <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/cpp/cpp/dllexport-dllimport?view=msvc-170">here</a> for more details.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyUserWidget.h</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Blueprint/UserWidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MyUserWidget.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UNREAL_5_0_API</span> UMyUserWidget : <span class="keyword">public</span> UUserWidget</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line">	</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Of course, my new CPP class <code>MyUserWidget</code> has the macro <code>[ModuleName]_API</code> because I had not chosen any radio button. It was left as <code>UserDefined</code> and <code>UserDefined</code> is usually treated like <code>Public</code>. Then, the new CPP class would not have the macro if you clicked <code>Private</code> at the dialog.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/06.png" class="">

<p>Click <code>Create Class</code>. Engine will create intermediate files, generate project files, and build source codes.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/08.png" class="">

<p>After that, the new CPP class is ready for you.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/17.png" class="">

<p>FYI, remove <code>[ProjectRoot]/Binaries</code> folder and build again if you meet a dialog like above while opening the editor.</p>
<h1 id="Creating-CPP-class-method-2"><a href="#Creating-CPP-class-method-2" class="headerlink" title="Creating CPP class; method #2"></a><em><code>Creating CPP class; method #2</code></em></h1><p>At the method #1, you must wait for a moment while engine does a process; creating intermediate files, generating project files, and build source codes. The process of creating new CPP class is not expensive when your project is small enough, but every project gets bigger and bigger as time goes on. When it comes to the point, you would want create multiple new CPP classes and wait for only one moment. At that time, the method #2 will be able to save you.</p>
<p>The method #2 for creating new CPP class is quite simple; do it yourself what engine did for you. Let me explain step by step. Suppose you want to create new CPP class inherits <code>UserWidget</code> class.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/09.png" class="">

<p>Open your VisualStudio project. Find an location to add your new CPP class at <code>Solution Explorer</code>. I will add a class at <code>Unreal_5_0</code> folder. Select <code>Add/New Item....</code> at the option.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/10.png" class="">

<p>Select <code>Header File</code> and name the file. I will name the file as <code>SomeUserWidget.h</code>. And click the button <code>Browse...</code> to locate the file. I will locate the file as the same location in <code>Solution Explorer</code>, <code>[ProjectRoot]/Source/Unreal_5_0</code>.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/11.png" class="">

<p>After click the button <code>Add</code>, you can find the new file at both file explorer and <code>Solution Explorer</code> in VisualStudio IDE. Repeat previous steps for creating a cpp file.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/12.png" class="">

<p>Then you have two files for creating new CPP class.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/13.png" class="">

<p>But they have no contents, in other words, empty. So what ? Let us fill the contents manually. The cpp file is very simple as it has only an include statement, <code>#include &quot;[HeaderName]&quot;</code>. Problem is the header file. Usually, a generated header file from a class inherits <code>UObject</code> (or child of <code>UObject</code>) has a format like below:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright notice</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;[ParentClassHeaderFile]&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;[ThisClass].generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Comment for documentation</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="built_in">class</span> ([ModuleName]_API) U[ThisClass] : <span class="keyword">public</span> U[ParentClass]</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>For instance, we had created a class <code>MyUserWidget</code>. The header file <code>MyUserWidget.h</code> has the contents like below:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Blueprint/UserWidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MyUserWidget.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UNREAL_5_0_API</span> UMyUserWidget : <span class="keyword">public</span> UUserWidget</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>FYI, the part <code>[ModuleName]_API</code> is optional as I explained at the method #1.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/14.png" class="">

<p>Then, we can write down some codes for <code>SomeUserWidget</code>. They look like above. Alright, now we should generate intermediate files and project files. And then build the source codes.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/15.png" class="">

<p>For this, close your VisualStudio IDE. Right click the uproject file and select <code>Generate Visual Studio project files</code>.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/16.png" class="">

<p>Open your VisualStudio project after generation ends. And build the editor. The engine will generate intermediate files such as <code>generated.h</code> and <code>gen.cpp</code>. For more details about generating intermediate files, visit <a href="https://baemincheon.github.io/2021/08/06/how-unreal-macro-generated/">this post</a>.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/18.png" class="">

<p>Now build ended. Let us open the editor. We can see new class <code>SomeUserWidget</code> well.</p>
<h1 id="Removing-CPP-class"><a href="#Removing-CPP-class" class="headerlink" title="Removing CPP class"></a><em><code>Removing CPP class</code></em></h1><img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/07.png" class="">

<p>As you can see, you cannot select <code>Delete</code> at the option about CPP class in editor. Then, how we can remove a class when we do not need it ? It is quite simple, but you cannot do it in editor.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/19.png" class="">

<p>Close your editor and remove files for the class you want to remove. I will remove the files for the class <code>SomeUserWidget</code>.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/20.png" class="">

<p>And then generate project files via uproject file. Plus, you must remove <code>[ProjectRoot]/Binaries</code> folder.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/21.png" class="">

<p>Open your VisualStudio project and build editor.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/22.png" class="">

<p>Now you can see the class <code>SomeUserWidget</code> disappeared.</p>
<img src="/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/23.png" class="">

<p>Still the intermediate files could be remained. Remove <code>[ProjectRoot]/Intermediate</code> folder and repeat the steps.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/" data-id="clw53237u001adkqmf6yicw6v" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2022/01/11/how-to-create-or-remove-cpp-class-in-unrealengine/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-retrospection-2021" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/18/retrospection-2021/" class="article-date">
  <time datetime="2021-12-18T12:54:09.000Z" itemprop="datePublished">2021-12-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/18/retrospection-2021/">Retrospection 2021</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Two-years-from-beginning-a-blog"><a href="#Two-years-from-beginning-a-blog" class="headerlink" title="Two years from beginning a blog"></a><em><code>Two years from beginning a blog</code></em></h1><p>What a monumental, it has been 2 years ago when I posted the first article on this blog; <a href="https://baemincheon.github.io/2019/08/06/what-is-unreal-build-target/">The article about UnrealEngine build target.</a> I have usually written a post each month, mostly about UnrealEngine. The topic of post is chosen by my interest. For instance, things that I want to know, what I want to check, or just a record for memo.</p>
<p>An example fits in first rule is <a href="https://baemincheon.github.io/2021/08/06/how-unreal-macro-generated/">the post about UnrealEngine macro generation</a>. At that time, I was curious how UnrealEngine uses a macro for implementing its framework. Another one for second rule is <a href="https://baemincheon.github.io/2021/05/16/cpp-std-vector-growth/">the post about growth of <code>std::vector</code> in cpp</a>. At that time, I already knew there is difference between GCC and MSVC on growth size of <code>std::vector</code>. But, I had also wanted to check where the difference comes from. Last one for third rule is <a href="https://baemincheon.github.io/2021/09/10/perforce-server-setup-with-digital-ocean/">the post about how to setup Perforce server</a>. Starting a small game project, I had to setup Perforce server for my team. However, finding an easy and good manual for this was so hard that I decided to post the process of setup Perforce server. For myself and anyone.</p>
<p>Plus, almost every resource about UnrealEngine in Youtube or Google is targeting for the blueprint user, not the cpp user. So it was so hard to use a feature in cpp source code with the resources. Even they usually do not explain how the code works, just explain about how to use it. In this aspect, I am trying to explain the source code of engine for making it transparent. Furthermore, I am trying to put an example on every explanation. Because I have been tired of resources explained by only some words; Beginners cannot understand them, even follow the process without a precise description. Writing as simple as possible, demonstrating as many as possible, these policies would be maintained as long as possible.</p>
<p>I collect data via Google Analytics plugged in this blog. Top 10 pages most visited (until now) are below:</p>
<ol>
<li><code>/2020/02/09/unreal-widget-coordinate-system/</code></li>
<li><code>/2021/04/07/difference-between-build-cs-and-target-cs/</code></li>
<li><code>/2020/10/25/unreal-input-system-via-gamepad/</code></li>
<li><code>/2020/03/14/unreal-unique-pointer/</code></li>
<li><code>/2019/08/06/what-is-unreal-build-target/</code></li>
<li><code>/2019/08/11/custom-unreal-engine-build/</code></li>
<li><code>/2019/08/16/differences-of-unreal-build-targets/</code></li>
<li><code>/2020/01/28/unreal-blueprint-practical-use/</code></li>
<li><code>/2021/03/01/unreal-engine-natvis/</code></li>
<li><code>/2020/01/17/unreal-fname-anatomy/</code></li>
</ol>
<p>It seems that a post about widget, input, or build is more popular than others. For helping UnrealEngine newbies, I would better consider writing a post about those topics in next year. Looking back my experiences on studying UnrealEngine, I was also struggling for those topics.</p>
<h1 id="Career-with-UnrealEngine"><a href="#Career-with-UnrealEngine" class="headerlink" title="Career with UnrealEngine"></a><em><code>Career with UnrealEngine</code></em></h1><p>On working at PUBG Studio for 2 years, I have learned many things. (Even though some of them are not my part) Managing infra structure for large scale project, working remote in efficient way, developing and testing on console platforms, and so on. But most of all, various experiences of developing with UnrealEngine. Thanks to talented coworkersâ€™ help, I could have done my tasks.</p>
<p>Reading and understanding the engine code is essential to development of industry level, but my skill was not sufficient to do that. So, in first year, I was busy to learn about topics mentioned in conversations. It was enough to take up my time. Repeated working at office and studying at home. After that, in second year, I became to understand most of what coworkers said. I started to read more engine code deeper and deeper. It is the time when I could say that â€œI know UnrealEngineâ€¦a bit ?â€. Now, entering third year, I have plenty of skills enough to advice coworkers. Especially, many of coworkers ask me as I have experiences of console platforms. (But I still think I should learn more about console platforms)</p>
<p>I have done main tasks such as optimizing contents, fixing bugs and crashes, and making development environment better. Most of all, I want to say about only the first thing. Optimizing contents was the most challenging task. You may know the common sense in program optimization;</p>
<blockquote>
<p>When you increase a speed, an available memory would be decreased. On the other hand, when you increase an available memory, a speed would be decreased.</p>
</blockquote>
<p>Due to the structure of memory in computer, loading data from auxiliary storage is quite expensive operation. (In comparison to main storage) Anyone who wants the program to run faster would sacrifice the memory of program for loading data as much as possible. Particularly, among the programs, the size of data in game is bigger than others. That is why games try to load data before it is needed. Because any gamer does not want to see the freezed screen whenever picking up an item.</p>
<p>Rightâ€¦in this condition, optimizing contents should not be easy one. What more worse is, new contents come in the game every update. In other words, an available memory could be decreased as the total size of data increased. So, it is hard to maintain a speed of program without sacrificing an available memory. Even more and more users are using the SSD thesedays, we have to support the old-gen consoles such as XboxOne and Playstation4, which are the devices uses HDD in default. </p>
<p>Additionally, loading data asynchronously is not always a best solution. Because, eventually it also consumes the resource of computer, and results a hitch or freeze. Yeap, so we struggled to manage an available memory of our game almost every update. Mainly, we have rarely chosen to skip some data loaded before entering ingame, instead we have chosen to optimize assets or codes to reduce its size so that the total size of data get reduced. Profiling our game and finding assets or codes taking up significant times, and analyzing what the assets or codes are wrong, and optimizing themâ€¦with magical spell. (I mean, the way how to optimize contents varies every time so it is like MAGIC, which is not easy to explain)</p>
<p>What I want to do in future would be developing games with newest features of UnrealEngine. But it would be hard without engine migration as we are using 4.16 version of UnrealEngine. Additionally, it is also hard to use the most fascinating features; Nanite and Lumen, as we are supporting old-gen consoles. Maybe I keep going my tasks as before, but at least, gonna to learn the newest features of UnrealEngine. Maybe, sometime I can use them. Or, I would post with contents of them. ;)</p>
<h1 id="Move-to-new-house"><a href="#Move-to-new-house" class="headerlink" title="Move to new house"></a><em><code>Move to new house</code></em></h1><p>In the middle of 2021, I had moved to new house as mentioned at <a href="https://baemincheon.github.io/2021/10/11/my-home-network-setup-experience-2021/">this post</a>. New house is bigger than old house, and I had to buy some furnitures. (Basic furnitures such as bed, purifier, and so on are provided in old house) Therefore, I had searched several items including closet, purifier, bed, desk, and so on. Especially, I had a difficulty for buying devices related to home network. Because I never had a need to buy these tools or devices. Even when I was in Army as Signal Corps, those things were supplies. (I did not choose what to buy)</p>
<p>Now I have a living room. Trying to put a sofa, table, or something fits in living room, I decided to buy UHD TV. No, not only UHD resolutionâ€¦also 120Hz framerate should be great. That is a maximum range of next-gen consoleâ€™s signal output. Yeap, I bought a next-gen console, too. Xbox Series X (XSX). Finally it looks like below:</p>
<img src="/2021/12/18/retrospection-2021/01.jpg" class="">

<p>The TV is the product of SAMSUNG, <a target="_blank" rel="noopener" href="https://www.samsung.com/in/tvs/qled-tv/qn90a-50-inch-neo-qled-4k-smart-tv-qa50qn90aaklxl/">50QN90A</a>. It supports resolution and framerate upto UHD&#x2F;120Hz, and has 50 inches display. I am satisfied with this product in overall aspects, what a nice TV. Only one thing disappointed is, the OS of TV is TIZEN, which is SAMSUNGâ€™s proprietary OS. This OS does not have plenty of applications yet. For example, if you want to watch Twitch ? There is no twitch application in TIZEN, so you have to watch Twitch via web browser. Very inconvenient. Or you should check <a target="_blank" rel="noopener" href="https://github.com/fgl27/smarttv-twitch#installation-guide-tizen-studio-tested-on-linux-ubuntu-16-and-up-and-windows-10-64-bits">this</a>.</p>
<p>After living at new house for about 6 months, I think it was a good choice. More space gets me more comfortable, and makes it possible to stay home more than before. Still we are living with the various, so I wanted to stay home without some reason. Besides, I am also working from home, so more space is suitable for me. :)</p>
<h1 id="Thought-about-next-gen-console"><a href="#Thought-about-next-gen-console" class="headerlink" title="Thought about next-gen console"></a><em><code>Thought about next-gen console</code></em></h1><p>I cannot help saying this, I bought the next-gen console to play Battlefield 2042. Yeapâ€¦sadly, the game has totally been ruined. Huhâ€¦I might write some post for that sometime. As a fan of Battlefield series, it is so sad that people compare Cyberpunk 2077 and Battlefield 2042. Even worse, it is not easy to find any point that Battlefield 2077 is better than Cyberpunk 2077. Crap. Anyway, that is why I decided to buy a next-gen console.</p>
<p>Though a start of experience was not good, the console itself was amazing. Recently, UnrealEngine has released <a target="_blank" rel="noopener" href="https://www.unrealengine.com/en-US/wakeup?sessionInvalidated=true">The Matrix Awakens: An Unreal Engine 5 Experience</a>, which is kind of tech demo that shows what UnrealEngine 5 can do. The game runs at UHD&#x2F;30Hz with DynamicResolution on XSX, but it looks like REAL footage. At least, it seems this tech would become popular on movie industry. Already many of short films, part of films, or commercials use UnrealEngine, but currently they are using UnrealEngine for capturing a video. In other words, they are not realtime rendering. In the view, the tech demo was so impressed. â€œWow, is it possible in realtime rendering ?â€</p>
<p>Absolutely, this is not possible only with improvement of processor performance. In comparison of playing video, playing game needs more various resources not only processor resource. Playing video only needs loading next frame and next frameâ€¦until the video ends. (Displaying is none of business here) But, playing game needs loading assets should be displayed, executing codes may update the world or actors, integrating everything into a projectionâ€¦in SINGLE ONE frametime.</p>
<p>CPU takes charge of executing codes, and GPU takes charge of integrating into a projection. Then, who takes charge of loading assets ? In general, CPU and memory works for it. CPU tries to read data from memory and blocks itself until the read done, but it takes some time if memory bandwidth is low. Low bandwidth means that you are try to load data from auxiliary storage, and it must not be always faster than loading data from main storage (ex: RAM). Even the problem gets worse when the size of data bigger and bigger. Thus, people have tried several techniques; A compression skill is sometimes applied to minimize the size of data. Just loading a compressed data and decompress it into the original data. Of course, this skill needs an extra resource from CPU, which could trigger a hitch while playing a game. Next, a <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/EditorScripting/Asset/DuplicateAsset/">asset duplication</a> skill is common one in games supporting for device using HDD. The skill is for reducing the seek time of HDD, because the seek time of HDD is too slow to load data in realtime. This skill also has a drawback that the size of game package gonna be VERY large. Horrible.</p>
<p>Thankfully, both Microsoft and Sony seem to have recognized these kind of issues. Specially, Microsoft. They made an exclusive processor for decompressing data to minimize any side effect of data compression skill. Like Sony did, Microsoft customized their NVMe SSD. Furthermore, Microsoft gave game developers more flexibity atm manpulating storage by providing DirectStorage API. Finally, Sampler Feedback Streaming (SFS) could be built on these basement skills. SFS will optimize gameâ€™s memory usage and file I&#x2F;O operations. Then, Microsoft names all the skills as an architecture <a target="_blank" rel="noopener" href="https://news.xbox.com/en-us/2020/07/14/a-closer-look-at-xbox-velocity-architecture/">Xbox Velocity Architecture</a>. Previously, I did not believe their words because it looks like hype. But I do know that is an amazing advance in game development. Turning back to UnrealEngine, EpicGames did great job so far with the new features.</p>
<h1 id="Plans-on-next-year"><a href="#Plans-on-next-year" class="headerlink" title="Plans on next year"></a><em><code>Plans on next year</code></em></h1><p>Except for writing a blog post each month, I have considered some plans to do.</p>
<blockquote>
<p>Plan #1. Making a game.</p>
</blockquote>
<p>Recently, I started to develop a game. About 3 months ago, my ex-coworker had suggested an Action RPG game project, and I accepted that. I do not know when the game is released, but some milestones should be completed in next year. In 2022, there may be a playable build. Developing this game, I should develop many features or design critical systems. With these kind of experiences, I retrospect when I was a student. It is the same that struggling on every issue, but the result would be better than when I was a student.</p>
<blockquote>
<p>Plan #2. Starting to develop a game engine.</p>
</blockquote>
<p>Working as a game programmer for 2 years, I have thought that â€œHow about making my own game engine ?â€. It would be fun that developing my own game engine, proud if many games are made of it, satisfied that I could do this. This kind of thought would be similar many of programmers have a dream that making their own programming language, operating system, database system, or etc. The game engine I will develop would be lightweight, but Rust gonna be used. I want to use Rust as many as possible in developing it. Because managing the side effect of using CPP would not be easy in a small project.</p>
<blockquote>
<p>Plan #3. Publishing console application or game.</p>
</blockquote>
<p>Actually, I have already subscribed the Xbox developer plan. It was cheaper than I expected, $19 USD only one time. (Maybe I would work for Playstation sometimeâ€¦but I want to focus on Xbox now) I want to utilize this Xbox developer license. How or what to make ? Let us think about. Case first, Playing games in Xbox, I will note them if I experience some inconveniences. It would be great project if there would be something to make users convenient. Second case, making a tech demo just like The Matrix Awakens would be fun. It could be a kind of inspiration to some developers. Wellâ€¦I may not make any application or game if I am busy for other works. It is on the back burner. XD</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2021/12/18/retrospection-2021/" data-id="clw53237y002pdkqmatvl3yi2" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2021/12/18/retrospection-2021/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Retrospection/" rel="tag">Retrospection</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/About/" rel="tag">About</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Animation/" rel="tag">Animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blueprint/" rel="tag">Blueprint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CPP/" rel="tag">CPP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cat/" rel="tag">Cat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Copy/" rel="tag">Copy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DigitalOcean/" rel="tag">DigitalOcean</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GCC/" rel="tag">GCC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GoogleAnalytics/" rel="tag">GoogleAnalytics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Home/" rel="tag">Home</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Iptime/" rel="tag">Iptime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lecture/" rel="tag">Lecture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MSVC/" rel="tag">MSVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Migration/" rel="tag">Migration</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Natvis/" rel="tag">Natvis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Network/" rel="tag">Network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Perforce/" rel="tag">Perforce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Retargeting/" rel="tag">Retargeting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Retrospection/" rel="tag">Retrospection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RichTextBlock/" rel="tag">RichTextBlock</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STL/" rel="tag">STL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TextBlock/" rel="tag">TextBlock</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TextWrap/" rel="tag">TextWrap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/" rel="tag">Ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WSL/" rel="tag">WSL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/About/" style="font-size: 10px;">About</a> <a href="/tags/Animation/" style="font-size: 10px;">Animation</a> <a href="/tags/Blueprint/" style="font-size: 13.33px;">Blueprint</a> <a href="/tags/CPP/" style="font-size: 13.33px;">CPP</a> <a href="/tags/Cat/" style="font-size: 10px;">Cat</a> <a href="/tags/Copy/" style="font-size: 10px;">Copy</a> <a href="/tags/DigitalOcean/" style="font-size: 10px;">DigitalOcean</a> <a href="/tags/GCC/" style="font-size: 10px;">GCC</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/GoogleAnalytics/" style="font-size: 10px;">GoogleAnalytics</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Home/" style="font-size: 10px;">Home</a> <a href="/tags/Iptime/" style="font-size: 10px;">Iptime</a> <a href="/tags/Lecture/" style="font-size: 10px;">Lecture</a> <a href="/tags/Linux/" style="font-size: 13.33px;">Linux</a> <a href="/tags/MSVC/" style="font-size: 10px;">MSVC</a> <a href="/tags/Migration/" style="font-size: 10px;">Migration</a> <a href="/tags/Natvis/" style="font-size: 10px;">Natvis</a> <a href="/tags/Network/" style="font-size: 10px;">Network</a> <a href="/tags/Perforce/" style="font-size: 13.33px;">Perforce</a> <a href="/tags/Retargeting/" style="font-size: 10px;">Retargeting</a> <a href="/tags/Retrospection/" style="font-size: 16.67px;">Retrospection</a> <a href="/tags/RichTextBlock/" style="font-size: 10px;">RichTextBlock</a> <a href="/tags/STL/" style="font-size: 10px;">STL</a> <a href="/tags/TextBlock/" style="font-size: 13.33px;">TextBlock</a> <a href="/tags/TextWrap/" style="font-size: 10px;">TextWrap</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/UnrealEngine/" style="font-size: 20px;">UnrealEngine</a> <a href="/tags/WSL/" style="font-size: 13.33px;">WSL</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/05/13/difference-between-copy-and-cat-in-combining-files/">Difference between copy and cat in combining files</a>
          </li>
        
          <li>
            <a href="/2023/12/04/migration-from-perforce-into-git-in-windows/">Migration from Perforce into Git in Windows</a>
          </li>
        
          <li>
            <a href="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/">Conversion from UA into GA4</a>
          </li>
        
          <li>
            <a href="/2022/12/12/promotion-for-online-lecture-of-unrealengine-01/">The promotion for online lecture of UnrealEngine</a>
          </li>
        
          <li>
            <a href="/2022/10/04/retargeting-animations-in-unreal-engine-5/">Retargeting animations in UnrealEngine 5</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 MinCheon Bae<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/2020/02/03/home-page/index.html" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'let-us-go-abroad';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>