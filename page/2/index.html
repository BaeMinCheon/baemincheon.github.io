<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R2P265ZP7M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-R2P265ZP7M');
</script>
<!-- End Google Analytics -->


  
  <title>LET US GO ABROAD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="a blog for game programmer">
<meta property="og:type" content="website">
<meta property="og:title" content="LET US GO ABROAD">
<meta property="og:url" content="https://baemincheon.github.io/page/2/index.html">
<meta property="og:site_name" content="LET US GO ABROAD">
<meta property="og:description" content="a blog for game programmer">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="MinCheon Bae">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="LET US GO ABROAD" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">LET US GO ABROAD</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/2020/02/03/home-page/index.html">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://baemincheon.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-retrospection-2021" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/18/retrospection-2021/" class="article-date">
  <time datetime="2021-12-18T12:54:09.000Z" itemprop="datePublished">2021-12-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/18/retrospection-2021/">Retrospection 2021</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Two-years-from-beginning-a-blog"><a href="#Two-years-from-beginning-a-blog" class="headerlink" title="Two years from beginning a blog"></a><em><code>Two years from beginning a blog</code></em></h1><p>What a monumental, it has been 2 years ago when I posted the first article on this blog; <a href="https://baemincheon.github.io/2019/08/06/what-is-unreal-build-target/">The article about UnrealEngine build target.</a> I have usually written a post each month, mostly about UnrealEngine. The topic of post is chosen by my interest. For instance, things that I want to know, what I want to check, or just a record for memo.</p>
<p>An example fits in first rule is <a href="https://baemincheon.github.io/2021/08/06/how-unreal-macro-generated/">the post about UnrealEngine macro generation</a>. At that time, I was curious how UnrealEngine uses a macro for implementing its framework. Another one for second rule is <a href="https://baemincheon.github.io/2021/05/16/cpp-std-vector-growth/">the post about growth of <code>std::vector</code> in cpp</a>. At that time, I already knew there is difference between GCC and MSVC on growth size of <code>std::vector</code>. But, I had also wanted to check where the difference comes from. Last one for third rule is <a href="https://baemincheon.github.io/2021/09/10/perforce-server-setup-with-digital-ocean/">the post about how to setup Perforce server</a>. Starting a small game project, I had to setup Perforce server for my team. However, finding an easy and good manual for this was so hard that I decided to post the process of setup Perforce server. For myself and anyone.</p>
<p>Plus, almost every resource about UnrealEngine in Youtube or Google is targeting for the blueprint user, not the cpp user. So it was so hard to use a feature in cpp source code with the resources. Even they usually do not explain how the code works, just explain about how to use it. In this aspect, I am trying to explain the source code of engine for making it transparent. Furthermore, I am trying to put an example on every explanation. Because I have been tired of resources explained by only some words; Beginners cannot understand them, even follow the process without a precise description. Writing as simple as possible, demonstrating as many as possible, these policies would be maintained as long as possible.</p>
<p>I collect data via Google Analytics plugged in this blog. Top 10 pages most visited (until now) are below:</p>
<ol>
<li><code>/2020/02/09/unreal-widget-coordinate-system/</code></li>
<li><code>/2021/04/07/difference-between-build-cs-and-target-cs/</code></li>
<li><code>/2020/10/25/unreal-input-system-via-gamepad/</code></li>
<li><code>/2020/03/14/unreal-unique-pointer/</code></li>
<li><code>/2019/08/06/what-is-unreal-build-target/</code></li>
<li><code>/2019/08/11/custom-unreal-engine-build/</code></li>
<li><code>/2019/08/16/differences-of-unreal-build-targets/</code></li>
<li><code>/2020/01/28/unreal-blueprint-practical-use/</code></li>
<li><code>/2021/03/01/unreal-engine-natvis/</code></li>
<li><code>/2020/01/17/unreal-fname-anatomy/</code></li>
</ol>
<p>It seems that a post about widget, input, or build is more popular than others. For helping UnrealEngine newbies, I would better consider writing a post about those topics in next year. Looking back my experiences on studying UnrealEngine, I was also struggling for those topics.</p>
<h1 id="Career-with-UnrealEngine"><a href="#Career-with-UnrealEngine" class="headerlink" title="Career with UnrealEngine"></a><em><code>Career with UnrealEngine</code></em></h1><p>On working at PUBG Studio for 2 years, I have learned many things. (Even though some of them are not my part) Managing infra structure for large scale project, working remote in efficient way, developing and testing on console platforms, and so on. But most of all, various experiences of developing with UnrealEngine. Thanks to talented coworkers’ help, I could have done my tasks.</p>
<p>Reading and understanding the engine code is essential to development of industry level, but my skill was not sufficient to do that. So, in first year, I was busy to learn about topics mentioned in conversations. It was enough to take up my time. Repeated working at office and studying at home. After that, in second year, I became to understand most of what coworkers said. I started to read more engine code deeper and deeper. It is the time when I could say that “I know UnrealEngine…a bit ?”. Now, entering third year, I have plenty of skills enough to advice coworkers. Especially, many of coworkers ask me as I have experiences of console platforms. (But I still think I should learn more about console platforms)</p>
<p>I have done main tasks such as optimizing contents, fixing bugs and crashes, and making development environment better. Most of all, I want to say about only the first thing. Optimizing contents was the most challenging task. You may know the common sense in program optimization;</p>
<blockquote>
<p>When you increase a speed, an available memory would be decreased. On the other hand, when you increase an available memory, a speed would be decreased.</p>
</blockquote>
<p>Due to the structure of memory in computer, loading data from auxiliary storage is quite expensive operation. (In comparison to main storage) Anyone who wants the program to run faster would sacrifice the memory of program for loading data as much as possible. Particularly, among the programs, the size of data in game is bigger than others. That is why games try to load data before it is needed. Because any gamer does not want to see the freezed screen whenever picking up an item.</p>
<p>Right…in this condition, optimizing contents should not be easy one. What more worse is, new contents come in the game every update. In other words, an available memory could be decreased as the total size of data increased. So, it is hard to maintain a speed of program without sacrificing an available memory. Even more and more users are using the SSD thesedays, we have to support the old-gen consoles such as XboxOne and Playstation4, which are the devices uses HDD in default. </p>
<p>Additionally, loading data asynchronously is not always a best solution. Because, eventually it also consumes the resource of computer, and results a hitch or freeze. Yeap, so we struggled to manage an available memory of our game almost every update. Mainly, we have rarely chosen to skip some data loaded before entering ingame, instead we have chosen to optimize assets or codes to reduce its size so that the total size of data get reduced. Profiling our game and finding assets or codes taking up significant times, and analyzing what the assets or codes are wrong, and optimizing them…with magical spell. (I mean, the way how to optimize contents varies every time so it is like MAGIC, which is not easy to explain)</p>
<p>What I want to do in future would be developing games with newest features of UnrealEngine. But it would be hard without engine migration as we are using 4.16 version of UnrealEngine. Additionally, it is also hard to use the most fascinating features; Nanite and Lumen, as we are supporting old-gen consoles. Maybe I keep going my tasks as before, but at least, gonna to learn the newest features of UnrealEngine. Maybe, sometime I can use them. Or, I would post with contents of them. ;)</p>
<h1 id="Move-to-new-house"><a href="#Move-to-new-house" class="headerlink" title="Move to new house"></a><em><code>Move to new house</code></em></h1><p>In the middle of 2021, I had moved to new house as mentioned at <a href="https://baemincheon.github.io/2021/10/11/my-home-network-setup-experience-2021/">this post</a>. New house is bigger than old house, and I had to buy some furnitures. (Basic furnitures such as bed, purifier, and so on are provided in old house) Therefore, I had searched several items including closet, purifier, bed, desk, and so on. Especially, I had a difficulty for buying devices related to home network. Because I never had a need to buy these tools or devices. Even when I was in Army as Signal Corps, those things were supplies. (I did not choose what to buy)</p>
<p>Now I have a living room. Trying to put a sofa, table, or something fits in living room, I decided to buy UHD TV. No, not only UHD resolution…also 120Hz framerate should be great. That is a maximum range of next-gen console’s signal output. Yeap, I bought a next-gen console, too. Xbox Series X (XSX). Finally it looks like below:</p>
<img src="/2021/12/18/retrospection-2021/01.jpg" class="">

<p>The TV is the product of SAMSUNG, <a target="_blank" rel="noopener" href="https://www.samsung.com/in/tvs/qled-tv/qn90a-50-inch-neo-qled-4k-smart-tv-qa50qn90aaklxl/">50QN90A</a>. It supports resolution and framerate upto UHD&#x2F;120Hz, and has 50 inches display. I am satisfied with this product in overall aspects, what a nice TV. Only one thing disappointed is, the OS of TV is TIZEN, which is SAMSUNG’s proprietary OS. This OS does not have plenty of applications yet. For example, if you want to watch Twitch ? There is no twitch application in TIZEN, so you have to watch Twitch via web browser. Very inconvenient. Or you should check <a target="_blank" rel="noopener" href="https://github.com/fgl27/smarttv-twitch#installation-guide-tizen-studio-tested-on-linux-ubuntu-16-and-up-and-windows-10-64-bits">this</a>.</p>
<p>After living at new house for about 6 months, I think it was a good choice. More space gets me more comfortable, and makes it possible to stay home more than before. Still we are living with the various, so I wanted to stay home without some reason. Besides, I am also working from home, so more space is suitable for me. :)</p>
<h1 id="Thought-about-next-gen-console"><a href="#Thought-about-next-gen-console" class="headerlink" title="Thought about next-gen console"></a><em><code>Thought about next-gen console</code></em></h1><p>I cannot help saying this, I bought the next-gen console to play Battlefield 2042. Yeap…sadly, the game has totally been ruined. Huh…I might write some post for that sometime. As a fan of Battlefield series, it is so sad that people compare Cyberpunk 2077 and Battlefield 2042. Even worse, it is not easy to find any point that Battlefield 2077 is better than Cyberpunk 2077. Crap. Anyway, that is why I decided to buy a next-gen console.</p>
<p>Though a start of experience was not good, the console itself was amazing. Recently, UnrealEngine has released <a target="_blank" rel="noopener" href="https://www.unrealengine.com/en-US/wakeup?sessionInvalidated=true">The Matrix Awakens: An Unreal Engine 5 Experience</a>, which is kind of tech demo that shows what UnrealEngine 5 can do. The game runs at UHD&#x2F;30Hz with DynamicResolution on XSX, but it looks like REAL footage. At least, it seems this tech would become popular on movie industry. Already many of short films, part of films, or commercials use UnrealEngine, but currently they are using UnrealEngine for capturing a video. In other words, they are not realtime rendering. In the view, the tech demo was so impressed. “Wow, is it possible in realtime rendering ?”</p>
<p>Absolutely, this is not possible only with improvement of processor performance. In comparison of playing video, playing game needs more various resources not only processor resource. Playing video only needs loading next frame and next frame…until the video ends. (Displaying is none of business here) But, playing game needs loading assets should be displayed, executing codes may update the world or actors, integrating everything into a projection…in SINGLE ONE frametime.</p>
<p>CPU takes charge of executing codes, and GPU takes charge of integrating into a projection. Then, who takes charge of loading assets ? In general, CPU and memory works for it. CPU tries to read data from memory and blocks itself until the read done, but it takes some time if memory bandwidth is low. Low bandwidth means that you are try to load data from auxiliary storage, and it must not be always faster than loading data from main storage (ex: RAM). Even the problem gets worse when the size of data bigger and bigger. Thus, people have tried several techniques; A compression skill is sometimes applied to minimize the size of data. Just loading a compressed data and decompress it into the original data. Of course, this skill needs an extra resource from CPU, which could trigger a hitch while playing a game. Next, a <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/EditorScripting/Asset/DuplicateAsset/">asset duplication</a> skill is common one in games supporting for device using HDD. The skill is for reducing the seek time of HDD, because the seek time of HDD is too slow to load data in realtime. This skill also has a drawback that the size of game package gonna be VERY large. Horrible.</p>
<p>Thankfully, both Microsoft and Sony seem to have recognized these kind of issues. Specially, Microsoft. They made an exclusive processor for decompressing data to minimize any side effect of data compression skill. Like Sony did, Microsoft customized their NVMe SSD. Furthermore, Microsoft gave game developers more flexibity atm manpulating storage by providing DirectStorage API. Finally, Sampler Feedback Streaming (SFS) could be built on these basement skills. SFS will optimize game’s memory usage and file I&#x2F;O operations. Then, Microsoft names all the skills as an architecture <a target="_blank" rel="noopener" href="https://news.xbox.com/en-us/2020/07/14/a-closer-look-at-xbox-velocity-architecture/">Xbox Velocity Architecture</a>. Previously, I did not believe their words because it looks like hype. But I do know that is an amazing advance in game development. Turning back to UnrealEngine, EpicGames did great job so far with the new features.</p>
<h1 id="Plans-on-next-year"><a href="#Plans-on-next-year" class="headerlink" title="Plans on next year"></a><em><code>Plans on next year</code></em></h1><p>Except for writing a blog post each month, I have considered some plans to do.</p>
<blockquote>
<p>Plan #1. Making a game.</p>
</blockquote>
<p>Recently, I started to develop a game. About 3 months ago, my ex-coworker had suggested an Action RPG game project, and I accepted that. I do not know when the game is released, but some milestones should be completed in next year. In 2022, there may be a playable build. Developing this game, I should develop many features or design critical systems. With these kind of experiences, I retrospect when I was a student. It is the same that struggling on every issue, but the result would be better than when I was a student.</p>
<blockquote>
<p>Plan #2. Starting to develop a game engine.</p>
</blockquote>
<p>Working as a game programmer for 2 years, I have thought that “How about making my own game engine ?”. It would be fun that developing my own game engine, proud if many games are made of it, satisfied that I could do this. This kind of thought would be similar many of programmers have a dream that making their own programming language, operating system, database system, or etc. The game engine I will develop would be lightweight, but Rust gonna be used. I want to use Rust as many as possible in developing it. Because managing the side effect of using CPP would not be easy in a small project.</p>
<blockquote>
<p>Plan #3. Publishing console application or game.</p>
</blockquote>
<p>Actually, I have already subscribed the Xbox developer plan. It was cheaper than I expected, $19 USD only one time. (Maybe I would work for Playstation sometime…but I want to focus on Xbox now) I want to utilize this Xbox developer license. How or what to make ? Let us think about. Case first, Playing games in Xbox, I will note them if I experience some inconveniences. It would be great project if there would be something to make users convenient. Second case, making a tech demo just like The Matrix Awakens would be fun. It could be a kind of inspiration to some developers. Well…I may not make any application or game if I am busy for other works. It is on the back burner. XD</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2021/12/18/retrospection-2021/" data-id="cmfidx74l0015csqm4nce5skf" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2021/12/18/retrospection-2021/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Retrospection/" rel="tag">Retrospection</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-conversion-from-bp-only-project-into-bp-cpp-project" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/" class="article-date">
  <time datetime="2021-11-22T14:18:38.000Z" itemprop="datePublished">2021-11-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/">Conversion from BP-only project into BP+CPP project</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>Environment</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>UnrealEngine</td>
<td><code>branch: 5.0</code></td>
</tr>
<tr>
<td>Visual Studio 2022</td>
<td><code>version: 17.0.1</code></td>
</tr>
<tr>
<td>Windows 11 Pro</td>
<td><code>build: 22000.318</code></td>
</tr>
</tbody></table>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a><em><code>Overview</code></em></h1><img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/01.png" class="">

<p>UnrealEngine provides you two options to build your project and you can choose one of them. The options are <code>BLUEPRINT</code> and <code>C++</code> as you can see at the screenshot above. Selecting left one means that, “I gonna develop my project using only blueprint”. Otherwise, selecting right one means, “I want to use both blueprint and cpp on my project”.</p>
<p>By the way, what is different between them ? How can we convert BP only project into BP+CPP project ? Let us go over.</p>
<h1 id="Comparison"><a href="#Comparison" class="headerlink" title="Comparison"></a><em><code>Comparison</code></em></h1><img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/02.png" class="">

<p>After creation, you can see the directory if selected the BP-Only. In this project <code>BPOnly</code>, you only can execute UnrealEngine editor and write blueprints. Even if you make source code files and place them into appropriate position, your project does not compile the source code. Let us find out “why not working” by the difference between BP only project and BP+CPP project.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/03.png" class="">

<p>After creation with <code>C++</code> selection. The <code>BPCPP</code> project supports both blueprint and cpp like its name. You can see the difference on number of files, <code>BPOnly</code> is 6 while <code>BPCPP</code> is 10. Files that exist only in <code>BPCPP</code> are here.</p>
<table>
<thead>
<tr>
<th>Name of file&#x2F;folder</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>.vs</code></td>
<td>Containing VisualStudio related files. Mostly, cached data for optimization.</td>
</tr>
<tr>
<td><code>Binaries</code></td>
<td>Containing output files of this project. Currently, this project’s UnrealEditor library exists.</td>
</tr>
<tr>
<td><code>Source</code></td>
<td>Containing some simple source code files. Plus, BuildRule and TargetRule exist in this folder.</td>
</tr>
<tr>
<td><code>&lt;ProjectName&gt;.sln</code></td>
<td>Just like uproject file, it defines required version of VisualStudio, dependency of the project, and so on.</td>
</tr>
</tbody></table>
<p>The only <code>Source</code> folder is not generated one. The <code>Binaries</code> folder is generated when you build the project with a certain target such as <code>WindowsClient</code>, <code>WindowsServer</code>, and <code>Editor</code>. The files related to VisualStudio are generated when you attempt to make project files. Also, UnrealEngine refers the <code>Source</code> folder while generating project files.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/04.png" class="">

<p>So, is that all ? No, actually there is one more thing different. Check the uproject file and you can find some difference. The contents of uproject file looks like similar, but <code>BPCPP</code>‘s one has a <code>Modules</code> property. The name of module is the same with project name, <code>BPCPP</code>.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/05.png" class="">

<p>In summary, there are some differences between BP only project and BP+CPP project. (Except for generated files)</p>
<ul>
<li>Existence of <code>Source</code> folder</li>
<li>Property <code>Modules</code> in uproject file</li>
</ul>
<p>Where these differences come from ?</p>
<h1 id="Template"><a href="#Template" class="headerlink" title="Template"></a><em><code>Template</code></em></h1><p>We have learned about templates used in UnrealEngine at <a href="https://baemincheon.github.io/2021/04/07/difference-between-build-cs-and-target-cs/">the post</a>. What found was that making new project from a template is equal to copying the template project and replacing placeholders. Right, then it would be similar to that. Find the template project for BP only project and BP+CPP project.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">TMap&lt;FName, TArray&lt;TSharedPtr&lt;FTemplateItem&gt;&gt; &gt; SProjectDialog::<span class="built_in">FindTemplateProjects</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Clear the list out first - or we could end up with duplicates</span></span><br><span class="line">    TMap&lt;FName, TArray&lt;TSharedPtr&lt;FTemplateItem&gt;&gt;&gt; Templates;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Now discover and all data driven templates</span></span><br><span class="line">    TArray&lt;FString&gt; TemplateRootFolders;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @todo rocket make template folder locations extensible.</span></span><br><span class="line">    TemplateRootFolders.<span class="built_in">Add</span>(FPaths::<span class="built_in">RootDir</span>() + <span class="built_in">TEXT</span>(<span class="string">&quot;Templates&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add the Enterprise templates</span></span><br><span class="line">    TemplateRootFolders.<span class="built_in">Add</span>(FPaths::<span class="built_in">EnterpriseDir</span>() + <span class="built_in">TEXT</span>(<span class="string">&quot;Templates&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Allow plugins to define templates</span></span><br><span class="line">    TArray&lt;TSharedRef&lt;IPlugin&gt;&gt; Plugins = IPluginManager::<span class="built_in">Get</span>().<span class="built_in">GetEnabledPlugins</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> TSharedRef&lt;IPlugin&gt;&amp; Plugin : Plugins)</span><br><span class="line">    &#123;</span><br><span class="line">        FString PluginDirectory = Plugin-&gt;<span class="built_in">GetBaseDir</span>();</span><br><span class="line">        <span class="keyword">if</span> (!PluginDirectory.<span class="built_in">IsEmpty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">const</span> FString PluginTemplatesDirectory = FPaths::<span class="built_in">Combine</span>(*PluginDirectory, <span class="built_in">TEXT</span>(<span class="string">&quot;Templates&quot;</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (IFileManager::<span class="built_in">Get</span>().<span class="built_in">DirectoryExists</span>(*PluginTemplatesDirectory))</span><br><span class="line">            &#123;</span><br><span class="line">                TemplateRootFolders.<span class="built_in">Add</span>(PluginTemplatesDirectory);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>As you see, UnrealEngine finds template files from the path; <code>Root/Templates/</code>.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/06.png" class="">

<p>There are many folders for each template, and now we found. The <code>TP_Blank</code> and <code>TP_BlankBP</code>. The templates contain a uproject file, which is used for making new uproject file while creating new project using template.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/07.png" class="">

<p>The <code>BPOnly.uproject</code> was created based on <code>TP_BlankBP.uproject</code>. You can check that at the <code>FProjectDescriptor::Write()</code> function.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/09.png" class="">
</br>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/10.png" class="">
</br>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FModuleDescriptor::WriteArray</span><span class="params">(TJsonWriter&lt;&gt;&amp; Writer, <span class="type">const</span> TCHAR* ArrayName, <span class="type">const</span> TArray&lt;FModuleDescriptor&gt;&amp; Modules)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Modules.<span class="built_in">Num</span>() &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Writer.<span class="built_in">WriteArrayStart</span>(ArrayName);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">const</span> FModuleDescriptor&amp; Module : Modules)</span><br><span class="line">        &#123;</span><br><span class="line">            Module.<span class="built_in">Write</span>(Writer);</span><br><span class="line">        &#125;</span><br><span class="line">        Writer.<span class="built_in">WriteArrayEnd</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Why the <code>Modules</code> property not copied ? Look at the <code>FModuleDescriptor::WriteArray()</code>. UnrealEngine does not write that property when it is empty.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">GameProjectUtils::SetEngineAssociationForForeignProject</span><span class="params">(<span class="type">const</span> FString&amp; ProjectFileName, FText&amp; OutFailReason)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">FUProjectDictionary</span>(FPaths::<span class="built_in">RootDir</span>()).<span class="built_in">IsForeignProject</span>(ProjectFileName))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!FDesktopPlatformModule::<span class="built_in">Get</span>()-&gt;<span class="built_in">SetEngineIdentifierForProject</span>(ProjectFileName, FDesktopPlatformModule::<span class="built_in">Get</span>()-&gt;<span class="built_in">GetCurrentEngineIdentifier</span>()))</span><br><span class="line">        &#123;</span><br><span class="line">            OutFailReason = <span class="built_in">LOCTEXT</span>(<span class="string">&quot;FailedToSetEngineIdentifier&quot;</span>, <span class="string">&quot;Couldn&#x27;t set engine identifier for project&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</br>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/11.png" class="">

<p>Why the <code>EngineAssociation</code> property not filled ? That property is filled later at the <code>FDesktopPlatformBase::SetEngineIdentifierForProject()</code> function.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/08.png" class="">

<p>Of course, the <code>BPCPP.uproject</code> was created based on <code>TP_Blank.uproject</code>. In this case, whole contents of file copied. And, the <code>EngineAssociation</code> would be overwritten.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Retarget any files that were chosen to have parts of their names replaced here</span></span><br><span class="line">FString DestBaseFilename = FPaths::<span class="built_in">GetBaseFilename</span>(SrcFileSubpath);</span><br><span class="line"><span class="type">const</span> FString FileExtension = FPaths::<span class="built_in">GetExtension</span>(SrcFileSubpath);</span><br><span class="line"><span class="keyword">for</span> ( <span class="type">const</span> FTemplateReplacement&amp; Replacement : TemplateDefs-&gt;FilenameReplacements )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ( Replacement.Extensions.<span class="built_in">Contains</span>( FileExtension ) )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// This file matched a filename replacement extension, apply it now</span></span><br><span class="line">        FString LastDestBaseFilename = DestBaseFilename;</span><br><span class="line">        DestBaseFilename = DestBaseFilename.<span class="built_in">Replace</span>(*Replacement.From, *Replacement.To, Replacement.bCaseSensitive ? ESearchCase::CaseSensitive : ESearchCase::IgnoreCase);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (LastDestBaseFilename != DestBaseFilename)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">UE_LOG</span>(LogGameProjectGeneration, Verbose, <span class="built_in">TEXT</span>(<span class="string">&quot;&#x27;%s&#x27;: Renaming to &#x27;%s/%s&#x27; as it matched file rename (&#x27;%s&#x27;-&gt;&#x27;%s&#x27;)&quot;</span>), *SrcFilename, *DestFileSubpathWithoutFilename, *DestBaseFilename, *Replacement.From, *Replacement.To);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// Open all files with the specified extensions and replace text</span></span><br><span class="line"><span class="keyword">for</span> ( <span class="type">const</span> FString&amp; FileToFix : FilesThatNeedContentsReplaced )</span><br><span class="line">&#123;</span><br><span class="line">    InnerSlowTask.<span class="built_in">EnterProgressFrame</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> bSuccessfullyProcessed = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    FString FileContents;</span><br><span class="line">    <span class="keyword">if</span> ( FFileHelper::<span class="built_in">LoadFileToString</span>(FileContents, *FileToFix) )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> ( <span class="type">const</span> FTemplateReplacement&amp; Replacement : TemplateDefs-&gt;ReplacementsInFiles )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ( Replacement.Extensions.<span class="built_in">Contains</span>( FPaths::<span class="built_in">GetExtension</span>(FileToFix) ) )</span><br><span class="line">            &#123;</span><br><span class="line">                FileContents = FileContents.<span class="built_in">Replace</span>(*Replacement.From, *Replacement.To, Replacement.bCaseSensitive ? ESearchCase::CaseSensitive : ESearchCase::IgnoreCase);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( FFileHelper::<span class="built_in">SaveStringToFile</span>(FileContents, *FileToFix) )</span><br><span class="line">        &#123;</span><br><span class="line">            bSuccessfullyProcessed = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( !bSuccessfullyProcessed )</span><br><span class="line">    &#123;</span><br><span class="line">        FFormatNamedArguments Args;</span><br><span class="line">        Args.<span class="built_in">Add</span>( <span class="built_in">TEXT</span>(<span class="string">&quot;FileToFix&quot;</span>), FText::<span class="built_in">FromString</span>( FileToFix ) );</span><br><span class="line">        OutFailReason = FText::<span class="built_in">Format</span>( <span class="built_in">LOCTEXT</span>(<span class="string">&quot;FailedToFixUpFile&quot;</span>, <span class="string">&quot;Failed to process file \&quot;&#123;FileToFix&#125;\&quot;.&quot;</span>), Args );</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">TOptional</span>&lt;FGuid&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The name of folders and content of files are replaced by the codes above. In this post, from <code>TP_Blank</code> into <code>BPCPP</code>. (Or, from <code>TP_BlankBP</code> into <code>BPOnly</code>)</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/12.png" class="">

<h1 id="Module"><a href="#Module" class="headerlink" title="Module"></a><em><code>Module</code></em></h1><p>We have confirmed that the difference between <code>BPOnly</code> and <code>BPCPP</code> is about a module system, which are <code>Modules</code> property in uproject and <code>Source</code> folder containing code files. Thus, it would be possible converting blueprint only project into blueprint with cpp project by making some changes. In other words, we should make a new module.</p>
<p>Though <a target="_blank" rel="noopener" href="https://unrealcommunity.wiki/creating-cpp-module-oshdsg2t">a good wiki page for this</a> exists, I will show you an example based on <code>TP_BlankBP</code> template.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/02.png" class="">

<p>#1. Prepare a project created with <code>TP_BlankBP</code>. In this post, I use the <code>BPOnly</code> project.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/13.png" class="">

<p>#2. Make a folder <code>Source</code> at project directory, and make a folder <code>&lt;ModuleName&gt;</code> in the <code>Source</code> directory.</p>
<p>Name the module as you want, but it is recommended to set by project name. (Because this module is the first module of project) Just to show that any name is okay, I set the module name as <code>Robb</code>, which is different with project name.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/14.png" class="">
</br>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/15.png" class="">

<p>#3. Copy some files from the template <code>TP_Blank</code>. Replace their names and contents.</p>
<p>I had copied all of files in <code>Source</code> folder of <code>TP_Blank</code> template. For using the template files in this project, I replaced filenames and contents. (In this case, I need to replace the text <code>TP_Blank</code> into <code>Robb</code>)</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/16.png" class="">

<p>#4. Generate VisualStudio project files and open VisualStudio project file.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/17.png" class="">
</br>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/18.png" class="">

<p>#5. Build the project and open UnrealEngine editor. Profit !</p>
<h1 id="Wrap-Up"><a href="#Wrap-Up" class="headerlink" title="Wrap-Up"></a><em><code>Wrap-Up</code></em></h1><p>It is not common case that creating a project with blueprint only option, but we are able to convert blueprint only project into blueprint with cpp project. We have checked what happens while creating our project using template, what is different between <code>TP_Blank</code> and <code>TP_BlankBP</code>, and how to add cpp module at blueprint only project. As we seen earlier in this post, the conversion we did is the same work of what UnrealEngine does.</p>
<p>When we make an initial module, the name of module does not have to be the same with project name. But, it is recommended to set by project name with convention and several reasons. For example, I had made a module <code>Robb</code> at the project <code>BPOnly</code>. I tried to package the project and got the result like below. Some of files have the name as <code>Robb</code>, but others have the name as <code>BPOnly</code>. Kind of disharmony on naming could be problem when accessing files with name.</p>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/19.png" class="">
</br>
<img src="/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/20.png" class="">
      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/" data-id="cmfidx74h000lcsqm15h5deuu" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2021/11/22/conversion-from-bp-only-project-into-bp-cpp-project/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Blueprint/" rel="tag">Blueprint</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CPP/" rel="tag">CPP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-my-home-network-setup-experience-2021" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/11/my-home-network-setup-experience-2021/" class="article-date">
  <time datetime="2021-10-11T11:03:07.000Z" itemprop="datePublished">2021-10-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/10/11/my-home-network-setup-experience-2021/">My Home Network Setup Experience (2021)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Prologue"><a href="#Prologue" class="headerlink" title="Prologue"></a><em>Prologue</em></h1><p>About 4 months ago, I moved to new house, which is rented for 2 years. The building had been built in 2018, so I expected a quite simple and modern facilities including home networks infra. But, on the day moving to new house, a previous tenant said to me that “Only one LAN port works while others not”. At that time, I took this as a misunderstanding of the previous tenant. Because it is common that general people cannot handle or solve an network issue easily. Well…as you can see I write this post, he was right.</p>
<p>The previous tenant has mostly used the internet via wireless network, a.k.a. Wi-fi. It seemed that he does not know computer things. Even he connected to other rooms with exposed LAN cables. (I did not take the picture, but it was similar to a picture below.)</p>
<img src="/2021/10/11/my-home-network-setup-experience-2021/01.jpg" class="">

<h1 id="Floor-Plan"><a href="#Floor-Plan" class="headerlink" title="Floor Plan"></a><em>Floor Plan</em></h1><img src="/2021/10/11/my-home-network-setup-experience-2021/02.png" class="">

<p>I made a floor plan for new house. The green markers mean LAN ports. The LAN port with blue check mark was the only one working properly. Other LAN ports were not. The orange marker means a terminal box. When I first opened the terminal box, it looked like a picture below.</p>
<img src="/2021/10/11/my-home-network-setup-experience-2021/03.png" class="">

<p>Very weird. The red cable might be the inbound. But other cables are connected in disorder. In this situation, I cannot guess which cable is destinated to certain LAN port. So I followed steps below for examination.</p>
<ul>
<li>​Check whether the red cable is inbound. The result was yes.</li>
<li>Connect a inbound cable to each cable. Check where each cable is connected to.</li>
<li>Repeat the second step until all of unknown ports found.</li>
</ul>
<p>After some moments, I could organize a mapping for LAN ports. Let us see the picture below.</p>
<img src="/2021/10/11/my-home-network-setup-experience-2021/04.png" class="">

<h1 id="My-Goal"><a href="#My-Goal" class="headerlink" title="My Goal"></a><em>My Goal</em></h1><p>Now, preparation done. It was time to do my plan. My plan was…</p>
<ul>
<li>Reuse my gears as possible. At that time, I had a wireless router and some switch hubs.</li>
<li>Enable 2 ports. The port #3 and port #4.</li>
<li>Activate wireless network at appropriate position.</li>
</ul>
<p>For this purpose, I planned to put a switch hub into the terminal box. Then, the wireless router should be near port #3. Because the Wi-fi signal would get weak when the router is in terminal box. However, on trying this plan, I found a very critical problem.</p>
<h1 id="First-Try"><a href="#First-Try" class="headerlink" title="First Try"></a><em>First Try</em></h1><p>There is no power socket in the terminal box. In other words, there is no way to place a switch hub in the terminal box. In general, switch hub consumes power even it is small amount. What a panic !</p>
<p>I searched for bypassing the issue. Fortunately, there is one way fits in my case. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Power_over_Ethernet">The PoE, Power over Ethernet</a>. The PoE is usually used at certain devices such as CCTV, Network Router, and VoIP Phone. These devices can be installed restricted environments.</p>
<ul>
<li>There may be no power socket or power source due to small space.</li>
<li>There may be only LAN cable due to intra structure.</li>
</ul>
<p>Yes. That is a perfect feature for this situation.</p>
<ul>
<li>I could use only LAN cables in the terminal box.</li>
<li>I did not want to lay the power socket as the house is rented.</li>
</ul>
<p>So, I chose to find injector and splitter. They are needed to implement PoE infra. The injector injects signal and power into LAN cable. The splitter splits it into signal and power at destination. Therefore, the floor plan can be redrawn as below.</p>
<img src="/2021/10/11/my-home-network-setup-experience-2021/05.png" class="">

<p>Though it looks like some mess, anyway it worked. First, injector provides power to splitter via Ethernet. Therefore, splitter can supply power to switch hub. Second, inbound signal gets distributed by switch hub in terminal box. Finally, home network is constructed by the router on port #3.</p>
<ul>
<li>I reused my gears. The wireless router and switch hubs.</li>
<li>Now I can access internet via port #3 and port #4.</li>
<li>I activated wireless network at the middle of house, living room.</li>
</ul>
<p>Great. I was satisfied with the result…for a while.</p>
<h1 id="Second-Try"><a href="#Second-Try" class="headerlink" title="Second Try"></a><em>Second Try</em></h1><p>It was totally fine that connecting multiple devices with the router. Of course, because the router is extremely close. But, the problem happened when I had added several devices on port #4 side. When using one device on port #4, the device could recognize the network well. In contrast, when using two devices on port #4, one of them could not recognize the network. It can be drawn as below.</p>
<img src="/2021/10/11/my-home-network-setup-experience-2021/06.png" class="">

<p>By the way, the devices were too far from the router. There were two switch hub between the router and devices, and it could prone some network conflicts. I had decided to change my home network configuration, with keeping my goals mentioned before.</p>
<img src="/2021/10/11/my-home-network-setup-experience-2021/07.png" class="">

<p>A solution for this problems is simple. Placing a router in the terminal box. Then, my home network would be like picture above. But, one thing left behind, a wireless network. I cannot expect a wireless network functions well if the wireless router is in terminal box because the terminal box must be closed.</p>
<img src="/2021/10/11/my-home-network-setup-experience-2021/08.png" class="">

<p>So, I had to buy new router for putting it in the terminal box. Placing new router in the terminal box and leave old router in the same position would be okay. In this case, the old router must be used like switch hub, not a router. My home network looks like picture above. And I will be able to connect the devices on port #4.</p>
<h1 id="Third-Try"><a href="#Third-Try" class="headerlink" title="Third Try"></a><em>Third Try</em></h1><p>Hmm…everything works well. Nothing malfunctions. But Wi-fi SSID issue was annoying me. New router and old router had been activated on wireless network, and they got each one of SSID. Yeah, right. There are TWO SSID separately, even though in the same network. I wanted them to merge into one.</p>
<p>Searched again. Maybe the <a target="_blank" rel="noopener" href="https://www.wi-fi.org/knowledge-center/faq/what-is-wi-fi-easymesh">EasyMesh</a> a solution for me. The EasyMesh is one of Wi-fi technology that enables to merge multiple access points. Even EasyMesh does not care about type of frequency of access point. In other words, all of access points with 2.4GHz or 5.0GHz frequency will be merged into single access point. That was what I looked for !</p>
<img src="/2021/10/11/my-home-network-setup-experience-2021/09.png" class="">

<p>My routers were made by <a target="_blank" rel="noopener" href="https://www.wi-fi.org/about/member-companies/efm-networks">EFM networks</a>, the company famous of ipTIME trademark. EFM networks provides an utility program controls EasyMesh configuration like picture above. (Almost every company seems that develops and implements the EasyMesh specification, so find out other companies too.)</p>
<p>Setting up EasyMesh was completely easy. The structure of my home network was fit for the conditions. Now I can access Wi-fi via only single SSID. Furthermore, Wi-fi range is larger than before by merging two SSID. What a convenient :)</p>
<h1 id="Epilogue"><a href="#Epilogue" class="headerlink" title="Epilogue"></a><em>Epilogue</em></h1><p>With the series of effort, I could setup my home network completely without great expense. It was lucky that there was no need to call workers. Maybe I would tell a next tenant of these story and give advice. I do not want anyone to suffer from the problems. ;)</p>
<p>Oh, I almost forgot. You should check the router before buying it if you want to setup EasyMesh. EasyMesh requires two types of router; MeshController and MeshAgent. Check the item you gonna buy whether it is kind of MeshController or MeshAgent.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2021/10/11/my-home-network-setup-experience-2021/" data-id="cmfidx74j000wcsqmb97h45sc" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2021/10/11/my-home-network-setup-experience-2021/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Iptime/" rel="tag">Iptime</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Network/" rel="tag">Network</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-perforce-server-setup-with-digital-ocean" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/10/perforce-server-setup-with-digital-ocean/" class="article-date">
  <time datetime="2021-09-10T14:50:39.000Z" itemprop="datePublished">2021-09-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/09/10/perforce-server-setup-with-digital-ocean/">How to setup Perforce server with Ubuntu</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>Environment</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Helix Core (P4D)</td>
<td><code>version: P4D/LINUX26X86_64/2021.1/2156517</code></td>
</tr>
<tr>
<td>Ubuntu</td>
<td><code>version: 20.04 LTS</code></td>
</tr>
<tr>
<td>Helix Visual Client (P4V)</td>
<td><code>version: P4V/NTX64/2021.3/2170446</code></td>
</tr>
<tr>
<td>Windows 10</td>
<td><code>build: 19043.1165</code></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>References</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Helix Core Server Administrator Guide</td>
<td><a target="_blank" rel="noopener" href="https://www.perforce.com/manuals/p4sag/Content/P4SAG/chapter.install.html">https://www.perforce.com/manuals/p4sag/Content/P4SAG/chapter.install.html</a></td>
</tr>
<tr>
<td>.p4ignore for UnrealEngine</td>
<td><a target="_blank" rel="noopener" href="https://github.com/mattmarcin/ue4-perforce/blob/master/.p4ignore">https://github.com/mattmarcin/ue4-perforce/blob/master/.p4ignore</a></td>
</tr>
<tr>
<td>P4 Typemap for UnrealEngine</td>
<td><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/4.27/en-US/ProductionPipelines/SourceControl/Perforce/">https://docs.unrealengine.com/4.27/en-US/ProductionPipelines/SourceControl/Perforce/</a></td>
</tr>
</tbody></table>
<h1 id="Prepare-Ubuntu-Instance"><a href="#Prepare-Ubuntu-Instance" class="headerlink" title="Prepare Ubuntu Instance"></a><em>Prepare Ubuntu Instance</em></h1><p>As the Perforce is a kind of CVCS*, it is recommended to use a dedicated server. The dedicated server should run all day and night, and should have a fixed IP address. Thus, you would better choose a cloud server if not have a machine for the purposes. In this post, I chose <a target="_blank" rel="noopener" href="https://www.digitalocean.com/">DigitalOcean</a> for a cloud server provider. The DigitalOcean provides instances with cheaper cost than others such as AWS. You know, you may not need a high quality instance for your small size project.<br>※ CVCS : Centralized Version Control System. Find more information at <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Distributed_version_control#Distributed_vs._centralized">here</a>.</p>
<p>Sign-up and Sign-in the DigitalOcean. Click the button <code>Create</code> and choose <code>Droplets</code>.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/01.png" class="">
<p>At the page <code>Create Droplets</code>, you would be asked to choose options for a instance. In this post, we gonna choose options like below:</p>
<ul>
<li><code>Choose an image</code><ul>
<li>Ubuntu 20.04 (LTS) x64</li>
</ul>
</li>
<li><code>Choose a plan</code><ul>
<li>SHARED CPU<ul>
<li>Basic</li>
</ul>
</li>
<li>CPU options<ul>
<li>Regular Intel with SSD</li>
<li>$5&#x2F;month (&#x3D; $0.007&#x2F;hour)<ul>
<li>1 core CPU, 1 GB RAM, 25 GB SSD, 1000 GB transfer</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><code>Add block storage</code><ul>
<li>$5&#x2F;month (&#x3D; $0.007&#x2F;hour)<ul>
<li>50 GB SSD</li>
</ul>
</li>
</ul>
</li>
<li><code>Choose a datacenter region</code><ul>
<li>(Select a datacenter that is closest to your location)</li>
<li>(In my case, it is Singapore)</li>
</ul>
</li>
<li><code>Select additional options</code><ul>
<li>Monitoring</li>
</ul>
</li>
<li><code>Authentication</code><ul>
<li>Password<ul>
<li>(Choose a password for entering the instance)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Any options I did not mention are left as default selection. Let us create our Droplet by clicking the button <code>Create Droplet</code>.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/02.png" class="">
<p>Now you can see the new Droplet. Connect the instance via SSH. You can do it with Powershell or WSL in Windows 10. The <code>X.X.X.X</code> must be replaced with the IP address of instance.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; ssh root@X.X.X.X</span><br></pre></td></tr></table></figure>
<p>But, when you attempt to connect the instance via SSH, you are asked to enter a password.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@X.X.X.X&#x27;s password:</span><br></pre></td></tr></table></figure>
<p>Enter the password that you typed at the <code>Authentication</code> text block. If the right password entered, you can see the logs like below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-73-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Sat Sep 11 16:12:19 UTC 2021</span><br><span class="line"></span><br><span class="line">  System load:  0.0               Users logged in:       0</span><br><span class="line">  Usage of /:   9.3% of 24.06GB   IPv4 address for eth0: X.X.X.X</span><br><span class="line">  Memory usage: 24%               IPv4 address for eth0: X.X.X.X</span><br><span class="line">  Swap usage:   0%                IPv4 address for eth1: X.X.X.X</span><br><span class="line">  Processes:    113</span><br><span class="line"></span><br><span class="line">66 updates can be applied immediately.</span><br><span class="line">1 of these updates is a standard security update.</span><br><span class="line">To see these additional updates run: apt list --upgradable</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*** System restart required ***</span><br><span class="line">Last login: Sat Sep 11 11:35:09 2021 from X.X.X.X</span><br><span class="line">root@ubuntu-test:~#</span><br></pre></td></tr></table></figure>
<p>At the your instance page, you can check the volume setting. Click the <code>Config Instructions</code>.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/03.png" class="">
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/04.png" class="">
<p>If you selected the option <code>Automatically Format &amp; Mount</code> at the section <code>Add block storage</code>, the volume is already attached even you did nothing. In other words, the process <code>Mount the volume</code> is already done. Let us check whether the volume is well mounted. The <code>volume_X</code> must be replaced with yours.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; cd /mnt/volume_X</span><br><span class="line">&gt; ls</span><br><span class="line">lost+found</span><br></pre></td></tr></table></figure>

<p>You successfully setup an Ubuntu instance. Good to go !</p>
<h1 id="Install-amp-Setup-P4D"><a href="#Install-amp-Setup-P4D" class="headerlink" title="Install &amp; Setup P4D"></a><em>Install &amp; Setup P4D</em></h1><p>We need to setup public key for accessing Perforce packages. For this, you need to download the public key at <a target="_blank" rel="noopener" href="https://package.perforce.com/perforce.pubkey">https://package.perforce.com/perforce.pubkey</a>. The download can be done by command below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl https://package.perforce.com/perforce.pubkey &gt; perforce.pubkey</span><br></pre></td></tr></table></figure>
<p>This command let you save the public key as a file, whose name is <code>perforce.pubkey</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl https://package.perforce.com/perforce.pubkey &gt; perforce.pubkey</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100  1707  100  1707    0     0   2024      0 --:--:-- --:--:-- --:--:--  2022</span><br><span class="line">&gt; ls</span><br><span class="line">perforce.pubkey  snap</span><br></pre></td></tr></table></figure>
<p>You can check the contents of file with <code>cat</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&gt; cat perforce.pubkey</span><br><span class="line">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><br><span class="line">Version: GnuPG v2.0.14 (GNU/Linux)</span><br><span class="line"></span><br><span class="line">mQINBFIOq14BEADUC4gm+gjS/E/y2xXouALvMuK2xO/8nbcXJCUAD6Bi1xxmyDaR</span><br><span class="line">LXHDJ5lIzZV8/Jctck2bBIWE1WE8Qfpfz/eAU5lJoQTovt0OkOnyyAyFBSk9yXtN</span><br><span class="line">fscQGdTXkl9LVVfsaTHVT3WGZF+iMCIZOVjYGjqRh3ozZp3LWOQl3cwgOZKQCi9Q</span><br><span class="line">y/YRn6XZIOiQQEfvLzrBL1oyD1BoOq8Y2CrwTfhyz93qIRu089mAr7lo2e6UM/KV</span><br><span class="line">JRjk6rPFcKIE0aOP2UwgY/6LMeK65MAKib76EFbygXBprz9K5zwq70A7MGSPjRPw</span><br><span class="line">A7kdzw53flZyNscI2c093jW/PkeDw4++01QFky/FFqJncjIHoOid42NvQXD/+E5e</span><br><span class="line">JKhqYReS2eHpv5qgsSc2Febd5Ccd0B4+2ryY3MBXqaj759NH6uWAowHjAv90y4Cb</span><br><span class="line">c2FugNBAJ6XQBQaXcWsfPnWpBFYL36LxBCcu+ddiycTWS9SWFT3h0FIgTbTQNNQr</span><br><span class="line">Fgjg5vYAw+TWU8wf1I3sak+wbU25h7ErKN1oSJ/EbPwUFOc6zjaDUlnIgmCnQgEj</span><br><span class="line">NdrlWGGfgCfYTHZTnGW6fGlpByDnYO0wn/okPJxRStnkbqb8QGKRa1uTObSM0/4J</span><br><span class="line">aqsaReo2E45x2TAIY6rNuiLet/r1hZzpLs3dffvoddscb/LshW1eiNU36QARAQAB</span><br><span class="line">tERQZXJmb3JjZSBTb2Z0d2FyZSAoUGFja2FnZSBTaWduaW5nKSA8c3VwcG9ydCtw</span><br><span class="line">YWNrYWdpbmdAcGVyZm9yY2UuY29tPokCPgQTAQIAKAUCUg6rXgIbAwUJEswDAAYL</span><br><span class="line">CQgHAwIGFQgCCQoLBBYCAwECHgECF4AACgkQcSPLdg/xiGlcKxAAvkzIPVzhc2am</span><br><span class="line">GaAAUse4mQ6InNqCLiGEbNxPWnd13myGesbESfyBxex5Gb2t47gVllA7P9hOcvsv</span><br><span class="line">J6g56WPD1yb+5Wrdchdn6SkSEfg1MOAMTskFPPJJ/3ZgfHKn/kv3tOJPcQsidRFl</span><br><span class="line">uqNMHSroHpOExYaTgB7IhYBjnYHLwUgH1ikCFgkRzdaDW4Qfx6IRB1vpSjzxCjzP</span><br><span class="line">Cc78cf4VDmBdSfwsO6/ON19ZcxtLjHvQK5sz91qsEJdJZjyq6YCHYfP+Zx8/M55S</span><br><span class="line">ixZ6/QsLRAsUYGuBjuWMpMgXjB06TXVbSg97bZt2tHBMZJ2OEMgn09eysyS9uwlY</span><br><span class="line">HMtpu23jDTn6sKlRE6PYbZQirt2Ydq56wOQqJzrW1BbadX56DY8FLYBh8H9kcBaT</span><br><span class="line">MGT1fiLfaEn1C8dG3D9aHdaPXZu+zGcMrPY+GMcObAAk3ICRXR20NknSByOxNEyz</span><br><span class="line">nOqCsmr1nRdrpnf4+52G53xYKroWVRYeDdBukC8ik6weFjK4qy7C4ujOe1AmoBis</span><br><span class="line">g6+R0huka1TYr9r94um+idvHniLnaZvnxPKEUMLnGesx9LYio4slqQj+nN6fIelv</span><br><span class="line">onltXR49hpuAiOKtYUISmsk+rI+ep60DfDSQGbrV8HkW6KjuHjmE7EJKEEnIk5N/</span><br><span class="line">JJfimlBk+rNgbcz0fpT6IDdS6PEoGwk=</span><br><span class="line">=fj1X</span><br><span class="line">-----END PGP PUBLIC KEY BLOCK-----</span><br></pre></td></tr></table></figure>
<p>Let us register the public key.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; gpg --with-fingerprint perforce.pubkey</span><br><span class="line">gpg: directory &#x27;/root/.gnupg&#x27; created</span><br><span class="line">gpg: keybox &#x27;/root/.gnupg/pubring.kbx&#x27; created</span><br><span class="line">gpg: WARNING: no command supplied.  Trying to guess what you mean ...</span><br><span class="line">pub   rsa4096 2013-08-16 [SC] [expires: 2023-08-14]</span><br><span class="line">uid           Perforce Software (Package Signing) &lt;support+packaging@perforce.com&gt;</span><br></pre></td></tr></table></figure>
<p>Add the Perforce packaging key to your APT keyring.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; wget -qO - https://package.perforce.com/perforce.pubkey | sudo apt-key add -</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>
<p>Execute the command for adding Perforce to your APT configuration.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; sudo add-apt-repository &#x27;deb http://package.perforce.com/apt/ubuntu focal release&#x27;</span><br><span class="line">Hit:1 https://repos.insights.digitalocean.com/apt/do-agent main InRelease</span><br><span class="line">Hit:2 https://repos-droplet.digitalocean.com/apt/droplet-agent main InRelease</span><br><span class="line">Get:3 http://mirrors.digitalocean.com/ubuntu focal InRelease [265 kB]</span><br><span class="line">Hit:4 http://mirrors.digitalocean.com/ubuntu focal-updates InRelease</span><br><span class="line">Hit:5 http://mirrors.digitalocean.com/ubuntu focal-backports InRelease</span><br><span class="line">Get:6 http://package.perforce.com/apt/ubuntu focal InRelease [3650 B]</span><br><span class="line">Hit:7 http://security.ubuntu.com/ubuntu focal-security InRelease</span><br><span class="line">Get:8 http://package.perforce.com/apt/ubuntu focal/release amd64 Packages [8168 B]</span><br><span class="line">Fetched 277 kB in 1s (298 kB/s)</span><br><span class="line">Reading package lists... Done</span><br></pre></td></tr></table></figure>
<p>Run update.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; apt-get update</span><br><span class="line">Hit:1 https://repos.insights.digitalocean.com/apt/do-agent main InRelease</span><br><span class="line">Get:2 http://mirrors.digitalocean.com/ubuntu focal InRelease [265 kB]</span><br><span class="line">Hit:3 https://repos-droplet.digitalocean.com/apt/droplet-agent main InRelease</span><br><span class="line">Hit:4 http://mirrors.digitalocean.com/ubuntu focal-updates InRelease</span><br><span class="line">Hit:5 http://mirrors.digitalocean.com/ubuntu focal-backports InRelease</span><br><span class="line">Hit:6 http://package.perforce.com/apt/ubuntu focal InRelease</span><br><span class="line">Hit:7 http://security.ubuntu.com/ubuntu focal-security InRelease</span><br><span class="line">Fetched 265 kB in 1s (321 kB/s)</span><br><span class="line">Reading package lists... Done</span><br></pre></td></tr></table></figure>
<p>Install the package.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; sudo apt-get install helix-p4d</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree</span><br><span class="line">Reading state information... Done</span><br><span class="line">...</span><br><span class="line">Started 0 services.</span><br><span class="line">No services configured.</span><br><span class="line">Processing triggers for man-db (2.9.1-1) ...</span><br><span class="line">Processing triggers for systemd (245.4-4ubuntu3.6) ...</span><br></pre></td></tr></table></figure>
<p>Now you have one last step, launching the Perforce service ! Execute the batch file for it.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&gt; sudo /opt/perforce/sbin/configure-helix-p4d.sh</span><br><span class="line"></span><br><span class="line">Summary of arguments passed:</span><br><span class="line"></span><br><span class="line">Service-name        [(not specified)]</span><br><span class="line">P4PORT              [(not specified)]</span><br><span class="line">P4ROOT              [(not specified)]</span><br><span class="line">Super-user          [(not specified)]</span><br><span class="line">Super-user passwd   [(not specified)]</span><br><span class="line">Unicode mode        [(not specified)]</span><br><span class="line">Case-sensitive      [(not specified)]</span><br><span class="line"></span><br><span class="line">For a list of other options, type Ctrl-C to exit, and then run:</span><br><span class="line">$ sudo /opt/perforce/sbin/configure-helix-p4d.sh --help</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">You have entered interactive configuration for p4d. This script</span><br><span class="line">will ask a series of questions, and use your answers to configure p4d</span><br><span class="line">for first time use. Options passed in from the command line or</span><br><span class="line">automatically discovered in the environment are presented as defaults.</span><br><span class="line">You may press enter to accept them, or enter an alternative.</span><br><span class="line"></span><br><span class="line">Please provide the following details about your desired Perforce environment:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Perforce Service name [master]:</span><br></pre></td></tr></table></figure>
<p>You will be asked to enter some configurations such as name of service, directory, case sensitiviy, and so on. Setup them appropriately.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Perforce Service name [master]: Test</span><br><span class="line">Service Test not found. Creating...</span><br><span class="line">Perforce Server root (P4ROOT) [/opt/perforce/servers/Test]:</span><br></pre></td></tr></table></figure>
<p>You should select the proper directory. It would be better to select the attached volume if the size of your project would be more than 25GB.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Perforce Service name [master]: Test</span><br><span class="line">Service Test not found. Creating...</span><br><span class="line">Perforce Server root (P4ROOT) [/opt/perforce/servers/Test]:</span><br><span class="line">Create directory? (y/n) [y]: y</span><br><span class="line">Perforce Server unicode-mode (y/n) [n]: y</span><br><span class="line">Perforce Server case-sensitive (y/n) [y]:</span><br><span class="line">Perforce Server address (P4PORT) [ssl:1666]:</span><br><span class="line">Perforce super-user login [super]:</span><br><span class="line">Perforce super-user password:</span><br><span class="line">Re-enter password.</span><br><span class="line">Perforce super-user password:</span><br><span class="line"></span><br><span class="line">Configuring p4d service &#x27;Test&#x27; with the information you specified...</span><br><span class="line"></span><br><span class="line">Perforce db files in &#x27;/opt/perforce/servers/Test/root&#x27; will be created if missing...</span><br><span class="line">...</span><br><span class="line">::</span><br><span class="line">::  - For help with creating Perforce Helix user accounts, populating</span><br><span class="line">::    the depot with files, and making other customizations for your</span><br><span class="line">::    site, see the Helix Versioning Engine Administrator Guide:</span><br><span class="line">::</span><br><span class="line">::    https://www.perforce.com/perforce/doc.current/manuals/p4sag/index.html</span><br><span class="line">::</span><br><span class="line">::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span><br></pre></td></tr></table></figure>
<p>Now you can access the Perforce service via P4V at a client. Before that, take care of typemap. The typemap is an abbreviation of <code>Type Mapping</code>. You can define how Perforce handles certain type of files by it. If your project uses UnrealEngine, for the types related to UnrealEngine, Epic Games recommends to setup like below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">TypeMap:</span><br><span class="line">                binary+w //depot/....exe</span><br><span class="line">                binary+w //depot/....dll</span><br><span class="line">                binary+w //depot/....lib</span><br><span class="line">                binary+w //depot/....app</span><br><span class="line">                binary+w //depot/....dylib</span><br><span class="line">                binary+w //depot/....stub</span><br><span class="line">                binary+w //depot/....ipa</span><br><span class="line">                binary //depot/....bmp</span><br><span class="line">                text //depot/....ini</span><br><span class="line">                text //depot/....config</span><br><span class="line">                text //depot/....cpp</span><br><span class="line">                text //depot/....h</span><br><span class="line">                text //depot/....c</span><br><span class="line">                text //depot/....cs</span><br><span class="line">                text //depot/....m</span><br><span class="line">                text //depot/....mm</span><br><span class="line">                text //depot/....py</span><br><span class="line">                binary+l //depot/....uasset</span><br><span class="line">                binary+l //depot/....umap</span><br><span class="line">                binary+l //depot/....upk</span><br><span class="line">                binary+l //depot/....udk</span><br><span class="line">                binary+l //depot/....ubulk</span><br></pre></td></tr></table></figure>
<p>You can edit the typemap of instance by executing command <code>p4 typemap</code>. The command would open typemap file with vi editor.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/05.png" class="">
<p>Add the Epic Games’s mappings to your mapping file*. Now all preparation of server side completed.<br>※ FYI, the <code>//</code> string does not mean “It is a kind of comment.” in P4 typemap system. You should copy the all of text.</p>
<h1 id="Install-amp-Setup-P4V"><a href="#Install-amp-Setup-P4V" class="headerlink" title="Install &amp; Setup P4V"></a><em>Install &amp; Setup P4V</em></h1><p>Download the P4V installer at <a target="_blank" rel="noopener" href="https://www.perforce.com/downloads/helix-visual-client-p4v">https://www.perforce.com/downloads/helix-visual-client-p4v</a> and install with default options. When the installation compeleted, execute the P4V. You will see the display.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/06.png" class="">
<p>Enter <code>ssl:X.X.X.X:1666</code> at the section <code>Server</code>. The <code>X.X.X.X</code> must be replaced with the IP address of instance. Enter <code>super</code> at the section <code>User</code>. The user <code>super</code> is an administrator account we have set. Now click the button <code>OK</code>. Check <code>Trust this fingerprint</code> and click the button <code>Connect</code> if you encounter the dialog like below:</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/07.png" class="">
<p>Enter the password you set while launching the Perforce service at instance.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/08.png" class="">
<p>You can see the display when successfully entered.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/09.png" class="">
<p>The admin tool can be accessed at <code>Tools/Administration</code>.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/10.png" class="">
<p>In the tool, you can add or delete user directly.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/11.png" class="">
<p>Let us prepare some Depot and Stream. Click the <code>Depots</code>. Right-click any depot and select <code>New Depot...</code>.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/12.png" class="">
<p>Type the name of new Depot.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/13.png" class="">
<p>Select <code>stream</code> at the section <code>Deopt type</code> and click <code>OK</code>.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/14.png" class="">
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/15.png" class="">
<p>Close the admin tool and return to the P4V*. Now you can find the new Depot at Depot view.<br>※ Actually, the admin tool was the program P4Admin, which is different with P4V. Just, Perforce supports to launch the P4Admin from P4V.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/16.png" class="">
<p>Restart the P4V for applying changes from P4Admin. After restart, find the <code>File/New/Stream...</code> and click it.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/17.png" class="">
<p>Let us make a Stream, name of <code>mainline</code>. The Stream will be placed in the new Deopt. Click the button <code>OK</code>.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/18.png" class="">
<p>Click <code>New Workspace...</code> at workspace view.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/19.png" class="">
<p>Name the new workspace and click the button <code>Browse</code> in line of <code>Stream</code>. You can find the Stream <code>mainline</code> at the dialog. Select it.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/20.png" class="">
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/21.png" class="">
<p>Finally, we have prepared a workspace in totally empty new Perforce service ! But, you should config <code>p4ignore</code> before getting into the work. Open any terminal and execute the command below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; p4 set P4IGNORE=.p4ignore</span><br></pre></td></tr></table></figure>
<p>This command will let your Perforce refer the file whose name is <code>.p4ignore</code>. It is kind of configuration lets you can use Perforce like git, which provides <code>.gitignore</code>. To apply this changes, restart P4V. And, create <code>.p4ignore</code> at your workspace directory. Let us test whether <code>.p4ignore</code> works well. Fill the contents of <code>.p4ignore</code> like below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*.sln</span><br></pre></td></tr></table></figure>
<p>Select <code>Mark for Add...</code> for <code>.p4ignore</code> and submit it.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/22.png" class="">
<p>Next, create a empty file whose name is <code>Test.sln</code>. Try to add this !</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/23.png" class="">
<p>You try to check out the file, but the dialog would be popped-up. Great, your p4ignore works well.</p>
<img src="/2021/09/10/perforce-server-setup-with-digital-ocean/24.png" class="">
<p>If your project uses UnrealEngine, you should search for good one. I recommend you to use <a target="_blank" rel="noopener" href="https://github.com/mattmarcin/ue4-perforce/blob/master/.p4ignore">the p4ignore mentioned at references</a>. Okay, then…all of preparation done. You are good to go :) !</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2021/09/10/perforce-server-setup-with-digital-ocean/" data-id="cmfidx74k0011csqmcvxs8jfc" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2021/09/10/perforce-server-setup-with-digital-ocean/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DigitalOcean/" rel="tag">DigitalOcean</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Perforce/" rel="tag">Perforce</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ubuntu/" rel="tag">Ubuntu</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-how-unreal-macro-generated" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/08/06/how-unreal-macro-generated/" class="article-date">
  <time datetime="2021-08-06T13:49:57.000Z" itemprop="datePublished">2021-08-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/06/how-unreal-macro-generated/">How Unreal Macro Generated</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>Environment</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>UnrealEngine</td>
<td><code>branch: ue5-early-access</code></td>
</tr>
<tr>
<td>Visual Studio 2019</td>
<td><code>version: 16.10.4</code></td>
</tr>
<tr>
<td>Windows 10</td>
<td><code>build: 19043.1110</code></td>
</tr>
</tbody></table>
<h1 id="Expanding-UCLASS"><a href="#Expanding-UCLASS" class="headerlink" title="Expanding UCLASS()"></a><em>Expanding <code>UCLASS()</code></em></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Runtime/Engine/Classes/GameFramework/PlayerController.h</span><br><span class="line"></span><br><span class="line">UCLASS(config=Game, BlueprintType, Blueprintable, meta=(ShortTooltip=&quot;A Player Controller is an actor responsible for controlling a Pawn used by the player.&quot;))</span><br><span class="line">class ENGINE_API APlayerController : public AController</span><br></pre></td></tr></table></figure>

<p>The macro <code>UCLASS()</code> may be the most famous one of the unreal macros. First of all, let us find out how it can be expanded. Our goal is expanding <code>UCLASS()</code> of the class <code>APlayerController</code>, which can be found at line #222 of <code>PlayerController.h</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Runtime/CoreUObject/Public/UObject/ObjectMacros.h</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> UE_BUILD_DOCS || defined(__INTELLISENSE__ )</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UCLASS(...)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UCLASS(...) BODY_MACRO_COMBINE(CURRENT_FILE_ID,_,__LINE__,_PROLOG)</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>In UnrealEngine, most of definitions for core macros are placed in <code>ObjectMacros.h</code> file. We can see the definition of <code>UCLASS</code> here, and it would be the second definition in usual case. Then, what is the macro <code>BODY_MACRO_COMBINE</code> ?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Runtime/CoreUObject/Public/UObject/ObjectMacros.h</span><br><span class="line"></span><br><span class="line">// This pair of macros is used to help implement GENERATED_BODY() and GENERATED_USTRUCT_BODY()</span><br><span class="line">#define BODY_MACRO_COMBINE_INNER(A,B,C,D) A##B##C##D</span><br><span class="line">#define BODY_MACRO_COMBINE(A,B,C,D) BODY_MACRO_COMBINE_INNER(A,B,C,D)</span><br></pre></td></tr></table></figure>

<p>The macro is defined as <code>BODY_MACRO_COMBINE_INNER</code>, which concatenates parameters as one string. Thus, the macro <code>UCLASS</code> would result the text like below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UCLASS(...) -&gt;</span><br><span class="line">BODY_MACRO_COMBINE(CURRENT_FILE_ID,_,222,_PROLOG) -&gt;</span><br><span class="line">BODY_MACRO_COMBINE_INNER(CURRENT_FILE_ID,_,222,_PROLOG) -&gt;</span><br><span class="line">CURRENT_FILE_ID_222_PROLOG</span><br></pre></td></tr></table></figure>

<img src="/2021/08/06/how-unreal-macro-generated/02.png" class="">

<p>It can be tested with simple code. Check it out at the screenshot below. The <code>__LINE__</code> is one of <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/cpp/preprocessor/predefined-macros?view=msvc-160">pre-defined macro</a>, so it is turned to <code>222</code>, where the <code>UCLASS</code> is written.</p>
<img src="/2021/08/06/how-unreal-macro-generated/01.png" class="">

<p>Here is test code and its result. Check the name of integer variable.</p>
<p>Actually, the macro <code>CURRENT_FILE_ID</code> can be found at header files generated by <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/4.26/en-US/ProductionPipelines/BuildTools/UnrealHeaderTool/">Unreal Header Tool</a>. You can find the definition at generated header files, for instance, <code>PlayerController.generated.h</code>. The generated header files are created when you attempt to build your project.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Intermediate/Build/Win64/UnrealEditor/Inc/Engine/PlayerController.generated.h</span><br><span class="line"></span><br><span class="line">#undef CURRENT_FILE_ID</span><br><span class="line">#define CURRENT_FILE_ID Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h</span><br></pre></td></tr></table></figure>

<p>Thus, the macro <code>CURRENT_FILE_ID</code> would be replaced before <code>BODY_MACRO_COMBINE</code> is expanded. We can rewrite the macro evaluation process.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UCLASS(...) -&gt;</span><br><span class="line">BODY_MACRO_COMBINE(Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h,_,222,_PROLOG) -&gt;</span><br><span class="line">BODY_MACRO_COMBINE_INNER(Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h,_,222,_PROLOG) -&gt;</span><br><span class="line">Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h_222_PROLOG</span><br></pre></td></tr></table></figure>

<p>And, the <code>Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h_222_PROLOG</code> is also defined at the generated header file for <code>PlayerController.h</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Intermediate/Build/Win64/UnrealEditor/Inc/Engine/PlayerController.generated.h</span><br><span class="line"></span><br><span class="line">#define Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h_222_PROLOG \</span><br><span class="line">	Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h_225_EVENT_PARMS</span><br></pre></td></tr></table></figure>

<p>The <code>Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h_225_EVENT_PARMS</code> is a macro containing definitions for essential structures.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Intermediate/Build/Win64/UnrealEditor/Inc/Engine/PlayerController.generated.h</span><br><span class="line"></span><br><span class="line">#define Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h_225_EVENT_PARMS \</span><br><span class="line">	struct PlayerController_eventClientAddTextureStreamingLoc_Parms \</span><br><span class="line">	&#123; \</span><br><span class="line">		FVector InLoc; \</span><br><span class="line">		float Duration; \</span><br><span class="line">		bool bOverrideLocation; \</span><br><span class="line">	&#125;; \</span><br><span class="line">	struct PlayerController_eventClientCapBandwidth_Parms \</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<p>Let us rewrite the evaluation process. As a result, the macro <code>UCLASS</code> is replaced by definitions for some essential structures.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UCLASS(...) -&gt;</span><br><span class="line">BODY_MACRO_COMBINE(Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h,_,222,_PROLOG) -&gt;</span><br><span class="line">BODY_MACRO_COMBINE_INNER(Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h,_,222,_PROLOG) -&gt;</span><br><span class="line">Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h_222_PROLOG -&gt;</span><br><span class="line">Engine_Source_Runtime_Engine_Classes_GameFramework_PlayerController_h_225_EVENT_PARMS -&gt;</span><br><span class="line">struct PlayerController_eventClientAddTextureStreamingLoc_Parms...(omitted)</span><br></pre></td></tr></table></figure>

<p>Okay, we have just peeled off one layer to the truth. But, is that all ? We should take care of something more…Most of time, the macro <code>UCLASS</code> is not solely used. Various keywords and specifiers come with this. (ex: <code>config=Game</code>, <code>BlueprintType</code>, <code>meta=(ShortTooltip=...</code>, …) So, how they are handled ? Even, how the generated header file is created ?</p>
<h1 id="Generated-Header-File"><a href="#Generated-Header-File" class="headerlink" title="Generated Header File"></a><em>Generated Header File</em></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Programs/UnrealHeaderTool/Private/CodeGenerator.cpp</span><br><span class="line"></span><br><span class="line">FPreloadHeaderFileInfo&amp; FileInfo = PreloadedFiles[Index];</span><br><span class="line">bool bHasChanged = ConstThis-&gt;WriteHeader(FileInfo, GeneratedHeaderText, AdditionalHeaders, ReferenceGatherers, TempSaveTasks[Index]);</span><br></pre></td></tr></table></figure>

<p>The UHT writes header files containing auto-generated codes at the code above. The <code>PreloadedFiles</code> has absolute paths of generated header file, for instance, <code>D:/Git/UnrealEngine/Engine/.../Inc/Engine/PlayerController.generated.h</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Programs/UnrealHeaderTool/Private/CodeGenerator.cpp</span><br><span class="line"></span><br><span class="line">TArray&lt;FPreloadHeaderFileInfo&gt; PreloadedFiles;</span><br><span class="line">PreloadedFiles.SetNum(Exported.Num());</span><br><span class="line"></span><br><span class="line">ParallelFor(Exported.Num(), [&amp;Exported, &amp;PreloadedFiles, Package=Package, ConstPackageManifest](int32 Index)</span><br><span class="line">&#123;</span><br><span class="line">	FUnrealSourceFile* SourceFile = Exported[Index];</span><br><span class="line"></span><br><span class="line">	FString ModuleRelativeFilename = SourceFile-&gt;GetFilename();</span><br><span class="line">	ConvertToBuildIncludePath(Package, ModuleRelativeFilename);</span><br><span class="line"></span><br><span class="line">	FString StrippedName = FPaths::GetBaseFilename(MoveTemp(ModuleRelativeFilename));</span><br><span class="line">	FString HeaderPath = (ConstPackageManifest-&gt;GeneratedIncludeDirectory / StrippedName) + TEXT(&quot;.generated.h&quot;);</span><br><span class="line"></span><br><span class="line">	PreloadedFiles[Index].Load(MoveTemp(HeaderPath));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<img src="/2021/08/06/how-unreal-macro-generated/03.png" class="">

<p>An example of <code>NoExportTypes.generated.h</code>.</p>
<p>You can track what UHT writes on the generated header file via the variable <code>GeneratedHeaderText</code>. Because its contents will replace old generated header file, whenever there is any difference between old contents and new contents.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Programs/UnrealHeaderTool/Private/CodeGenerator.cpp</span><br><span class="line"></span><br><span class="line">GeneratedHeaderText.Logf(</span><br><span class="line">	TEXT(&quot;#ifdef %s&quot;)																	LINE_TERMINATOR</span><br><span class="line">	TEXT(&quot;#error \&quot;%s.generated.h already included, missing &#x27;#pragma once&#x27; in %s.h\&quot;&quot;)	LINE_TERMINATOR</span><br><span class="line">	TEXT(&quot;#endif&quot;)																		LINE_TERMINATOR</span><br><span class="line">	TEXT(&quot;#define %s&quot;)																	LINE_TERMINATOR</span><br><span class="line">	LINE_TERMINATOR,</span><br><span class="line">	*FileDefineName, *StrippedFilename, *StrippedFilename, *FileDefineName);</span><br></pre></td></tr></table></figure>

<p>For example, there is some definition for preventing duplicated include. The format above turns to like below.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Intermediate/Build/Win64/UnrealEditor/Inc/Engine/PlayerController.generated.h</span><br><span class="line"></span><br><span class="line">#ifdef ENGINE_PlayerController_generated_h</span><br><span class="line">#error &quot;PlayerController.generated.h already included, missing &#x27;#pragma once&#x27; in PlayerController.h&quot;</span><br><span class="line">#endif</span><br><span class="line">#define ENGINE_PlayerController_generated_h</span><br></pre></td></tr></table></figure>

<p>There are more things worthy to check.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Programs/UnrealHeaderTool/Private/CodeGenerator.cpp</span><br><span class="line"></span><br><span class="line">FString MacroName = SourceFile.GetGeneratedMacroName(ClassData, TEXT(&quot;_EVENT_PARMS&quot;));</span><br><span class="line">WriteMacro(OutGeneratedHeaderText, MacroName, UClassMacroContent);</span><br><span class="line">PrologMacroCalls.Logf(TEXT(&quot;\t%s\r\n&quot;), *MacroName);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">GeneratedHeaderText.Log(TEXT(&quot;#undef CURRENT_FILE_ID\r\n&quot;));</span><br><span class="line">GeneratedHeaderText.Logf(TEXT(&quot;#define CURRENT_FILE_ID %s\r\n\r\n\r\n&quot;), *SourceFile-&gt;GetFileId());</span><br></pre></td></tr></table></figure>

<p>That is why the <code>CURRENT_FILE_ID</code> and <code>..._EVENT_PARMS</code> macros are defined. Furthermore, other codes can be found at <code>FNativeClassHeaderGenerator::FNativeClassHeaderGenerator(const UPackage*, const TSet&lt;FUnrealSourceFile*&gt;&amp;, FClasses&amp;, bool)</code>.</p>
<p>So, we have found the relationship of unreal macro and generated header file. But, there is one thing left, the metadata.</p>
<h1 id="Metadata-Parser"><a href="#Metadata-Parser" class="headerlink" title="Metadata Parser"></a><em>Metadata Parser</em></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Runtime/Engine/Classes/GameFramework/PlayerController.h</span><br><span class="line"></span><br><span class="line">UCLASS(config=Game, BlueprintType, Blueprintable, meta=(ShortTooltip=&quot;A Player Controller is an actor responsible for controlling a Pawn used by the player.&quot;))</span><br><span class="line">class ENGINE_API APlayerController : public AController</span><br></pre></td></tr></table></figure>

<p>Back to the start, there are metadata within the macro <code>UCLASS</code> such as <code>config=Game</code>, <code>BlueprintType</code> and <code>meta=...</code>. We are going to check out how they are handled by UnrealEngine.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Runtime/CoreUObject/Public/UObject/ObjectMacros.h</span><br><span class="line"></span><br><span class="line"><span class="comment">// These are used for syntax highlighting and to allow autocomplete hints</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> UC</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// valid keywords for the UCLASS macro</span></span><br><span class="line">	<span class="keyword">enum</span> </span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">/// This keyword is used to set the actor group that the class is show in, in the editor.</span></span><br><span class="line">		classGroup,</span><br><span class="line"></span><br><span class="line">		<span class="comment">/// Declares that instances of this class should always have an outer of the specified class.  This is inherited by subclasses unless overridden.</span></span><br><span class="line">		Within, <span class="comment">/* =OuterClassName */</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">/// Exposes this class as a type that can be used for variables in blueprints</span></span><br><span class="line">		BlueprintType,</span><br><span class="line"></span><br><span class="line">		<span class="comment">/// Prevents this class from being used for variables in blueprints</span></span><br><span class="line">		NotBlueprintType,</span><br><span class="line"></span><br><span class="line">		<span class="comment">/// Exposes this class as an acceptable base class for creating blueprints. The default is NotBlueprintable, unless inherited otherwise. This is inherited by subclasses.</span></span><br><span class="line">		Blueprintable,</span><br><span class="line"></span><br><span class="line">		<span class="comment">/// Specifies that this class is *NOT* an acceptable base class for creating blueprints. The default is NotBlueprintable, unless inherited otherwise. This is inherited by subclasses.</span></span><br><span class="line">		NotBlueprintable,</span><br><span class="line">		...</span><br></pre></td></tr></table></figure>

<p>You can find some enum definitions seems related to the metadata. But, they are for only supporting autocomplete hints such as Intellisense and VisualAssistX. There is another code handling metadata.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Programs/UnrealHeader/Private/CodeGenerator.cpp</span><br><span class="line"></span><br><span class="line">const TArray&lt;FString&gt;&amp; UObjectHeaders =</span><br><span class="line">	(CurrentlyProcessing == PublicClassesHeaders) ? Module.PublicUObjectClassesHeaders :</span><br><span class="line">	(CurrentlyProcessing == PublicHeaders       ) ? Module.PublicUObjectHeaders        :</span><br><span class="line">							Module.PrivateUObjectHeaders;</span><br><span class="line">...</span><br><span class="line">ParallelFor(UObjectHeaders.Num(), [&amp;](int32 Index)</span><br><span class="line">&#123;</span><br><span class="line">	const FString&amp; RawFilename = UObjectHeaders[Index];</span><br><span class="line"></span><br><span class="line">#if !PLATFORM_EXCEPTIONS_DISABLED</span><br><span class="line">	try</span><br><span class="line">#endif</span><br><span class="line">	&#123;</span><br><span class="line">		PerformSimplifiedClassParse(Package, *RawFilename, *HeaderFiles[Index], PerHeaderData[Index]);</span><br><span class="line">	&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<img src="/2021/08/06/how-unreal-macro-generated/04.png" class="">

<p>This code is for parsing metadata. Any header file in your project is passed through the parsing.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">static void SetupUObjectModuleHeader(UHTModuleInfo ModuleInfo, FileItem HeaderFile, SourceFileMetadataCache MetadataCache)</span><br><span class="line">&#123;</span><br><span class="line">	// Check to see if we know anything about this file.  If we have up-to-date cached information about whether it has</span><br><span class="line">	// UObjects or not, we can skip doing a test here.</span><br><span class="line">	if (MetadataCache.ContainsReflectionMarkup(HeaderFile))</span><br><span class="line">	&#123;</span><br><span class="line">		lock(ModuleInfo)</span><br><span class="line">		&#123;</span><br><span class="line">			bool bFoundHeaderLocation = false;</span><br><span class="line">			foreach (DirectoryReference ModuleDirectory in ModuleInfo.ModuleDirectories)</span><br><span class="line">			&#123;</span><br><span class="line">				if (HeaderFile.Location.IsUnderDirectory(DirectoryReference.Combine(ModuleDirectory, &quot;Classes&quot;)))</span><br><span class="line">				&#123;</span><br><span class="line">					ModuleInfo.PublicUObjectClassesHeaders.Add(HeaderFile);</span><br><span class="line">					bFoundHeaderLocation = true;</span><br><span class="line">				&#125;</span><br><span class="line">				else if (HeaderFile.Location.IsUnderDirectory(DirectoryReference.Combine(ModuleDirectory, &quot;Public&quot;)))</span><br><span class="line">				&#123;</span><br><span class="line">					ModuleInfo.PublicUObjectHeaders.Add(HeaderFile);</span><br><span class="line">					bFoundHeaderLocation = true;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			if (!bFoundHeaderLocation)</span><br><span class="line">			&#123;</span><br><span class="line">				ModuleInfo.PrivateUObjectHeaders.Add(HeaderFile);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>About all modules, header files in <code>Classes</code> folder are stored at <code>PublicUObjectClassesHeaders</code> and header files in <code>Public</code> folder are stored at <code>PublicUObjectHeaders</code>. Even you have located a header file in other folder, the <code>Unreal Build Tool</code> collects it into <code>PrivateUObjectHeaders</code>.</p>
<img src="/2021/08/06/how-unreal-macro-generated/05.png" class="">

<p>A screenshot on debugging UBT.</p>
<p>Back to the <code>FBaseParser::ReadSpecifierSetInsideMacro()</code>, let us test with the keyword <code>BlueprintType</code>. How does the <code>BlueprintType</code> keyword parsed ? The UHT parses your header file with tokens. Suppose the input as <code>UCLASS(config=Game, BlueprintType, Blueprintable, meta=(...))</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/UnrealEngine/Engine/Source/Programs/UnrealHeaderTool/Private/HeaderParser.cpp</span><br><span class="line"></span><br><span class="line">if (Token.Matches(TEXT(&quot;UCLASS&quot;), ESearchCase::CaseSensitive))</span><br><span class="line">&#123;</span><br><span class="line">	bHaveSeenUClass = true;</span><br><span class="line">	bEncounteredNewStyleClass_UnmatchedBrackets = true;</span><br><span class="line">	UClass* Class = CompileClassDeclaration(AllClasses);</span><br><span class="line">	GStructToSourceLine.Add(Class, MakeTuple(GetCurrentSourceFile()-&gt;AsShared(), Token.StartLine));</span><br><span class="line">	return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Due to this code, the left input would be <code>(config=Game, BlueprintType, Blueprintable, meta=(...))</code>. And, the following tokenizing is like below based on <code>FBaseParser::ReadSpecifierSetInsideMacro()</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(config=Game, BlueprintType, Blueprintable, meta=(...))</span><br><span class="line">-&gt; RequireSymbol(TEXT(&#x27;(&#x27;), ErrorMessageGetter);</span><br><span class="line">config=Game, BlueprintType, Blueprintable, meta=(...))</span><br><span class="line">-&gt; GetToken(Specifier); SpecifiersFound.Emplace(Specifier.Identifier);</span><br><span class="line">, BlueprintType, Blueprintable, meta=(...))</span><br><span class="line">-&gt; RequireSymbol(TEXT(&#x27;,&#x27;), ErrorMessageGetter);</span><br><span class="line">BlueprintType, Blueprintable, meta=(...))</span><br><span class="line">-&gt; GetToken(Specifier); GetMetadataKeyword(Specifier.Identifier);</span><br><span class="line">, Blueprintable, meta=(...))</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<img src="/2021/08/06/how-unreal-macro-generated/06.png" class="">

<p>A screenshot on debugging UHT.</p>
<h1 id="Wrap-Up"><a href="#Wrap-Up" class="headerlink" title="Wrap-Up"></a><em>Wrap-Up</em></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">C/CPP (pure) macro</span><br><span class="line">C/CPP code with macro ---(preprocessor)---&gt;</span><br><span class="line">C/CPP code with evaluated code from macro ---(rest of job)---&gt; ...</span><br><span class="line"></span><br><span class="line">unreal macro</span><br><span class="line">C/CPP code with unreal macro ---(UHT and UBT)---&gt;</span><br><span class="line">C/CPP code with generated code(+macro) from UHT and UBT ---(preprocessor)---&gt;</span><br><span class="line">C/CPP code with evaluated code from macro ---(rest of job)---&gt; ...</span><br></pre></td></tr></table></figure>

<p>There are so many hidden code for implementing unreal macros, and the macros have complicated relationship with other engine code. Even most part of final code from the macros cannot be evaluated before some preprocessing and compilation. In this perspective, unreal macro such as <code>UCLASS</code> is not a pure C&#x2F;CPP macro, because unreal macro functions fully only when UHT and UBT must preprocess the macro.</p>
<img src="/2021/08/06/how-unreal-macro-generated/07.png" class="">

<p>There is no doubt. Any of C&#x2F;CPP compiler cannot recognize the unreal macro such as <code>UCLASS</code>. Even the Epic Games did not modify the compilers, and did not have to do. They have simply setup some build pipeline satisfying their needs. The program managing their custom build pipeline is the <code>Unreal Build Tool</code>, UBT. Most of jobs for build are done by UBT and UHT. In <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/4.26/en-US/ProductionPipelines/BuildTools/UnrealHeaderTool/">official document for UHT</a>, these background knowledge is introduced.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UnrealHeaderTool (UHT) is a custom parsing and code-generation tool that supports the UObject system. Code compilation happens in two phases:</span><br><span class="line"></span><br><span class="line">1. UHT is invoked, which parses the C++ headers for Unreal-related class metadata and generates custom code to implement the various UObject-related features.</span><br><span class="line">2. The normal C++ compiler is invoked to compile the results.</span><br><span class="line"></span><br><span class="line">When compiling, it is possible for either tool to emit errors, so be sure to look carefully.</span><br></pre></td></tr></table></figure>

<p>As they said, the compilation order is the opposite direction of the paragraphs; <code>Expanding UCLASS</code>, <code>Generated Header File</code> and <code>Metadata Parser</code>. The actions for <code>Expanding UCLASS</code> are done by C&#x2F;CPP compilers(+preprocessors), and the actions for <code>Generated Header File</code> and <code>Metadata Parser</code> are done by UHT. Additionally, actions for <code>Metadata Parser</code> happens early than ones for <code>Generated Header File</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">main function for parsing metadata -&gt; FHeaderParser::ParseHeaders()</span><br><span class="line">main function for generating header file -&gt; FHeaderParser::ExportNativeHeaders()</span><br></pre></td></tr></table></figure>

<img src="/2021/08/06/how-unreal-macro-generated/08.png" class="">

<p>Let us make a conclusion.</p>
<ul>
<li>The result from unreal macro is hard to evaluate before processing by UBT(+UHT).</li>
<li>Some features of UnrealEngine are implemented by auto-generated codes.</li>
<li>You should look into the build pipeline of UnrealEngine if need to modify unreal macro things.</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2021/08/06/how-unreal-macro-generated/" data-id="cmfidx74j000tcsqme28m5j4h" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2021/08/06/how-unreal-macro-generated/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-cpp-std-vector-growth" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/05/16/cpp-std-vector-growth/" class="article-date">
  <time datetime="2021-05-16T12:35:54.000Z" itemprop="datePublished">2021-05-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/05/16/cpp-std-vector-growth/">Growth of std::vector</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a><em><code>Overview</code></em></h3><p>Nowadays, STL is an essential component in almost every CPP project. That is why several questions about STL are asked in a technical interview. Especially, the <code>std::vector</code> is a popular subject. In this post, we gonna check the codes related to <code>std::vector</code>‘s growth, which is a hot topic in STL.<br>The term “growth” in <code>std::vector</code> means an event to increase a size of instance by some actions. The action would be inserting an element (e.g. <code>push_back()</code>) or tuning its size (e.g. <code>resize()</code>). Some of us say “When the growth happens, its size become twice.”, but some of others say “No, it is exactly 3&#x2F;2 times.”. Well…both of saying are not wrong. Let us find out why it is.</p>
<p>The environment is below:</p>
<ul>
<li>MSVC<ul>
<li>Windows 10 <code>2004 OS Build 19041.985</code></li>
<li>MSVC <code>19.28.29914</code></li>
</ul>
</li>
<li>GCC<ul>
<li>Ubuntu 18 <code>18.04.4 LTS</code></li>
<li>GCC <code>7.5.0</code></li>
</ul>
</li>
</ul>
<p>The reference is below:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://en.cppreference.com/w/cpp/container/vector">https://en.cppreference.com/w/cpp/container/vector</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/microsoft/STL/blob/f17f2e72001f570cb6fe5a6e1c0c32fcc90ee53a/stl/inc/vector">https://github.com/microsoft/STL/blob/f17f2e72001f570cb6fe5a6e1c0c32fcc90ee53a/stl/inc/vector</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_vector.h">https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_vector.h</a></li>
</ul>
<h3 id="Growth-in-MSVC"><a href="#Growth-in-MSVC" class="headerlink" title="Growth in MSVC"></a><em><code>Growth in MSVC</code></em></h3><p>First, let us trace codes about <code>push_back()</code>. Suppose we use a code below:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Number = <span class="number">0</span>;</span><br><span class="line">std::vector&lt;<span class="type">int</span>&gt; Instance;</span><br><span class="line">Instance.<span class="built_in">push_back</span>(Number);</span><br></pre></td></tr></table></figure>
<p>The function below will be called in this code. You can find all of STL codes for MSVC at <a target="_blank" rel="noopener" href="https://github.com/microsoft/STL/blob/f17f2e72001f570cb6fe5a6e1c0c32fcc90ee53a/stl/inc/vector">reference #2</a>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_CONSTEXPR20_CONTAINER <span class="type">void</span> <span class="title">push_back</span><span class="params">(<span class="type">const</span> _Ty&amp; _Val)</span> </span>&#123; <span class="comment">// insert element at end, provide strong guarantee</span></span><br><span class="line">    <span class="built_in">emplace_back</span>(_Val);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span>... _Valty&gt;</span><br><span class="line"><span class="function">_CONSTEXPR20_CONTAINER <span class="keyword">decltype</span>(<span class="keyword">auto</span>) <span class="title">emplace_back</span><span class="params">(_Valty&amp;&amp;... _Val)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// insert by perfectly forwarding into element at end, provide strong guarantee</span></span><br><span class="line">    <span class="keyword">auto</span>&amp; _My_data   = _Mypair._Myval2;</span><br><span class="line">    pointer&amp; _Mylast = _My_data._Mylast;</span><br><span class="line">    <span class="keyword">if</span> (_Mylast != _My_data._Myend) &#123;</span><br><span class="line">        <span class="keyword">return</span> _Emplace_back_with_unused_capacity(_STD forward&lt;_Valty&gt;(_Val)...);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    _Ty&amp; _Result = *_Emplace_reallocate(_Mylast, _STD forward&lt;_Valty&gt;(_Val)...);</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> _HAS_CXX17</span></span><br><span class="line">    <span class="keyword">return</span> _Result;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span> <span class="comment">// ^^^ _HAS_CXX17 ^^^ // vvv !_HAS_CXX17 vvv</span></span></span><br><span class="line">    (<span class="type">void</span>) _Result;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// _HAS_CXX17</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As you can see, there is a branch on returning the function. When <code>_Mylast != _My_data._Myend</code> is true, the growth not happens. Because the logic in the <code>_Emplace_back_with_unused_capacity()</code> does not reallocate memory, but reuse unused memory. FYI, values about <code>_Mypair</code> have the relationship like below:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_Compressed_pair&lt;_Alty, _Scary_val&gt; _Mypair;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://github.com/microsoft/STL/blob/c12089e489c7b6a3896f5043ed545ac8d1870590/stl/inc/xmemory</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Ty1</span>, <span class="keyword">class</span> <span class="title class_">_Ty2</span>, <span class="type">bool</span> = is_empty_v&lt;_Ty1&gt; &amp;&amp; !is_final_v&lt;_Ty1&gt;&gt;</span><br><span class="line"><span class="keyword">class</span> _Compressed_pair <span class="keyword">final</span> : <span class="keyword">private</span> _Ty1 &#123; <span class="comment">// store a pair of values, deriving from empty first</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    _Ty2 _Myval2;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CLASS TEMPLATE vector</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Ty</span>, <span class="keyword">class</span> <span class="title class_">_Alloc</span> = allocator&lt;_Ty&gt;&gt;</span><br><span class="line"><span class="keyword">class</span> vector &#123; <span class="comment">// varying size array of values</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span>&gt;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">class</span> _Vb_val;</span><br><span class="line">    <span class="keyword">friend</span> _Tidy_guard&lt;vector&gt;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">using</span> _Alty        = _Rebind_alloc_t&lt;_Alloc, _Ty&gt;;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">using</span> _Scary_val = _Vector_val&lt;<span class="type">conditional_t</span>&lt;_Is_simple_alloc_v&lt;_Alty&gt;, _Simple_types&lt;_Ty&gt;,</span><br><span class="line">        _Vec_iter_types&lt;_Ty, size_type, difference_type, pointer, const_pointer, _Ty&amp;, <span class="type">const</span> _Ty&amp;&gt;&gt;&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CLASS TEMPLATE _Vector_val</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Val_types</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_Vector_val</span> : <span class="keyword">public</span> _Container_base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">using</span> value_type      = <span class="keyword">typename</span> _Val_types::value_type;</span><br><span class="line">    <span class="keyword">using</span> size_type       = <span class="keyword">typename</span> _Val_types::size_type;</span><br><span class="line">    <span class="keyword">using</span> difference_type = <span class="keyword">typename</span> _Val_types::difference_type;</span><br><span class="line">    <span class="keyword">using</span> pointer         = <span class="keyword">typename</span> _Val_types::pointer;</span><br><span class="line">    <span class="keyword">using</span> const_pointer   = <span class="keyword">typename</span> _Val_types::const_pointer;</span><br><span class="line">    <span class="keyword">using</span> reference       = value_type&amp;;</span><br><span class="line">    <span class="keyword">using</span> const_reference = <span class="type">const</span> value_type&amp;;</span><br><span class="line"></span><br><span class="line">    _CONSTEXPR20_CONTAINER _Vector_val() <span class="keyword">noexcept</span> : _Myfirst(), _Mylast(), _Myend() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    _CONSTEXPR20_CONTAINER _Vector_val(pointer _First, pointer _Last, pointer _End) <span class="keyword">noexcept</span></span><br><span class="line">        : _Myfirst(_First), _Mylast(_Last), _Myend(_End) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    _CONSTEXPR20_CONTAINER <span class="type">void</span> _Swap_val(_Vector_val&amp; _Right) <span class="keyword">noexcept</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;_Swap_proxy_and_iterators(_Right);</span><br><span class="line">        _Swap_adl(_Myfirst, _Right._Myfirst);</span><br><span class="line">        _Swap_adl(_Mylast, _Right._Mylast);</span><br><span class="line">        _Swap_adl(_Myend, _Right._Myend);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    _CONSTEXPR20_CONTAINER <span class="type">void</span> _Take_contents(_Vector_val&amp; _Right) <span class="keyword">noexcept</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;_Swap_proxy_and_iterators(_Right);</span><br><span class="line">        _Myfirst = _Right._Myfirst;</span><br><span class="line">        _Mylast  = _Right._Mylast;</span><br><span class="line">        _Myend   = _Right._Myend;</span><br><span class="line"></span><br><span class="line">        _Right._Myfirst = <span class="literal">nullptr</span>;</span><br><span class="line">        _Right._Mylast  = <span class="literal">nullptr</span>;</span><br><span class="line">        _Right._Myend   = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pointer _Myfirst; <span class="comment">// pointer to beginning of array</span></span><br><span class="line">    pointer _Mylast; <span class="comment">// pointer to current end of sequence</span></span><br><span class="line">    pointer _Myend; <span class="comment">// pointer to end of array</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Since the elements are placed in sequential memory address, <code>_Mylast - _Myfirst</code> means “currently used size”.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_NODISCARD _CONSTEXPR20_CONTAINER size_type <span class="title">size</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span>&amp; _My_data = _Mypair._Myval2;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">static_cast</span>&lt;size_type&gt;(_My_data._Mylast - _My_data._Myfirst);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Similarly, <code>_Myend - _Myfirst</code> means “currently avaiable size”.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_NODISCARD _CONSTEXPR20_CONTAINER size_type <span class="title">capacity</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span>&amp; _My_data = _Mypair._Myval2;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">static_cast</span>&lt;size_type&gt;(_My_data._Myend - _My_data._Myfirst);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As a result, <code>_Mylast != _My_data._Myend</code> is true when <code>_Mylast &lt; _Myend</code> is true. That is why reallocation not happens. Get back to <code>emplace_back()</code> code. According to those upper reasons, now we need to focus on <code>_Emplace_reallocated()</code> function.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span>... _Valty&gt;</span><br><span class="line">_CONSTEXPR20_CONTAINER pointer _Emplace_reallocate(<span class="type">const</span> pointer _Whereptr, _Valty&amp;&amp;... _Val) &#123;</span><br><span class="line">    <span class="comment">// reallocate and insert by perfectly forwarding _Val at _Whereptr</span></span><br><span class="line">    _Alty&amp; _Al        = _Getal();</span><br><span class="line">    <span class="keyword">auto</span>&amp; _My_data    = _Mypair._Myval2;</span><br><span class="line">    pointer&amp; _Myfirst = _My_data._Myfirst;</span><br><span class="line">    pointer&amp; _Mylast  = _My_data._Mylast;</span><br><span class="line"></span><br><span class="line">    _STL_INTERNAL_CHECK(_Mylast == _My_data._Myend); <span class="comment">// check that we have no unused capacity</span></span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> _Whereoff = <span class="built_in">static_cast</span>&lt;size_type&gt;(_Whereptr - _Myfirst);</span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> _Oldsize  = <span class="built_in">static_cast</span>&lt;size_type&gt;(_Mylast - _Myfirst);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (_Oldsize == <span class="built_in">max_size</span>()) &#123;</span><br><span class="line">        _Xlength();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> size_type _Newsize     = _Oldsize + <span class="number">1</span>;</span><br><span class="line">    <span class="type">const</span> size_type _Newcapacity = _Calculate_growth(_Newsize);</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> pointer _Newvec           = _Al.<span class="built_in">allocate</span>(_Newcapacity);</span><br><span class="line">    <span class="type">const</span> pointer _Constructed_last = _Newvec + _Whereoff + <span class="number">1</span>;</span><br><span class="line">    pointer _Constructed_first      = _Constructed_last;</span><br><span class="line"></span><br><span class="line">    <span class="function">_TRY_BEGIN</span></span><br><span class="line"><span class="function">    <span class="title">_Alty_traits::construct</span><span class="params">(_Al, _Unfancy(_Newvec + _Whereoff), _STD forward&lt;_Valty&gt;(_Val)...)</span></span>;</span><br><span class="line">    _Constructed_first = _Newvec + _Whereoff;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (_Whereptr == _Mylast) &#123; <span class="comment">// at back, provide strong guarantee</span></span><br><span class="line">        _Umove_if_noexcept(_Myfirst, _Mylast, _Newvec);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// provide basic guarantee</span></span><br><span class="line">        _Umove(_Myfirst, _Whereptr, _Newvec);</span><br><span class="line">        _Constructed_first = _Newvec;</span><br><span class="line">        _Umove(_Whereptr, _Mylast, _Newvec + _Whereoff + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    _CATCH_ALL</span><br><span class="line">    _Destroy(_Constructed_first, _Constructed_last);</span><br><span class="line">    _Al.<span class="built_in">deallocate</span>(_Newvec, _Newcapacity);</span><br><span class="line">    _RERAISE;</span><br><span class="line">    _CATCH_END</span><br><span class="line"></span><br><span class="line">    _Change_array(_Newvec, _Newsize, _Newcapacity);</span><br><span class="line">    <span class="keyword">return</span> _Newvec + _Whereoff;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As you can see the codes, deallocation and reallocation happen. The variable <code>_Newcapacity</code> determines the size of memory will be reallocated. Let us check the function <code>_Calculate_growth()</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_NODISCARD _CONSTEXPR20_CONTAINER size_type <span class="title">max_size</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (_STD min)(</span><br><span class="line">        <span class="built_in">static_cast</span>&lt;size_type&gt;((numeric_limits&lt;difference_type&gt;::max)()), _Alty_traits::<span class="built_in">max_size</span>(_Getal()));</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">_CONSTEXPR20_CONTAINER size_type _Calculate_growth(<span class="type">const</span> size_type _Newsize) <span class="type">const</span> &#123;</span><br><span class="line">    <span class="comment">// given _Oldcapacity and _Newsize, calculate geometric growth</span></span><br><span class="line">    <span class="type">const</span> size_type _Oldcapacity = <span class="built_in">capacity</span>();</span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> _Max              = <span class="built_in">max_size</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (_Oldcapacity &gt; _Max - _Oldcapacity / <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> _Max; <span class="comment">// geometric growth would overflow</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> size_type _Geometric = _Oldcapacity + _Oldcapacity / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (_Geometric &lt; _Newsize) &#123;</span><br><span class="line">        <span class="keyword">return</span> _Newsize; <span class="comment">// geometric growth would be insufficient</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> _Geometric; <span class="comment">// geometric growth is sufficient</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>There are three return statement in the function.</p>
<ul>
<li>First, when the current available size is bigger than 2&#x2F;3 times of maximum size.</li>
</ul>
<p>For instance, a maximum value of <code>int</code> type is <code>+2,147,483,647</code> and 2&#x2F;3 times of value is <code>+1,431,655,764.666... ≒ +1,431,655,765</code>. Let us put them in the expression. <code>if (1431655765 &gt; 2147483647 - 1431655765 / 2)</code> will be false, but how about if <code>_Oldcapacity = +1,431,655,766</code> ? <code>if (1431655766 &gt; 2147483647 - 1431655766 / 2)</code> will be true. In this case, new size will be forced as the maximum size.</p>
<ul>
<li>Second, when the current available size is less than <code>2</code>.</li>
</ul>
<p>For instance, when the <code>_Oldcapacity</code> is in <code>&#123;0, 1&#125;</code> the expression <code>const size_type _Geometric = _Oldcapacity + _Oldcapacity / 2;</code> will be the same with <code>_Oldcapacity</code>. In this case, new size will be forced as <code>_Newsize</code>, which is passed by <code>_Oldsize + 1</code> in <code>_Emplace_reallocate()</code>.</p>
<table>
<thead>
<tr>
<th><code>_Oldcapacity</code></th>
<th>Calculation</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0 + 0 &#x2F; 2 &#x3D; 0</td>
</tr>
<tr>
<td>1</td>
<td>1 + 1 &#x2F; 2 &#x3D; 1</td>
</tr>
</tbody></table>
<ul>
<li>Third, other cases of the current available size.</li>
</ul>
<p>The <code>_Geometric</code> will have 3&#x2F;2 times of <code>_Oldcapacity</code>. That is why the 3&#x2F;2 times of growth happens in MSVC. And now you understand why new size has to be set by maximum value when the <code>_Oldcapacity</code> is bigger than 2&#x2F;3 times of maximum size.</p>
<p>The <code>resize()</code> has a similar flow. Let us find out.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_CONSTEXPR20_CONTAINER <span class="type">void</span> <span class="title">resize</span><span class="params">(_CRT_GUARDOVERFLOW <span class="type">const</span> size_type _Newsize)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// trim or append value-initialized elements, provide strong guarantee</span></span><br><span class="line">    _Resize(_Newsize, _Value_init_tag&#123;&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Ty2</span>&gt;</span><br><span class="line">_CONSTEXPR20_CONTAINER <span class="type">void</span> _Resize(<span class="type">const</span> size_type _Newsize, <span class="type">const</span> _Ty2&amp; _Val) &#123;</span><br><span class="line">    <span class="comment">// trim or append elements, provide strong guarantee</span></span><br><span class="line">    <span class="keyword">auto</span>&amp; _My_data      = _Mypair._Myval2;</span><br><span class="line">    pointer&amp; _Myfirst   = _My_data._Myfirst;</span><br><span class="line">    pointer&amp; _Mylast    = _My_data._Mylast;</span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> _Oldsize = <span class="built_in">static_cast</span>&lt;size_type&gt;(_Mylast - _Myfirst);</span><br><span class="line">    <span class="keyword">if</span> (_Newsize &lt; _Oldsize) &#123; <span class="comment">// trim</span></span><br><span class="line">        <span class="type">const</span> pointer _Newlast = _Myfirst + _Newsize;</span><br><span class="line">        _Orphan_range(_Newlast, _Mylast);</span><br><span class="line">        _Destroy(_Newlast, _Mylast);</span><br><span class="line">        _Mylast = _Newlast;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (_Newsize &gt; _Oldsize) &#123; <span class="comment">// append</span></span><br><span class="line">        <span class="type">const</span> <span class="keyword">auto</span> _Oldcapacity = <span class="built_in">static_cast</span>&lt;size_type&gt;(_My_data._Myend - _Myfirst);</span><br><span class="line">        <span class="keyword">if</span> (_Newsize &gt; _Oldcapacity) &#123; <span class="comment">// reallocate</span></span><br><span class="line">            _Resize_reallocate(_Newsize, _Val);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">const</span> pointer _Oldlast = _Mylast;</span><br><span class="line">        _Mylast                = _Ufill(_Oldlast, _Newsize - _Oldsize, _Val);</span><br><span class="line">        _Orphan_range(_Oldlast, _Oldlast);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if _Newsize == _Oldsize, do nothing; avoid invalidating iterators</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The <code>resize()</code> can trim or append available memory. Trimming happens when you call <code>resize()</code> with smaller value than current available size. Appending happens when you call <code>resize()</code> with greater value than current available size. We go to <code>_Resize_reallocate()</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Ty2</span>&gt;</span><br><span class="line">_CONSTEXPR20_CONTAINER <span class="type">void</span> _Resize_reallocate(<span class="type">const</span> size_type _Newsize, <span class="type">const</span> _Ty2&amp; _Val) &#123;</span><br><span class="line">    <span class="keyword">if</span> (_Newsize &gt; <span class="built_in">max_size</span>()) &#123;</span><br><span class="line">        _Xlength();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span>&amp; _My_data    = _Mypair._Myval2;</span><br><span class="line">    pointer&amp; _Myfirst = _My_data._Myfirst;</span><br><span class="line">    pointer&amp; _Mylast  = _My_data._Mylast;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> _Oldsize          = <span class="built_in">static_cast</span>&lt;size_type&gt;(_Mylast - _Myfirst);</span><br><span class="line">    <span class="type">const</span> size_type _Newcapacity = _Calculate_growth(_Newsize);</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> pointer _Newvec         = _Getal().<span class="built_in">allocate</span>(_Newcapacity);</span><br><span class="line">    <span class="type">const</span> pointer _Appended_first = _Newvec + _Oldsize;</span><br><span class="line">    pointer _Appended_last        = _Appended_first;</span><br><span class="line"></span><br><span class="line">    _TRY_BEGIN</span><br><span class="line">    _Appended_last = _Ufill(_Appended_first, _Newsize - _Oldsize, _Val);</span><br><span class="line">    _Umove_if_noexcept(_Myfirst, _Mylast, _Newvec);</span><br><span class="line">    _CATCH_ALL</span><br><span class="line">    _Destroy(_Appended_first, _Appended_last);</span><br><span class="line">    _Getal().<span class="built_in">deallocate</span>(_Newvec, _Newcapacity);</span><br><span class="line">    _RERAISE;</span><br><span class="line">    _CATCH_END</span><br><span class="line"></span><br><span class="line">    _Change_array(_Newvec, _Newsize, _Newcapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Oh, Hi. We meet again. It is him, the <code>_Calculate_growth()</code>. Now we know the <code>resize()</code> has a similar logic.</p>
<h3 id="Growth-in-GCC"><a href="#Growth-in-GCC" class="headerlink" title="Growth in GCC"></a><em><code>Growth in GCC</code></em></h3><p>First of all, let us find <code>push_back()</code> in GCC. Suppose we use the example written at MSVC part. You can find the code at <a target="_blank" rel="noopener" href="https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_vector.h">reference #3</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// [23.2.4.3] modifiers</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  @brief  Add data to the end of the %vector.</span></span><br><span class="line"><span class="comment">*  @param  __x  Data to be added.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  This is a typical stack operation.  The function creates an</span></span><br><span class="line"><span class="comment">*  element at the end of the %vector and assigns the given data</span></span><br><span class="line"><span class="comment">*  to it.  Due to the nature of a %vector this operation can be</span></span><br><span class="line"><span class="comment">*  done in constant time if the %vector has preallocated space</span></span><br><span class="line"><span class="comment">*  available.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function"><span class="title">push_back</span><span class="params">(<span class="type">const</span> value_type&amp; __x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;_M_impl._M_finish != <span class="keyword">this</span>-&gt;_M_impl._M_end_of_storage)</span><br><span class="line">    &#123;</span><br><span class="line">        _GLIBCXX_ASAN_ANNOTATE_GROW(<span class="number">1</span>);</span><br><span class="line">        _Alloc_traits::<span class="built_in">construct</span>(<span class="keyword">this</span>-&gt;_M_impl, <span class="keyword">this</span>-&gt;_M_impl._M_finish,</span><br><span class="line">                        __x);</span><br><span class="line">        ++<span class="keyword">this</span>-&gt;_M_impl._M_finish;</span><br><span class="line">        _GLIBCXX_ASAN_ANNOTATE_GREW(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        _M_realloc_insert(<span class="built_in">end</span>(), __x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Here are two cases. First, when an available memory exists. Second, otherwise.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">_Vector_impl_data</span></span><br><span class="line">&#123;</span><br><span class="line">    pointer _M_start;</span><br><span class="line">    pointer _M_finish;</span><br><span class="line">    pointer _M_end_of_storage;</span><br><span class="line"></span><br><span class="line">    _Vector_impl_data() _GLIBCXX_NOEXCEPT</span><br><span class="line">    : _M_start(), _M_finish(), _M_end_of_storage()</span><br><span class="line">    &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> __cplusplus &gt;= 201103L</span></span><br><span class="line">    _Vector_impl_data(_Vector_impl_data&amp;&amp; __x) <span class="keyword">noexcept</span></span><br><span class="line">    : _M_start(__x._M_start), _M_finish(__x._M_finish),</span><br><span class="line">        _M_end_of_storage(__x._M_end_of_storage)</span><br><span class="line">    &#123; __x._M_start = __x._M_finish = __x._M_end_of_storage = <span class="built_in">pointer</span>(); &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="type">void</span></span><br><span class="line">    _M_copy_data(_Vector_impl_data <span class="type">const</span>&amp; __x) _GLIBCXX_NOEXCEPT</span><br><span class="line">    &#123;</span><br><span class="line">        _M_start = __x._M_start;</span><br><span class="line">        _M_finish = __x._M_finish;</span><br><span class="line">        _M_end_of_storage = __x._M_end_of_storage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span></span><br><span class="line">    _M_swap_data(_Vector_impl_data&amp; __x) _GLIBCXX_NOEXCEPT</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Do not use std::swap(_M_start, __x._M_start), etc as it loses</span></span><br><span class="line">        <span class="comment">// information used by TBAA.</span></span><br><span class="line">        _Vector_impl_data __tmp;</span><br><span class="line">        __tmp._M_copy_data(*<span class="keyword">this</span>);</span><br><span class="line">        _M_copy_data(__x);</span><br><span class="line">        __x._M_copy_data(__tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">...</span><br><span class="line">_Vector_impl _M_impl;</span><br></pre></td></tr></table></figure>
<p><code>std::vector</code> in GCC has internal indicators like <code>std::vector</code> in MSVC. So we should focus on <code>_M_realloc_insert()</code> function.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> __cplusplus &gt;= 201103L</span></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Tp, <span class="keyword">typename</span> _Alloc&gt;</span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span>... _Args&gt;</span><br><span class="line">    <span class="type">void</span></span><br><span class="line">    vector&lt;_Tp, _Alloc&gt;::</span><br><span class="line">    _M_realloc_insert(iterator __position, _Args&amp;&amp;... __args)</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Tp, <span class="keyword">typename</span> _Alloc&gt;</span><br><span class="line">    <span class="type">void</span></span><br><span class="line">    vector&lt;_Tp, _Alloc&gt;::</span><br><span class="line">    _M_realloc_insert(iterator __position, <span class="type">const</span> _Tp&amp; __x)</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">const</span> size_type __len =</span><br><span class="line">        _M_check_len(<span class="built_in">size_type</span>(<span class="number">1</span>), <span class="string">&quot;vector::_M_realloc_insert&quot;</span>);</span><br><span class="line">    pointer __old_start = <span class="keyword">this</span>-&gt;_M_impl._M_start;</span><br><span class="line">    pointer __old_finish = <span class="keyword">this</span>-&gt;_M_impl._M_finish;</span><br><span class="line">    <span class="type">const</span> size_type __elems_before = __position - <span class="built_in">begin</span>();</span><br><span class="line">    pointer __new_start(<span class="keyword">this</span>-&gt;_M_allocate(__len));</span><br><span class="line">    pointer __new_finish(__new_start);</span><br><span class="line">    __try</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// The order of the three operations is dictated by the C++11</span></span><br><span class="line">        <span class="comment">// case, where the moves could alter a new element belonging</span></span><br><span class="line">        <span class="comment">// to the existing vector.  This is an issue only for callers</span></span><br><span class="line">        <span class="comment">// taking the element by lvalue ref (see last bullet of C++11</span></span><br><span class="line">        <span class="comment">// [res.on.arguments]).</span></span><br><span class="line">        _Alloc_traits::<span class="built_in">construct</span>(<span class="keyword">this</span>-&gt;_M_impl,</span><br><span class="line">                    __new_start + __elems_before,</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> __cplusplus &gt;= 201103L</span></span><br><span class="line">                    std::forward&lt;_Args&gt;(__args)...);</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">                    __x);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        __new_finish = <span class="built_in">pointer</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> __cplusplus &gt;= 201103L</span></span><br><span class="line">        <span class="keyword">if</span> _GLIBCXX17_CONSTEXPR (_S_use_relocate())</span><br><span class="line">        &#123;</span><br><span class="line">            __new_finish = _S_relocate(__old_start, __position.<span class="built_in">base</span>(),</span><br><span class="line">                        __new_start, _M_get_Tp_allocator());</span><br><span class="line"></span><br><span class="line">            ++__new_finish;</span><br><span class="line"></span><br><span class="line">            __new_finish = _S_relocate(__position.<span class="built_in">base</span>(), __old_finish,</span><br><span class="line">                        __new_finish, _M_get_Tp_allocator());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            __new_finish</span><br><span class="line">        = std::__uninitialized_move_if_noexcept_a</span><br><span class="line">        (__old_start, __position.<span class="built_in">base</span>(),</span><br><span class="line">            __new_start, _M_get_Tp_allocator());</span><br><span class="line"></span><br><span class="line">            ++__new_finish;</span><br><span class="line"></span><br><span class="line">            __new_finish</span><br><span class="line">        = std::__uninitialized_move_if_noexcept_a</span><br><span class="line">        (__position.<span class="built_in">base</span>(), __old_finish,</span><br><span class="line">            __new_finish, _M_get_Tp_allocator());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        __catch(...)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!__new_finish)</span><br><span class="line">        _Alloc_traits::<span class="built_in">destroy</span>(<span class="keyword">this</span>-&gt;_M_impl,</span><br><span class="line">                    __new_start + __elems_before);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        std::_Destroy(__new_start, __new_finish, _M_get_Tp_allocator());</span><br><span class="line">        _M_deallocate(__new_start, __len);</span><br><span class="line">        __throw_exception_again;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> __cplusplus &gt;= 201103L</span></span><br><span class="line">        <span class="keyword">if</span> _GLIBCXX17_CONSTEXPR (!_S_use_relocate())</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    std::_Destroy(__old_start, __old_finish, _M_get_Tp_allocator());</span><br><span class="line">        _GLIBCXX_ASAN_ANNOTATE_REINIT;</span><br><span class="line">        _M_deallocate(__old_start,</span><br><span class="line">            <span class="keyword">this</span>-&gt;_M_impl._M_end_of_storage - __old_start);</span><br><span class="line">        <span class="keyword">this</span>-&gt;_M_impl._M_start = __new_start;</span><br><span class="line">        <span class="keyword">this</span>-&gt;_M_impl._M_finish = __new_finish;</span><br><span class="line">        <span class="keyword">this</span>-&gt;_M_impl._M_end_of_storage = __new_start + __len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Hoo, it is too long. We do not have to look into whole code, but the variable <code>__len</code>. The variable is used for reallocation. And it is set by <code>_M_check_len()</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Called by _M_fill_insert, _M_insert_aux etc.</span></span><br><span class="line">size_type</span><br><span class="line">_M_check_len(size_type __n, <span class="type">const</span> <span class="type">char</span>* __s) <span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">max_size</span>() - <span class="built_in">size</span>() &lt; __n)</span><br><span class="line">        __throw_length_error(__N(__s));</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> size_type __len = <span class="built_in">size</span>() + (std::max)(<span class="built_in">size</span>(), __n);</span><br><span class="line">    <span class="keyword">return</span> (__len &lt; <span class="built_in">size</span>() || __len &gt; <span class="built_in">max_size</span>()) ? <span class="built_in">max_size</span>() : __len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The code throw an error when current size is the same with maximum size because the function was called as <code>_M_check_len(size_type(1), ...)</code>. Otherwise, new size will be set by 2 times of current size. Except for when current size is <code>0</code>.</p>
<table>
<thead>
<tr>
<th>Current size</th>
<th>Calculation</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>1 &#x3D; 0 + max(0, 1)</td>
</tr>
<tr>
<td>1</td>
<td>2 &#x3D; 1 + max(1, 1)</td>
</tr>
<tr>
<td>2</td>
<td>4 &#x3D; 2 + max(2, 1)</td>
</tr>
</tbody></table>
<p>And, returns maximum size when underflow or overflow happens. Otherwise, returns new size calculated as 2 times of current size.</p>
<p>Next, check the <code>resize()</code> in GCC.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  @brief  Resizes the %vector to the specified number of elements.</span></span><br><span class="line"><span class="comment">*  @param  __new_size  Number of elements the %vector should contain.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  This function will %resize the %vector to the specified</span></span><br><span class="line"><span class="comment">*  number of elements.  If the number is smaller than the</span></span><br><span class="line"><span class="comment">*  %vector&#x27;s current size the %vector is truncated, otherwise</span></span><br><span class="line"><span class="comment">*  default constructed elements are appended.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function"><span class="title">resize</span><span class="params">(size_type __new_size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (__new_size &gt; <span class="built_in">size</span>())</span><br><span class="line">        _M_default_append(__new_size - <span class="built_in">size</span>());</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (__new_size &lt; <span class="built_in">size</span>())</span><br><span class="line">        _M_erase_at_end(<span class="keyword">this</span>-&gt;_M_impl._M_start + __new_size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We can see the <code>resize()</code> in GCC also do trimming and appending. (Interestingly, nothing happens when <code>__new_size</code> is equal to current size.) So, we should focus on <code>_M_default_append()</code> function.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Tp, <span class="keyword">typename</span> _Alloc&gt;</span><br><span class="line"><span class="type">void</span></span><br><span class="line">vector&lt;_Tp, _Alloc&gt;::</span><br><span class="line">_M_default_append(size_type __n)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (__n != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">const</span> size_type __size = <span class="built_in">size</span>();</span><br><span class="line">        size_type __navail = <span class="built_in">size_type</span>(<span class="keyword">this</span>-&gt;_M_impl._M_end_of_storage</span><br><span class="line">                        - <span class="keyword">this</span>-&gt;_M_impl._M_finish);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (__size &gt; <span class="built_in">max_size</span>() || __navail &gt; <span class="built_in">max_size</span>() - __size)</span><br><span class="line">            __builtin_unreachable();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (__navail &gt;= __n)</span><br><span class="line">        &#123;</span><br><span class="line">            _GLIBCXX_ASAN_ANNOTATE_GROW(__n);</span><br><span class="line">            <span class="keyword">this</span>-&gt;_M_impl._M_finish =</span><br><span class="line">                std::__uninitialized_default_n_a(<span class="keyword">this</span>-&gt;_M_impl._M_finish,</span><br><span class="line">                            __n, _M_get_Tp_allocator());</span><br><span class="line">            _GLIBCXX_ASAN_ANNOTATE_GREW(__n);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">const</span> size_type __len =</span><br><span class="line">                _M_check_len(__n, <span class="string">&quot;vector::_M_default_append&quot;</span>);</span><br><span class="line">            pointer __new_start(<span class="keyword">this</span>-&gt;_M_allocate(__len));</span><br><span class="line">            <span class="keyword">if</span> _GLIBCXX17_CONSTEXPR (_S_use_relocate())</span><br><span class="line">            &#123;</span><br><span class="line">            __try</span><br><span class="line">            &#123;</span><br><span class="line">                std::__uninitialized_default_n_a(__new_start + __size,</span><br><span class="line">                    __n, _M_get_Tp_allocator());</span><br><span class="line">            &#125;</span><br><span class="line">            __catch(...)</span><br><span class="line">            &#123;</span><br><span class="line">                _M_deallocate(__new_start, __len);</span><br><span class="line">                __throw_exception_again;</span><br><span class="line">            &#125;</span><br><span class="line">            _S_relocate(<span class="keyword">this</span>-&gt;_M_impl._M_start, <span class="keyword">this</span>-&gt;_M_impl._M_finish,</span><br><span class="line">                    __new_start, _M_get_Tp_allocator());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            pointer __destroy_from = <span class="built_in">pointer</span>();</span><br><span class="line">            __try</span><br><span class="line">            &#123;</span><br><span class="line">                std::__uninitialized_default_n_a(__new_start + __size,</span><br><span class="line">                    __n, _M_get_Tp_allocator());</span><br><span class="line">                __destroy_from = __new_start + __size;</span><br><span class="line">                std::__uninitialized_move_if_noexcept_a(</span><br><span class="line">                    <span class="keyword">this</span>-&gt;_M_impl._M_start, <span class="keyword">this</span>-&gt;_M_impl._M_finish,</span><br><span class="line">                    __new_start, _M_get_Tp_allocator());</span><br><span class="line">            &#125;</span><br><span class="line">            __catch(...)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (__destroy_from)</span><br><span class="line">                    std::_Destroy(__destroy_from, __destroy_from + __n,</span><br><span class="line">                        _M_get_Tp_allocator());</span><br><span class="line">                _M_deallocate(__new_start, __len);</span><br><span class="line">                __throw_exception_again;</span><br><span class="line">            &#125;</span><br><span class="line">            std::_Destroy(<span class="keyword">this</span>-&gt;_M_impl._M_start, <span class="keyword">this</span>-&gt;_M_impl._M_finish,</span><br><span class="line">                _M_get_Tp_allocator());</span><br><span class="line">        &#125;</span><br><span class="line">            _GLIBCXX_ASAN_ANNOTATE_REINIT;</span><br><span class="line">            _M_deallocate(<span class="keyword">this</span>-&gt;_M_impl._M_start,</span><br><span class="line">                <span class="keyword">this</span>-&gt;_M_impl._M_end_of_storage</span><br><span class="line">                - <span class="keyword">this</span>-&gt;_M_impl._M_start);</span><br><span class="line">            <span class="keyword">this</span>-&gt;_M_impl._M_start = __new_start;</span><br><span class="line">            <span class="keyword">this</span>-&gt;_M_impl._M_finish = __new_start + __size + __n;</span><br><span class="line">            <span class="keyword">this</span>-&gt;_M_impl._M_end_of_storage = __new_start + __len;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It is long one, too. What is <code>__navail</code> ? It seems meaning of <code>Number of AVAILable memory</code>, not the <code>Not AVAILable memory</code>. So, we can see the memory is reused when <code>if (__navail &gt;= __n)</code> is true. Otherwise, reallocation happens. Oh, Hi. We meet <code>_M_check_len()</code> again. Then, new size will be 2 times of current size.</p>
<h3 id="Wrap-up"><a href="#Wrap-up" class="headerlink" title="Wrap-up"></a><em><code>Wrap-up</code></em></h3><p>Common</p>
<ul>
<li>Try to recycle memory as possible as can. (e.g. reuse available memory in <code>push_back()</code> logic.)</li>
<li>Care about underflow and overflow.</li>
<li>Have internal indicators for <code>&#123;First, Current, End&#125;</code><ul>
<li>Currently allocated size &#x3D; <code>End - First</code></li>
<li>Currently used size &#x3D; <code>Current - First</code></li>
<li>Currently available size &#x3D; <code>End - Current</code></li>
</ul>
</li>
</ul>
<p>MSVC</p>
<ul>
<li>Growth happens with 3&#x2F;2 times of amount. (in normal case)</li>
</ul>
<p>GCC</p>
<ul>
<li>Growth happens with 2 times of amount. (in normal case)</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2021/05/16/cpp-std-vector-growth/" data-id="cmfidx74i000pcsqm5m0l08wm" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2021/05/16/cpp-std-vector-growth/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CPP/" rel="tag">CPP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GCC/" rel="tag">GCC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MSVC/" rel="tag">MSVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/STL/" rel="tag">STL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-difference-between-build-cs-and-target-cs" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/04/07/difference-between-build-cs-and-target-cs/" class="article-date">
  <time datetime="2021-04-07T13:52:46.000Z" itemprop="datePublished">2021-04-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/04/07/difference-between-build-cs-and-target-cs/">Differences between Build.cs and Target.cs in UnrealEngine</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>this post covers<ul>
<li>what does <code>Build.cs</code> do</li>
<li>what does <code>Target.cs</code> do</li>
<li>differences between <code>Build.cs</code> and <code>Target.cs</code></li>
</ul>
</li>
<li>environment<ul>
<li>Unreal Engine 4 <code>ver. 4.25</code></li>
<li>Visual Studio 2019 <code>ver. 16.9.1</code></li>
</ul>
</li>
<li>reference<ol>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-US/ProductionPipelines/BuildTools/UnrealBuildTool/ModuleFiles/index.html">https://docs.unrealengine.com/en-US/ProductionPipelines/BuildTools/UnrealBuildTool/ModuleFiles/index.html</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-US/ProductionPipelines/BuildTools/UnrealBuildTool/TargetFiles/index.html">https://docs.unrealengine.com/en-US/ProductionPipelines/BuildTools/UnrealBuildTool/TargetFiles/index.html</a></li>
</ol>
</li>
</ul>
<h3 id="UnrealBuildTool-ModuleRules"><a href="#UnrealBuildTool-ModuleRules" class="headerlink" title="UnrealBuildTool.ModuleRules"></a><em><code>UnrealBuildTool.ModuleRules</code></em></h3><p>UnrealEngine provides its own module system, which is absolutely different with <a target="_blank" rel="noopener" href="https://en.cppreference.com/w/cpp/language/modules">CPP 20 Module</a>. The class <code>UnrealBuildTool.ModuleRules</code> is for the module system and it is written by <code>[ModuleName].Build.cs</code>. You can decide what to include for creating output files (&#x3D; DLL). For example, <code>ShaderCompileWorker</code> project has the module rules below:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Programs/ShaderCompileWorker/ShaderCompileWorker.Build.cs</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ShaderCompileWorker</span> : <span class="title">ModuleRules</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ShaderCompileWorker</span>(<span class="params">ReadOnlyTargetRules Target</span>) : <span class="title">base</span>(<span class="params">Target</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		PrivateDependencyModuleNames.AddRange(</span><br><span class="line">			<span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line">				<span class="string">&quot;Core&quot;</span>,</span><br><span class="line">				<span class="string">&quot;Projects&quot;</span>,</span><br><span class="line">				<span class="string">&quot;RenderCore&quot;</span>,</span><br><span class="line">				<span class="string">&quot;SandboxFile&quot;</span>,</span><br><span class="line">				<span class="string">&quot;TargetPlatform&quot;</span>,</span><br><span class="line">				<span class="string">&quot;ApplicationCore&quot;</span>,</span><br><span class="line">				<span class="string">&quot;TraceLog&quot;</span>,</span><br><span class="line">				<span class="string">&quot;ShaderCompilerCommon&quot;</span></span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (Target.Platform == UnrealTargetPlatform.Linux)</span><br><span class="line">		&#123;</span><br><span class="line">			PrivateDependencyModuleNames.AddRange(</span><br><span class="line">			<span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line">				<span class="string">&quot;NetworkFile&quot;</span>,</span><br><span class="line">				<span class="string">&quot;PakFile&quot;</span>,</span><br><span class="line">				<span class="string">&quot;StreamingFile&quot;</span>,</span><br><span class="line">				&#125;);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		PrivateIncludePathModuleNames.AddRange(</span><br><span class="line">			<span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line">				<span class="string">&quot;Launch&quot;</span>,</span><br><span class="line">				<span class="string">&quot;TargetPlatform&quot;</span>,</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">		PrivateIncludePaths.Add(<span class="string">&quot;Runtime/Launch/Private&quot;</span>);      <span class="comment">// For LaunchEngineLoop.cpp include</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// Include D3D compiler binaries</span></span><br><span class="line">		<span class="built_in">string</span> EngineDir = Path.GetFullPath(Target.RelativeEnginePath);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (Target.Platform == UnrealTargetPlatform.Win32)</span><br><span class="line">		&#123;</span><br><span class="line">			RuntimeDependencies.Add(EngineDir + <span class="string">&quot;Binaries/ThirdParty/Windows/DirectX/x86/d3dcompiler_47.dll&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (Target.Platform == UnrealTargetPlatform.Win64)</span><br><span class="line">		&#123;</span><br><span class="line">			RuntimeDependencies.Add(EngineDir + <span class="string">&quot;Binaries/ThirdParty/Windows/DirectX/x64/d3dcompiler_47.dll&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2021/04/07/difference-between-build-cs-and-target-cs/07.png" class="">
</br>
<img src="/2021/04/07/difference-between-build-cs-and-target-cs/08.png" class="">

<p>There are several libraries such as <code>Core</code>, <code>Projects</code>, <code>RenderCore</code> and so on. We can also find them in <code>Binaries</code> folder like below:<br>(FYI, the <code>ShaderCompileWorker.exe</code> is created with <code>ShaderCompileWorker.Target.cs</code> not the <code>ShaderCompileWorker.Build.cs</code>.)</p>
<img src="/2021/04/07/difference-between-build-cs-and-target-cs/04.png" class="">

<p>In other words, output files are created with the name containing its module when you add corresponding libraries to module rules (ex: <code>[TargetName]-[ModuleName]-[ConfigurationName].dll</code>). Additionally, UnrealEngine re-uses them as possible. Suppose your project need some libraries already included on engine side. In this situation, UnrealEngine does not create output files for the duplicated libraries included in your project. Instead of that, UnrealEngine leaves some meta file describes what the project included.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> UnrealBuildTool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ThirdPerson_4_25</span> : <span class="title">ModuleRules</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ThirdPerson_4_25</span>(<span class="params">ReadOnlyTargetRules Target</span>) : <span class="title">base</span>(<span class="params">Target</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		PCHUsage = PCHUsageMode.UseExplicitOrSharedPCHs;</span><br><span class="line"></span><br><span class="line">		PublicDependencyModuleNames.AddRange(<span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;Core&quot;</span>, <span class="string">&quot;CoreUObject&quot;</span>, <span class="string">&quot;Engine&quot;</span>, <span class="string">&quot;InputCore&quot;</span>, <span class="string">&quot;HeadMountedDisplay&quot;</span> &#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2021/04/07/difference-between-build-cs-and-target-cs/05.png" class="">

<p>This is a generated module rules based on third person template. This module rules contains <code>CoreUObject</code> library but we cannot find it in <code>Binaries</code> folder. Let us see the <code>ThirdPerson_4_25Editor.target</code> file.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/Project/Binaries/Win64/ThirdPerson_4_25Editor.target</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">&quot;BuildProducts&quot;: [</span><br><span class="line">	...</span><br><span class="line">	&#123;</span><br><span class="line">		&quot;Path&quot;: &quot;$(EngineDir)/Binaries/Win64/UE4Editor-CoreUObject.dll&quot;,</span><br><span class="line">		&quot;Type&quot;: &quot;DynamicLibrary&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		&quot;Path&quot;: &quot;$(EngineDir)/Binaries/Win64/UE4Editor-CoreUObject.pdb&quot;,</span><br><span class="line">		&quot;Type&quot;: &quot;SymbolFile&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Programs/UnrealBuildTool/System/TargetReceipt.cs</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// Write the receipt to disk.</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;Location&quot;&gt;Output filename&lt;/param&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;EngineDir&quot;&gt;Engine directory for expanded paths&lt;/param&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="type">void</span> <span class="title">Write</span><span class="params">(FileReference Location, DirectoryReference EngineDir)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	...</span><br><span class="line">	Writer.<span class="built_in">WriteArrayStart</span>(<span class="string">&quot;BuildProducts&quot;</span>);</span><br><span class="line">	foreach (BuildProduct BuildProduct in BuildProducts)</span><br><span class="line">	&#123;</span><br><span class="line">		Writer.<span class="built_in">WriteObjectStart</span>();</span><br><span class="line">		Writer.<span class="built_in">WriteValue</span>(<span class="string">&quot;Path&quot;</span>, <span class="built_in">InsertPathVariables</span>(BuildProduct.Path, EngineDir, ProjectDir));</span><br><span class="line">		Writer.<span class="built_in">WriteValue</span>(<span class="string">&quot;Type&quot;</span>, BuildProduct.Type.<span class="built_in">ToString</span>());</span><br><span class="line">		Writer.<span class="built_in">WriteObjectEnd</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	Writer.<span class="built_in">WriteArrayEnd</span>();</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>For more details about the module system, visit <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-US/ProductionPipelines/BuildTools/UnrealBuildTool/ModuleFiles/index.html">reference #1</a>.</p>
<h3 id="UnrealBuildTool-TargetRules"><a href="#UnrealBuildTool-TargetRules" class="headerlink" title="UnrealBuildTool.TargetRules"></a><em><code>UnrealBuildTool.TargetRules</code></em></h3><p>UnrealEngine provides its own target system, which makes you can create an executable. There are various target configurations such as <code>Editor</code>, <code>Client</code> and <code>Server</code>. The class <code>UnrealBuildTool.TargetRules</code> is for the target system and it is written by <code>[TargetName].Target.cs</code>. You can decide which modules to include for a certain target. For example, <code>UE4</code> project has the target rules for editor below:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> UnrealBuildTool;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UE4EditorTarget</span> : <span class="title">TargetRules</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">UE4EditorTarget</span>(<span class="params"> TargetInfo Target </span>) : <span class="title">base</span>(<span class="params">Target</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		Type = TargetType.Editor;</span><br><span class="line">		BuildEnvironment = TargetBuildEnvironment.Shared;</span><br><span class="line">		bBuildAllModules = <span class="literal">true</span>;</span><br><span class="line">		ExtraModuleNames.Add(<span class="string">&quot;UE4Game&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</br>

<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExtraModuleNames.Add(<span class="string">&quot;UE4Game&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>The target rules specifies <code>UE4Game</code> module included, which is located in <code>Engine/Source/Runtime/UE4Game</code>. So, output files for editor are consist of modules in <code>UE4Game</code>.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> UnrealBuildTool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UE4Game</span> : <span class="title">ModuleRules</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">UE4Game</span>(<span class="params">ReadOnlyTargetRules Target</span>) : <span class="title">base</span>(<span class="params">Target</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		PrivateDependencyModuleNames.Add(<span class="string">&quot;Core&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (Target.Platform == UnrealTargetPlatform.IOS || Target.Platform == UnrealTargetPlatform.TVOS)</span><br><span class="line">		&#123;</span><br><span class="line">			PrivateDependencyModuleNames.AddRange(<span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;Core&quot;</span>, <span class="string">&quot;CoreUObject&quot;</span>, <span class="string">&quot;Engine&quot;</span> &#125;);</span><br><span class="line">			<span class="keyword">if</span> (Target.Platform == UnrealTargetPlatform.IOS)</span><br><span class="line">			&#123;</span><br><span class="line">				DynamicallyLoadedModuleNames.Add(<span class="string">&quot;IOSAdvertising&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (Target.Platform == UnrealTargetPlatform.Android)</span><br><span class="line">		&#123;</span><br><span class="line">			PrivateDependencyModuleNames.AddRange(<span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;Core&quot;</span>, <span class="string">&quot;CoreUObject&quot;</span>, <span class="string">&quot;Engine&quot;</span> &#125;);</span><br><span class="line">			DynamicallyLoadedModuleNames.Add(<span class="string">&quot;AndroidAdvertising&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</br>

<img src="/2021/04/07/difference-between-build-cs-and-target-cs/09.png" class="">

<p>Yes, they are. :)</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Type = TargetType.Editor;</span><br></pre></td></tr></table></figure>

<p><code>UnrealBuildTool.TargetRules</code> has a field <code>Type</code>.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Programs/UnrealBuildTool/Configuration/TargetRules.cs</span><br><span class="line"></span><br><span class="line">...csharp</span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> TargetRules is a data structure that contains the rules for defining a target (application/executable)</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">TargetRules</span></span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> The type of target.</span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">global</span>::UnrealBuildTool.TargetType Type = <span class="keyword">global</span>::UnrealBuildTool.TargetType.Game;</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>The field is used for branching target-specific features such as build configuration. For example, UnrealEngine manages target configurations as <code>enum</code>.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Programs/UnrealBuildTool/Configuration/UEBuildTarget.cs</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> The type of configuration a target can be built for</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> UnrealTargetConfiguration</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> Unknown</span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">	Unknown,</span><br><span class="line"></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> Debug configuration</span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">	Debug,</span><br><span class="line"></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> DebugGame configuration; equivalent to development, but with optimization disabled for game modules</span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">	DebugGame,</span><br><span class="line"></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> Development configuration</span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">	Development,</span><br><span class="line"></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> Shipping configuration</span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">	Shipping,</span><br><span class="line"></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> Test configuration</span></span><br><span class="line">	<span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">	Test,</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>Unlike others, the editor target support only 3 types of target configuration. <code>Debug</code>, <code>DebugGame</code> and <code>Development</code>.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Programs/UnrealBuildTool/Configuration/TargetRules.cs</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Gets a list of configurations that this target supports</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>Array of configurations that the target supports<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">internal</span> UnrealTargetConfiguration[] <span class="title">GetSupportedConfigurations</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// Otherwise take the SupportedConfigurationsAttribute from the first type in the inheritance chain that supports it</span></span><br><span class="line">	<span class="keyword">for</span> (Type CurrentType = GetType(); CurrentType != <span class="literal">null</span>; CurrentType = CurrentType.BaseType)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">object</span>[] Attributes = CurrentType.GetCustomAttributes(<span class="keyword">typeof</span>(SupportedConfigurationsAttribute), <span class="literal">false</span>);</span><br><span class="line">		<span class="keyword">if</span> (Attributes.Length &gt; <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> Attributes.OfType&lt;SupportedConfigurationsAttribute&gt;().SelectMany(x =&gt; x.Configurations).Distinct().ToArray();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Otherwise, get the default for the target type</span></span><br><span class="line">	<span class="keyword">if</span> (Type == TargetType.Editor)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span>[] &#123; UnrealTargetConfiguration.Debug, UnrealTargetConfiguration.DebugGame, UnrealTargetConfiguration.Development &#125;;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> ((UnrealTargetConfiguration[])Enum.GetValues(<span class="keyword">typeof</span>(UnrealTargetConfiguration))).Where(x =&gt; x != UnrealTargetConfiguration.Unknown).ToArray();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

</br>

<img src="/2021/04/07/difference-between-build-cs-and-target-cs/10.png" class="">

<p>For more details, visit <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-US/ProductionPipelines/BuildTools/UnrealBuildTool/TargetFiles/index.html">reference #2</a>.</p>
<h3 id="ModuleName-Build-cs"><a href="#ModuleName-Build-cs" class="headerlink" title="[ModuleName].Build.cs"></a><em><code>[ModuleName].Build.cs</code></em></h3><p>Each module has its own <code>Build.cs</code> file. For example, a <code>[ProjectName].Build.cs</code> will be generated when you create new project with cpp enabled. Because UnrealEngine makes a default module that has the same name with project. (Exactly, <code>Build.cs</code> and <code>Target.cs</code> files are copied from template in general cases.)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Editor/GameProjectGeneration/Private/GameProjectUtils.<span class="function">cpp</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">GameProjectUtils::CreateProject</span><span class="params">(<span class="type">const</span> FProjectInformation&amp; InProjectInfo, FText&amp; OutFailReason, FText&amp; OutFailLog, TArray&lt;FString&gt;* OutCreatedFiles)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> ( !<span class="built_in">IsValidProjectFileForCreation</span>(InProjectInfo.ProjectFilename, OutFailReason) )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">FScopedSlowTask <span class="title">SlowTask</span><span class="params">(<span class="number">0</span>, LOCTEXT( <span class="string">&quot;CreatingProjectStatus&quot;</span>, <span class="string">&quot;Creating project...&quot;</span> ))</span></span>;</span><br><span class="line">	SlowTask.<span class="built_in">MakeDialog</span>();</span><br><span class="line"></span><br><span class="line">	TOptional&lt;FGuid&gt; ProjectID;</span><br><span class="line">	FString TemplateName;</span><br><span class="line">	<span class="keyword">if</span> ( InProjectInfo.TemplateFile.<span class="built_in">IsEmpty</span>() )</span><br><span class="line">	&#123;</span><br><span class="line">		ProjectID = <span class="built_in">GenerateProjectFromScratch</span>(InProjectInfo, OutFailReason, OutFailLog);</span><br><span class="line">		TemplateName = InProjectInfo.bShouldGenerateCode ? <span class="built_in">TEXT</span>(<span class="string">&quot;Basic Code&quot;</span>) : <span class="built_in">TEXT</span>(<span class="string">&quot;Blank&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		ProjectID = <span class="built_in">CreateProjectFromTemplate</span>(InProjectInfo, OutFailReason, OutFailLog, OutCreatedFiles);</span><br><span class="line">		TemplateName = FPaths::<span class="built_in">GetBaseFilename</span>(InProjectInfo.TemplateFile);</span><br><span class="line">	&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Editor/GameProjectGeneration/Private/GameProjectUtils.<span class="function">cpp</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">TOptional&lt;FGuid&gt; <span class="title">GameProjectUtils::CreateProjectFromTemplate</span><span class="params">(<span class="type">const</span> FProjectInformation&amp; InProjectInfo, FText&amp; OutFailReason, FText&amp; OutFailLog, TArray&lt;FString&gt;* OutCreatedFiles)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Discover and copy all files in the src folder to the destination, excluding a few files and folders</span></span><br><span class="line">	TArray&lt;FString&gt; FilesToCopy;</span><br><span class="line">	TArray&lt;FString&gt; FilesThatNeedContentsReplaced;</span><br><span class="line">	TMap&lt;FString, FString&gt; ClassRenames;</span><br><span class="line">	IFileManager::<span class="built_in">Get</span>().<span class="built_in">FindFilesRecursive</span>(FilesToCopy, *SrcFolder, <span class="built_in">TEXT</span>(<span class="string">&quot;*&quot;</span>), <span class="comment">/*Files=*/</span><span class="literal">true</span>, <span class="comment">/*Directories=*/</span><span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Perform the copy</span></span><br><span class="line">	<span class="type">const</span> FString DestFilename = DestFolder / DestFileSubpathWithoutFilename + DestBaseFilename + <span class="built_in">TEXT</span>(<span class="string">&quot;.&quot;</span>) + FileExtension;</span><br><span class="line">	<span class="keyword">if</span> ( IFileManager::<span class="built_in">Get</span>().<span class="built_in">Copy</span>(*DestFilename, *SrcFilename) == COPY_OK )</span><br><span class="line">	&#123;</span><br><span class="line">		CreatedFiles.<span class="built_in">Add</span>(DestFilename);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ( ReplacementsInFilesExtensions.<span class="built_in">Contains</span>(FileExtension) )</span><br><span class="line">		&#123;</span><br><span class="line">			FilesThatNeedContentsReplaced.<span class="built_in">Add</span>(DestFilename);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Allow project template to extract class renames from this file copy</span></span><br><span class="line">		<span class="keyword">if</span> (FPaths::<span class="built_in">GetBaseFilename</span>(SrcFilename) != FPaths::<span class="built_in">GetBaseFilename</span>(DestFilename)</span><br><span class="line">			&amp;&amp; TemplateDefs-&gt;<span class="built_in">IsClassRename</span>(DestFilename, SrcFilename, FileExtension))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// Looks like a UObject file!</span></span><br><span class="line">			ClassRenames.<span class="built_in">Add</span>(FPaths::<span class="built_in">GetBaseFilename</span>(SrcFilename), FPaths::<span class="built_in">GetBaseFilename</span>(DestFilename));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<br/>
<img src="/2021/04/07/difference-between-build-cs-and-target-cs/02.png" class="">
<br/>
<img src="/2021/04/07/difference-between-build-cs-and-target-cs/01.png" class="">

<p><em>WHEN YOU CREATE A PROJECT ITS NAME OF <code>ThridPerson_4_25</code> FROM THIRD PERSON TEMPLATE</em></p>
<p>Saying that again, <code>[ModuleName].Build.cs</code> defines the dependencies for building its module. So, every module must have its own <code>[ModuleName].Build.cs</code> file and every module has its own <code>[ModuleName].Build.cs</code> will generate a DLL when you build the project.</p>
<p>Module generation can be done by manipulating some CSharp scripts (<code>Build.cs</code> and <code>Target.cs</code> files). You can find how at <a target="_blank" rel="noopener" href="https://www.ue4community.wiki/creating-cpp-module-oshdsg2t">https://www.ue4community.wiki/creating-cpp-module-oshdsg2t</a>.</p>
<h3 id="TargetName-Target-cs"><a href="#TargetName-Target-cs" class="headerlink" title="[TargetName].Target.cs"></a><em><code>[TargetName].Target.cs</code></em></h3><p>While every module must have a <code>Build.cs</code> file, but every module do not have to have a <code>Target.cs</code> file. Some modules have only <code>Build.cs</code> file. It means the modules should be used for library not a standalone. The <code>AIModule</code> is a good example. The module has only <code>Build.cs</code> as it is written for providing a support to make AI.</p>
<img src="/2021/04/07/difference-between-build-cs-and-target-cs/11.png" class="">
</br>
<img src="/2021/04/07/difference-between-build-cs-and-target-cs/12.png" class="">
</br>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Editor/UnrealEd/UnrealEd.Build.cs</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">PublicIncludePathModuleNames.AddRange(</span><br><span class="line">	<span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line">		<span class="string">&quot;AssetRegistry&quot;</span>,</span><br><span class="line">		<span class="string">&quot;AssetTagsEditor&quot;</span>,</span><br><span class="line">		<span class="string">&quot;CollectionManager&quot;</span>,</span><br><span class="line">		<span class="string">&quot;BlueprintGraph&quot;</span>,</span><br><span class="line">		<span class="string">&quot;AddContentDialog&quot;</span>,</span><br><span class="line">		<span class="string">&quot;MeshUtilities&quot;</span>,</span><br><span class="line">		<span class="string">&quot;AssetTools&quot;</span>,</span><br><span class="line">		<span class="string">&quot;KismetCompiler&quot;</span>,</span><br><span class="line">		<span class="string">&quot;NavigationSystem&quot;</span>,</span><br><span class="line">		<span class="string">&quot;GameplayTasks&quot;</span>,</span><br><span class="line">		<span class="string">&quot;AIModule&quot;</span>,</span><br><span class="line">		<span class="string">&quot;Engine&quot;</span>,</span><br><span class="line">		<span class="string">&quot;SourceControl&quot;</span>,</span><br><span class="line">	&#125;</span><br><span class="line">);</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Runtime/Engine/Engine.Build.cs</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span> (Target.bBuildEditor == <span class="literal">true</span>)</span><br><span class="line">&#123;</span><br><span class="line">	PublicDependencyModuleNames.AddRange(</span><br><span class="line">		<span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line">			<span class="string">&quot;UnrealEd&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Kismet&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">	);	<span class="comment">// @todo api: Only public because of WITH_EDITOR and UNREALED_API</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Developer/TargetPlatform/TargetPlatform.Build.cs</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">PrivateIncludePathModuleNames.Add(<span class="string">&quot;Engine&quot;</span>);</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Runtime/Core/Core.Build.cs</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">PrivateIncludePathModuleNames.AddRange(</span><br><span class="line">	<span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line">		<span class="string">&quot;TargetPlatform&quot;</span>,</span><br><span class="line">		<span class="string">&quot;DerivedDataCache&quot;</span>,</span><br><span class="line">		<span class="string">&quot;InputDevice&quot;</span>,</span><br><span class="line">		<span class="string">&quot;Analytics&quot;</span>,</span><br><span class="line">		<span class="string">&quot;RHI&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">);</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Runtime/UE4Game/UE4Game.Build.cs</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">PrivateDependencyModuleNames.Add(<span class="string">&quot;Core&quot;</span>);</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/UE4Editor.Target.cs</span><br><span class="line"></span><br><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> UnrealBuildTool;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UE4EditorTarget</span> : <span class="title">TargetRules</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">UE4EditorTarget</span>(<span class="params"> TargetInfo Target </span>) : <span class="title">base</span>(<span class="params">Target</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		Type = TargetType.Editor;</span><br><span class="line">		BuildEnvironment = TargetBuildEnvironment.Shared;</span><br><span class="line">		bBuildAllModules = <span class="literal">true</span>;</span><br><span class="line">		ExtraModuleNames.Add(<span class="string">&quot;UE4Game&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Sometimes, some modules should not be included on certain target configurations. For instance, only editor features should not be included in client or server target configuration. In the need, we can branch for ease like below:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Engine/Source/Developer/SlateReflector/SlateReflector.Build.cs</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="comment">// Editor builds include SessionServices to populate the remote target drop-down for remote widget snapshots</span></span><br><span class="line"><span class="keyword">if</span> (Target.Type == TargetType.Editor)</span><br><span class="line">&#123;</span><br><span class="line">	PublicDefinitions.Add(<span class="string">&quot;SLATE_REFLECTOR_HAS_SESSION_SERVICES=1&quot;</span>);</span><br><span class="line"></span><br><span class="line">	PrivateDependencyModuleNames.AddRange(</span><br><span class="line">		<span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line">			<span class="string">&quot;PropertyEditor&quot;</span>,</span><br><span class="line">		&#125;</span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line">	PrivateIncludePathModuleNames.AddRange(</span><br><span class="line">		<span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line">			<span class="string">&quot;SessionServices&quot;</span>,</span><br><span class="line">		&#125;</span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line">	DynamicallyLoadedModuleNames.AddRange(</span><br><span class="line">		<span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line">			<span class="string">&quot;SessionServices&quot;</span>,</span><br><span class="line">		&#125;</span><br><span class="line">	);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	PublicDefinitions.Add(<span class="string">&quot;SLATE_REFLECTOR_HAS_SESSION_SERVICES=0&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>We can use <code>Widget Relfector</code> only at editor target configuration. As we see, non-editor target will not contain the reflector feature. One more step, we can force to block generating projects by throwing an exception like this.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/Engine/Source/Editor/UnrealEd/UnrealEd.Build.cs</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnrealEd</span> : <span class="title">ModuleRules</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">UnrealEd</span>(<span class="params">ReadOnlyTargetRules Target</span>) : <span class="title">base</span>(<span class="params">Target</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(Target.Type != TargetType.Editor)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> BuildException(<span class="string">&quot;Unable to instantiate UnrealEd module for non-editor targets.&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="Wrap-Up"><a href="#Wrap-Up" class="headerlink" title="Wrap-Up"></a><em>Wrap-Up</em></h3><p><code>Build.cs</code> and <code>Target.cs</code> are different with each other on why they are used.</p>
<ul>
<li><code>Build.cs</code><ul>
<li>defines how the module should be created.</li>
<li>type of module output file is usually <code>.dll</code>.</li>
<li>every module must have its own <code>[ModuleName].Build.cs</code>.</li>
<li>there can be duplicated output files if the module is included in multiple <code>Target.cs</code> files or if build configurations are different on each other.<ul>
<li>ex: <code>Target1-ModuleA.dll</code>, <code>Target2-ModuleA.dll</code>, <code>Target2-ModuleA-Win64-Debug.dll</code> and etc.</li>
</ul>
</li>
</ul>
</li>
<li><code>Target.cs</code><ul>
<li>defines how the executable should be created.</li>
<li>type of target output file is usually <code>.exe</code>.</li>
<li>user can write <code>[TargetName].Target.cs</code> and modules can be included selectively.</li>
<li>there can be duplicated output files if build configurations are different on each other.<ul>
<li>ex: <code>UE4Editor.exe</code>, <code>UE4Editor-Win64-Debug.exe</code> and etc.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Logically, a target is above one than a module.</p>
<img src="/2021/04/07/difference-between-build-cs-and-target-cs/13.png" class="">
      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2021/04/07/difference-between-build-cs-and-target-cs/" data-id="cmfidx74i000rcsqma24e5p0u" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2021/04/07/difference-between-build-cs-and-target-cs/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-unreal-engine-natvis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/01/unreal-engine-natvis/" class="article-date">
  <time datetime="2021-03-01T13:10:07.000Z" itemprop="datePublished">2021-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/01/unreal-engine-natvis/">Natvis in UnrealEngine</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>this post covers<ul>
<li>what is Natvis</li>
<li>how to write custom Natvis visualization</li>
<li>customization in UnrealEngine</li>
</ul>
</li>
<li>environment<ul>
<li>Unreal Engine 4 <code>ver. 4.25</code></li>
<li>Visual Studio 2019 <code>ver. 16.8.1</code></li>
</ul>
</li>
<li>reference<ol>
<li><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/visualstudio/debugger/create-custom-views-of-native-objects?view=vs-2019">https://docs.microsoft.com/en-us/visualstudio/debugger/create-custom-views-of-native-objects?view=vs-2019</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2015/debugger/format-specifiers-in-cpp?view=vs-2015&redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2015/debugger/format-specifiers-in-cpp?view=vs-2015&redirectedfrom=MSDN</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ibm.com/support/knowledgecenter/SSEQTP_liberty/com.ibm.websphere.wlp.doc/ae/rwlp_xml_escape.html">https://www.ibm.com/support/knowledgecenter/SSEQTP_liberty&#x2F;com.ibm.websphere.wlp.doc&#x2F;ae&#x2F;rwlp_xml_escape.html</a></li>
</ol>
</li>
</ul>
<h1 id="NATive-type-VISualization"><a href="#NATive-type-VISualization" class="headerlink" title="NATive type VISualization"></a>NATive type VISualization</h1><p>According to <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/visualstudio/debugger/create-custom-views-of-native-objects?view=vs-2019">reference #1</a>, the name of Natvis framework means visualization of native types. It can help your debugging with more plentiful visibility, and sometimes support mutiple environments that have a different size on the same data type. Suppose you want to make a string class storing its text as UTF-32 or something custom format, it should not be displayed well because it is not kind of ASCII. Though, do you want to see the data (in this case, the text) at <code>Watch</code> or <code>Local</code> viewport ? Then you should implement your own xml for custom Natvis visualization.</p>
<p><em>SCREENSHOT WITHOUT CUSTOM NATVIS</em></p>
<img src="/2021/03/01/unreal-engine-natvis/01.png" class="">

<p><em>SCREENSHOT WITH CUSTOM NATVIS</em></p>
<img src="/2021/03/01/unreal-engine-natvis/02.png" class="">

<h1 id="Basic-syntax-and-usage"><a href="#Basic-syntax-and-usage" class="headerlink" title="Basic syntax and usage"></a>Basic syntax and usage</h1><p>The custom visualizer has XML syntax and it would be comfortable than a sole programming language. Just create a file of any name with <code>.natvis</code> extension and locate at the directory <code>Documents/Visual Studio 2019/Visualizers</code>. The Visual Studio IDE will find all natvis files at there and parse them. At first after you create the file, you need the tag <code>AutoVisualizer</code>.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">AutoVisualizer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">AutoVisualizer</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>But you may meet the error like below with our current visualizer. (You should turn on an option for showing errors related to Natvis. Manipulate the option at <code>Tools/Options/Debugging/Output Window/General OutputSettings/Natvisdiagnostic messages</code>. I recommend you to set the level as <code>Error</code>.)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Natvis: ...\Documents\Visual Studio 2019\Visualizers\Example.natvis(1,2): Fatal error:</span><br><span class="line">Expected element with namespace &#x27;http://schemas.microsoft.com/vstudio/debugger/natvis/2010&#x27;.</span><br></pre></td></tr></table></figure>

<p>So you should specify the schemas. Like this.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">AutoVisualizer</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/vstudio/debugger/natvis/2010&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">AutoVisualizer</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>And, the <code>AutoVisualizer</code> tag can have a child tag such as <code>Type</code>. The <code>Type</code> tag must have an attribute <code>Name</code>. <code>Name</code> can be set as the name of type. For example, you should type <code>SomeClass</code> at the attribute when you created a type <code>SomeClass</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SomeClass</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> ID = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    SomeClass Some01;</span><br><span class="line">    Some<span class="number">01.</span>ID = <span class="number">100</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">AutoVisualizer</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/vstudio/debugger/natvis/2010&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Type</span> <span class="attr">Name</span>=<span class="string">&quot;SomeClass&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Type</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">AutoVisualizer</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2021/03/01/unreal-engine-natvis/03.png" class="">

<p>The <code>Type</code> tag can have a child tag such <code>DisplayString/Expand</code>. The <code>DisplayString</code> tag can be used for displaying a string at the debugging window like below.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">AutoVisualizer</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/vstudio/debugger/natvis/2010&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Type</span> <span class="attr">Name</span>=<span class="string">&quot;SomeClass&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">DisplayString</span>&gt;</span></span><br><span class="line">			This is my class</span><br><span class="line">		<span class="tag">&lt;/<span class="name">DisplayString</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Type</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">AutoVisualizer</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2021/03/01/unreal-engine-natvis/04.png" class="">

<p>You can get the value of member variable. Brace the member variable as <code>&#123;&#125;</code>.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">AutoVisualizer</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/vstudio/debugger/natvis/2010&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Type</span> <span class="attr">Name</span> = <span class="string">&quot;SomeClass&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">DisplayString</span>&gt;</span></span><br><span class="line">			My ID is &#123;ID&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">DisplayString</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Type</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">AutoVisualizer</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2021/03/01/unreal-engine-natvis/05.png" class="">

<p>With the <code>Expand</code> tag, you can customize the expanded view. The <code>Item</code> tags consist of the list. If you customize the expanded view as <code>Expand</code> tag, automatically <code>Raw View</code> item created, which was the original expanded view. You can decorate each line of list in expanded view. The specifier <code>sb</code> and <code>x</code> are respectively meaning “Display the string without quotation marks” and “Display the integer with hexa-decimal format”. For more details, visit <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2015/debugger/format-specifiers-in-cpp?view=vs-2015&redirectedfrom=MSDN">reference #2</a>.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">AutoVisualizer</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/vstudio/debugger/natvis/2010&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Type</span> <span class="attr">Name</span> = <span class="string">&quot;SomeClass&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">DisplayString</span>&gt;</span></span><br><span class="line">			My ID is &#123;ID&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">DisplayString</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">Expand</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">Item</span> <span class="attr">Name</span>=<span class="string">&quot;Description&quot;</span>&gt;</span></span><br><span class="line">				&quot;Natvis is awesome&quot;, sb</span><br><span class="line">			<span class="tag">&lt;/<span class="name">Item</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">Item</span> <span class="attr">Name</span>=<span class="string">&quot;ID&quot;</span>&gt;</span></span><br><span class="line">				ID, x</span><br><span class="line">			<span class="tag">&lt;/<span class="name">Item</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">Expand</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Type</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">AutoVisualizer</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2021/03/01/unreal-engine-natvis/06.png" class="">

<h1 id="Example-in-UnrealEngine"><a href="#Example-in-UnrealEngine" class="headerlink" title="Example in UnrealEngine"></a>Example in UnrealEngine</h1><p>Let us find an example in UnrealEngine one. You can find <code>UE4.natvis</code> if you installed UnrealEngine at your local system. Mostly, the <code>UE4.natvis</code> located in <code>Engine/Extras/VisualStudioDebugging/UE4.natvis</code>.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">AutoVisualizer</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/vstudio/debugger/natvis/2010&quot;</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">&lt;!-- FString visualizer --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Type</span> <span class="attr">Name</span>=<span class="string">&quot;FString&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DisplayString</span> <span class="attr">Condition</span>=<span class="string">&quot;Data.ArrayNum == 0&quot;</span>&gt;</span>Empty<span class="tag">&lt;/<span class="name">DisplayString</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DisplayString</span> <span class="attr">Condition</span>=<span class="string">&quot;Data.ArrayNum <span class="symbol">&amp;lt;</span> 0&quot;</span>&gt;</span>Invalid<span class="tag">&lt;/<span class="name">DisplayString</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DisplayString</span> <span class="attr">Condition</span>=<span class="string">&quot;Data.ArrayMax <span class="symbol">&amp;lt;</span> Data.ArrayNum&quot;</span>&gt;</span>Invalid<span class="tag">&lt;/<span class="name">DisplayString</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DisplayString</span> <span class="attr">Condition</span>=<span class="string">&quot;Data.ArrayMax <span class="symbol">&amp;gt;</span>= Data.ArrayNum&quot;</span>&gt;</span>&#123;Data.AllocatorInstance.Data,su&#125;<span class="tag">&lt;/<span class="name">DisplayString</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">StringView</span> <span class="attr">Condition</span>=<span class="string">&quot;Data.ArrayMax <span class="symbol">&amp;gt;</span>= Data.ArrayNum&quot;</span>&gt;</span>Data.AllocatorInstance.Data,su<span class="tag">&lt;/<span class="name">StringView</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Type</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">AutoVisualizer</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>First of all, the <code>FString</code> welcomes us. Have a look for why the <code>FString</code> visualizer has been made like this. ( <code>&amp;lt;</code> and <code>&amp;gt;</code> things are escaped characters in xml. For more details, visit <a target="_blank" rel="noopener" href="https://www.ibm.com/support/knowledgecenter/SSEQTP_liberty/com.ibm.websphere.wlp.doc/ae/rwlp_xml_escape.html">reference #3</a>. )</p>
<img src="/2021/03/01/unreal-engine-natvis/07.png" class="">

<p>Put a breakpoint at where the <code>FString</code> is initialized. Before initialization, we can see <code>Invalid</code> at the debugging window.</p>
<img src="/2021/03/01/unreal-engine-natvis/08.png" class="">

<p>Expand the items. We can see the <code>ArrayNum</code> has a negative value. The condition <code>Data.ArrayNum &lt; 0</code> is satisfied and <code>Invalid</code> would be shown.</p>
<img src="/2021/03/01/unreal-engine-natvis/09.png" class="">

<p>After initialization, we can see the string very well. In this case, the condition <code>Data.ArrayMax &gt;= Data.ArrayNum</code> is satisfied and <code>L&quot;ABC&quot;</code> would be shown. Why does the string look like <code>L&quot;...&quot;</code> ? Because of the format specifier <code>su</code>. Check the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2015/debugger/format-specifiers-in-cpp?view=vs-2015&redirectedfrom=MSDN">reference #2</a> again.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Engine/Source/Runtime/Core/Public/Containers/UnrealString.h</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CORE_API</span> FString</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">struct</span> <span class="title class_">TContainerTraits</span>&lt;FString&gt;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Array holding the character data */</span></span><br><span class="line">	<span class="keyword">typedef</span> TArray&lt;TCHAR&gt; DataType;</span><br><span class="line">	DataType Data;</span><br><span class="line">	...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>The <code>FString</code> stores its string with <code>TArray&lt;TCHAR&gt;</code>. So we could see the <code>ArrayNum</code> or <code>ArrayMax</code> things at the <code>FString</code> visualizer.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Engine/Source/Runtime/Core/Public/Containers/Array.h</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> InElementType, <span class="keyword">typename</span> InAllocator&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TArray</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">template</span> &lt;<span class="keyword">typename</span> OtherInElementType, <span class="keyword">typename</span> OtherAllocator&gt;</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">class</span> <span class="title class_">TArray</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">typedef</span> <span class="keyword">typename</span> InAllocator::SizeType SizeType;</span><br><span class="line">	<span class="keyword">typedef</span> InElementType ElementType;</span><br><span class="line">	<span class="keyword">typedef</span> InAllocator   Allocator;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"></span><br><span class="line">	<span class="keyword">template</span>&lt;<span class="keyword">typename</span> ElementType, <span class="keyword">typename</span> Allocator&gt;</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">class</span> <span class="title class_">TIndirectArray</span>;</span><br><span class="line"></span><br><span class="line">	ElementAllocatorType AllocatorInstance;</span><br><span class="line">	SizeType             ArrayNum;</span><br><span class="line">	SizeType             ArrayMax;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Engine/Source/Runtime/Core/Public/Containers/ContainersFwd.h</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="type">int</span> IndexSize&gt; <span class="keyword">class</span> <span class="title class_">TSizedDefaultAllocator</span>;</span><br><span class="line"><span class="keyword">using</span> FDefaultAllocator = TSizedDefaultAllocator&lt;<span class="number">32</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> FDefaultAllocator64 = TSizedDefaultAllocator&lt;<span class="number">64</span>&gt;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FDefaultSetAllocator</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FString</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Allocator = FDefaultAllocator&gt; <span class="keyword">class</span> TArray;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Engine/Source/Runtime/Core/Public/Containers/ContainerAllocationPolicies.h</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">int</span> IndexSize&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TBitsToSizeType</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">static_assert</span>(IndexSize, <span class="string">&quot;Unsupported allocator index size.&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct</span> <span class="title class_">TBitsToSizeType</span>&lt;<span class="number">8</span>&gt;  &#123; <span class="keyword">using</span> Type = int8; &#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct</span> <span class="title class_">TBitsToSizeType</span>&lt;<span class="number">16</span>&gt; &#123; <span class="keyword">using</span> Type = int16; &#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct</span> <span class="title class_">TBitsToSizeType</span>&lt;<span class="number">32</span>&gt; &#123; <span class="keyword">using</span> Type = int32; &#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct</span> <span class="title class_">TBitsToSizeType</span>&lt;<span class="number">64</span>&gt; &#123; <span class="keyword">using</span> Type = int64; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** The indirect allocation policy always allocates the elements indirectly. */</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">int</span> IndexSize&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TSizedHeapAllocator</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">using</span> SizeType = <span class="keyword">typename</span> TBitsToSizeType&lt;IndexSize&gt;::Type;</span><br><span class="line">	...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">int</span> IndexSize&gt; <span class="keyword">class</span> <span class="title class_">TSizedDefaultAllocator</span> : <span class="keyword">public</span> TSizedHeapAllocator&lt;IndexSize&gt; &#123; <span class="keyword">public</span>: <span class="keyword">typedef</span> TSizedHeapAllocator&lt;IndexSize&gt; Typedef; &#125;;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>And you can find the type of <code>ArrayNum</code> and <code>ArrayMax</code> is <code>int32</code> with this flow.</p>
<p>Sometimes, the <code>UE4.natvis</code> gives us a hint for understanding the complicated engine code. Even someday you may need to customize <code>UE4.natvis</code> for special case while supporting various platforms. It would be also good to learn Natvis if you mostly use Visual Studio IDE. Read premade ones and write your ones. :)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2021/03/01/unreal-engine-natvis/" data-id="cmfidx74j000ycsqmfcj71bzs" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2021/03/01/unreal-engine-natvis/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Natvis/" rel="tag">Natvis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-retrospection-2020" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/12/24/retrospection-2020/" class="article-date">
  <time datetime="2020-12-24T06:09:10.000Z" itemprop="datePublished">2020-12-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/12/24/retrospection-2020/">Retrospection 2020</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="overview"><a href="#overview" class="headerlink" title="overview"></a><code>overview</code></h1><img src="/2020/12/24/retrospection-2020/01.jpg" class="">

<p>Exactly one year passed after I wrote the retrospection of 2019. (<a href="https://baemincheon.github.io/2019/12/24/retrospection-2019/">https://baemincheon.github.io/2019/12/24/retrospection-2019/</a>) Feeling that time goes so fast as I look back lots of things behind. From the god damn COVID-19 to the remote work during quarantine, we got so many things to say. But, the old year (2019) is still the hardest year to me. This year would be second one as I believe myself that I have taken plenty of breaks in this year.</p>
<p>Though the main topics of retrospection are related to worldwide crisis, I will try not to talk about it as possible. Now it is some kinda routine issue and I want to care about personal events. In addition to, other people are already saying or sharing the contents about it. I just hope this crisis ends as soon as possible and get back into old routines.</p>
<h1 id="play"><a href="#play" class="headerlink" title="play"></a><code>play</code></h1><img src="/2020/12/24/retrospection-2020/02.jpg" class="">

<p>This year, I played games most of time with Nintendo Switch. Especially, <code>Splatoon 2</code> and <code>Ring Fit Adventure</code> were the ones that I liked. <code>Splatoon 2</code> is not such a fresh game (released at 2017&#x2F;07&#x2F;21), so it was hard to enjoy multi-play contents due to other players much more skillful than me. But, its single-play contents were quite good and well structured. Therefore, I also purchased a DLC for another single-play contents. I played <code>Splatoon 2</code> about 100 hours and am pleased with the game quality. The game is not kinda “GOD GAME” thing, but I am sure it has worth to play at least once. For me, an enthusiast of FPS game, unusual concepts of this game looks nice.</p>
<img src="/2020/12/24/retrospection-2020/03.jpg" class="">

<p>I really like the <code>Ring Fit Adventure</code>. It has been so difficult to exercise funny that I used to stop exercising several times. You know, even such a strong will sustains less than few weeks or months. But, I am still keeping exercising for more than 6 months with the game. Thanks to its gamification, I seldom lost interest on exercising and sometimes got motive, too. I played <code>Ring Fit Adventure</code> about 150 hours and am pleased with the game quality. I am sure I can recommend this game if you have Nintendo Switch. And there may be only this option in these days as fitness clubs closed. Home training is not optional but required.</p>
<img src="/2020/12/24/retrospection-2020/14.jpg" class="">

<p>Oh, I almost forgot it. I played the game <code>3000th Duel</code>, too. It is a game released at PC(Steam) and Nintendo Switch. The game is said as one of Metroidvania things, because of its contents and mood. It was not easy one but there was the balance between feeling fulfilled and bearing hardship. I played <code>3000th Duel</code> about 40 hours including DLC part. Though It does not have an easy mode option such as <code>Just Enjoy The Story</code> difficulty, you can go easy or hard depends on how much you spent time at farming. It is up to you. Though there were several times that I screamed (lol) for anger, it helped me to get used to manipulating Nintendo Switch controller.</p>
<h1 id="activity"><a href="#activity" class="headerlink" title="activity"></a><code>activity</code></h1><img src="/2020/12/24/retrospection-2020/04.jpg" class="">
</br>
<img src="/2020/12/24/retrospection-2020/05.jpg" class="">

<p>Some old people may know about <code>Touhou Project</code>. It is one of vertically scrolled shooting games such as <code>Strikers 1945</code>. The game was popular on 90s and 00s for its unique worldview, which lead to numerous numbers of derivative works created by users. Some works are still created in these days although it is become less popular than before. But, almost every one is aimed for English or Japanese version not the Korean.</p>
<p>Fortunately, <code>Touhou Spell Bubble</code> has recently started to support Korean version. It was first released at 2020&#x2F;02&#x2F;06, and started to support Korean version from 2020&#x2F;10&#x2F;15. Despite of many concerns, I was happy to see the game supports Korean. (You might know, Korean market is not actually attractive.) So I was willing to visit the cafe when the game is promoted. We ordered every menu once and pictured them.</p>
<img src="/2020/12/24/retrospection-2020/06.jpg" class="">
</br>
<img src="/2020/12/24/retrospection-2020/07.jpg" class="">

<p>I remember that I mentioned the laboratory in previous retrospection. (Maybe because I did my best in lab) The professor of lab suggested me to give a lecture, whose content is about C language. I accepted the suggestion without hesitation, and wrote some slideshows. The lecture is in the first-year curriculum, however, I wanted to deal with real application of C language. Why ? Every student in 2020 may have a doubt on studying C language. Because there are already many programming languages that looks awesome and easy such as Python or Javascript.</p>
<p>So I focused on “Why We Study C Language” and “How C Language Is Used” for resolving the doubts. I prepared the contents like Explaining “Why C Language Can Manipulate Memory” with assembly codes, showing “How C Language Is Used In Real Project” with Linux kernel codes. People rarely say about them. Time has passed, we do not use C language for all purposes. I thought now we should consider to focus what only C can do when we teach C language to students.</p>
<h1 id="work"><a href="#work" class="headerlink" title="work"></a><code>work</code></h1><img src="/2020/12/24/retrospection-2020/09.jpg" class="">
</br>
<img src="/2020/12/24/retrospection-2020/10.jpg" class="">
</br>
<img src="/2020/12/24/retrospection-2020/11.jpg" class="">

<p>Already one year passed from join the PUBG. Exactly 1.5 year ? I am now familiar to my work, and even got the sub role additionally. We had an anniversary cake with people who joined PUBG in the same time, too. Work is not easy going, but we try to do boost each other and overcome it. I wish I can go with the people as many as can also even one year passed again. It is sad that now we cannot get together in offline due to the crisis. We had often got together once per 1~2 months, and had a dinner. I already miss that times.</p>
<p>Starting remote work, I found some pros and cons. Remote work seems not the silver bullet one in every situation. Of course, there are common topics on remote work regardless of job. But, some topics are unique ones only existing on game developer job. I can show cons below:</p>
<p><em>Common Topics</em></p>
<ul>
<li>chores that did not exist when you commute to office<br>(ex: cooking, managing workplace)</li>
<li>hardness to know about work mood<br>(ex: are they excited ? are they angry ?)</li>
<li>irregular work time with personal circumstances<br>(ex: family with kids)</li>
</ul>
<p><em>Extra Topics (for game developer job)</em></p>
<ul>
<li>heavy traffic due to massive volume of program<br>(it is painful at home network to upload or download programs when compared with office network)</li>
<li>laggy remote screen sharing<br>(game developer should usually run the client program, while it is okay other developers use only console prompt)</li>
<li>poor response time on input or output<br>(when the game is  kind of real time game…)</li>
</ul>
<img src="/2020/12/24/retrospection-2020/13.png" class="">
</br>
<img src="/2020/12/24/retrospection-2020/12.jpg" class="">

<p>Play Station 5 has been released in recent. Sony planned to celebrate the event with partner companies, and collected the picture of members. I sent the picture above, and you can find it on the site <a target="_blank" rel="noopener" href="https://sie.offbaseproductions.com/">https://sie.offbaseproductions.com/</a> too. It is something monumental and memorable. Sony did good job. I was glad to develop on PS5. :)</p>
<h1 id="thoughts"><a href="#thoughts" class="headerlink" title="thoughts"></a><code>thoughts</code></h1><img src="/2020/12/24/retrospection-2020/08.jpg" class="">

<p>This year, I leave some regrets that I should have done more things. I should have met more people and read books. But…the lethargy from the crisis, everyone may have felt this. I cannot assert it did not affect me. People around me seems sometimes sad and depressed, too. What was worse, we end up this year as bad situation with high amount of patients. It is hard to believe next year would be better.</p>
<p>Somebody said, “The World Never Be The Same”. At first of this year, I did not agree the words. Because I could not imagine the new world. But…we going to the new world anyway, and it seems we must adapt. Even this year is said the most terrible one, I think we should remember it. To look back to stop this tragedy. We gotta be worry about how to adapt new world and how to live next year, based on new rules.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2020/12/24/retrospection-2020/" data-id="cmfidx74m001hcsqm75md0cfo" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2020/12/24/retrospection-2020/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Retrospection/" rel="tag">Retrospection</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-unreal-input-system-via-gamepad" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/10/25/unreal-input-system-via-gamepad/" class="article-date">
  <time datetime="2020-10-25T09:11:09.000Z" itemprop="datePublished">2020-10-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/25/unreal-input-system-via-gamepad/">Gamepad input process in UnrealEngine</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>this post covers<ul>
<li>key mapping of Xbox One controller in UnrealEngine</li>
<li>how UnrealEngine handles input from user</li>
<li>input process for gamepad (with Xbox One controller)</li>
</ul>
</li>
<li>environment<ul>
<li>Unreal Engine 4 <code>ver. 4.25</code></li>
<li>Visual Studio 2019 <code>ver. 16.7.6</code></li>
<li>Windows 10 <code>ver. 2004</code></li>
</ul>
</li>
<li>reference<ol>
<li><a target="_blank" rel="noopener" href="https://support.xbox.com/en-US/help/hardware-network/controller/xbox-one-wireless-controller">https://support.xbox.com/en-US/help/hardware-network/controller/xbox-one-wireless-controller</a></li>
</ol>
</li>
</ul>
<hr>
<h1 id="Terms"><a href="#Terms" class="headerlink" title="Terms"></a><em>Terms</em></h1><table>
<thead>
<tr>
<th>Term</th>
<th>Synonym</th>
<th>Meaning</th>
</tr>
</thead>
<tbody><tr>
<td>Non-Axis</td>
<td>Key, Button</td>
<td>input type which has only two states: <code>Pressed</code> or <code>Released</code></td>
</tr>
<tr>
<td>Axis</td>
<td>Stick</td>
<td>input type which has numberless states</td>
</tr>
<tr>
<td>Key</td>
<td></td>
<td>(sometimes) it is used for indicating any input type. be careful with context for distinction of <code>Non-Axis</code></td>
</tr>
<tr>
<td>Deadzone</td>
<td>Threshold</td>
<td>range of input values, which blocks values in range. only bigger value cannot be blocked</td>
</tr>
</tbody></table>
<h1 id="Gamepad-Non-Axis-x2F-Axis-Mapping-in-UnrealEngine"><a href="#Gamepad-Non-Axis-x2F-Axis-Mapping-in-UnrealEngine" class="headerlink" title="Gamepad Non-Axis&#x2F;Axis Mapping in UnrealEngine"></a><em>Gamepad Non-Axis&#x2F;Axis Mapping in UnrealEngine</em></h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">UnrealEngine/Engine/Source/Runtime/Core/Private/GenericPlatform/GenericApplication.cpp</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="function"><span class="type">const</span> FGamepadKeyNames::Type <span class="title">FGamepadKeyNames::LeftAnalogX</span><span class="params">(<span class="string">&quot;Gamepad_LeftX&quot;</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> FGamepadKeyNames::Type <span class="title">FGamepadKeyNames::LeftAnalogY</span><span class="params">(<span class="string">&quot;Gamepad_LeftY&quot;</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> FGamepadKeyNames::Type <span class="title">FGamepadKeyNames::RightAnalogX</span><span class="params">(<span class="string">&quot;Gamepad_RightX&quot;</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> FGamepadKeyNames::Type <span class="title">FGamepadKeyNames::RightAnalogY</span><span class="params">(<span class="string">&quot;Gamepad_RightY&quot;</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> FGamepadKeyNames::Type <span class="title">FGamepadKeyNames::LeftTriggerAnalog</span><span class="params">(<span class="string">&quot;Gamepad_LeftTriggerAxis&quot;</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> FGamepadKeyNames::Type <span class="title">FGamepadKeyNames::RightTriggerAnalog</span><span class="params">(<span class="string">&quot;Gamepad_RightTriggerAxis&quot;</span>)</span></span>;</span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>we can find some pre-defined non-axis&#x2F;axis keys as <code>FName</code> in <code>GenericApplication.cpp</code>. they are for mapping from various input messages to generic input messages. “various input messages” means, there are many types of gamepad in the world. the button&#x2F;stick layout differs in Xbox One controller, Playstation 4 controller and so on. the gamepads below are Xbox One, Playstation 4, Stadia and Switch in order.</p>
<img src="/2020/10/25/unreal-input-system-via-gamepad/01.jpg" class="">
<img src="/2020/10/25/unreal-input-system-via-gamepad/02.jpg" class="">
<img src="/2020/10/25/unreal-input-system-via-gamepad/03.png" class="">
<img src="/2020/10/25/unreal-input-system-via-gamepad/04.jpg" class="">

<p>look at the Xbox One one and Playstation 4 one. they have many differences such as position of stick and exsitance of touch pad. even in comparison for Xbox One one and Switch one, the number of buttons differs. in this situation, it is not easy for every individual developer to support every type of gamepad, so the need of generic mapping for gamepad input arises. let us find out the generic mapping with Xbox One controller examples.</p>
<img src="/2020/10/25/unreal-input-system-via-gamepad/06.png" class="">
<img src="/2020/10/25/unreal-input-system-via-gamepad/07.png" class="">

<p>the tables are from the <a target="_blank" rel="noopener" href="https://support.xbox.com/en-US/help/hardware-network/controller/xbox-one-wireless-controller">reference #1</a>. you can find more details for each button&#x2F;stick at the URL. though there are so many items in table, some of them are not counted as user input in common situation. so, we can gotta consider the items below:</p>
<table>
<thead>
<tr>
<th>Index</th>
<th>Item Name</th>
<th>Unreal Mapping</th>
<th>Input Type</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Left Stick</td>
<td>(Move Horizontally) Gamepad_LeftX</td>
<td>Key, Axis</td>
</tr>
<tr>
<td></td>
<td>(Move Vertically) Gamepad_LeftY</td>
<td>Key, Axis</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Move Left Side More Than Deadzone) Gamepad_LeftStick_Left</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Move Up Side More Than Deadzone) Gamepad_LeftStick_Up</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Move Right Side More Than Deadzone) Gamepad_LeftStick_Up</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Move Down Side More Than Deadzone) Gamepad_LeftStick_Down</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Click) Gamepad_LeftThumbstick</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>Left Bumper</td>
<td>Gamepad_LeftShoulder</td>
<td>Key</td>
</tr>
<tr>
<td>3</td>
<td>View Button</td>
<td>Gamepad_Special_Left</td>
<td>Key</td>
</tr>
<tr>
<td>6</td>
<td>Menu Button</td>
<td>Gamepad_Special_Right</td>
<td>Key</td>
</tr>
<tr>
<td>7</td>
<td>Right Bumper</td>
<td>Gamepad_RightShoulder</td>
<td>Key</td>
</tr>
<tr>
<td>8</td>
<td>Directional Pad</td>
<td>(Left) Gamepad_DPad_Left</td>
<td>Key</td>
</tr>
<tr>
<td></td>
<td>(Up) Gamepad_DPad_Up</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Right) Gamepad_DPad_Right</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Down) Gamepad_DPad_Down</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>Right Stick</td>
<td>(Move Horizontally) Gamepad_RightX</td>
<td>Key, Axis</td>
</tr>
<tr>
<td></td>
<td>(Move Vertically) Gamepad_RightY</td>
<td>Key, Axis</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Move Left Side More Than Deadzone) Gamepad_RightStick_Left</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Move Up Side More Than Deadzone) Gamepad_RightStick_Up</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Move Right Side More Than Deadzone) Gamepad_RightStick_Up</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Move Down Side More Than Deadzone) Gamepad_RightStick_Down</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td></td>
<td>(Click) Gamepad_RightThumbstick</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>Right Trigger</td>
<td>Gamepad_RightTriggerAxis</td>
<td>Key, Axis</td>
</tr>
<tr>
<td></td>
<td>(Press More Than Deadzone) Gamepad_RightTrigger</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td>14</td>
<td>Left Trigger</td>
<td>Gamepad_LeftTriggerAxis</td>
<td>Key, Axis</td>
</tr>
<tr>
<td></td>
<td>(Press More Than Deadzone) Gamepad_LeftTrigger</td>
<td>Key</td>
<td></td>
</tr>
<tr>
<td>X</td>
<td>X Button</td>
<td>Gamepad_FaceButton_Left</td>
<td>Key</td>
</tr>
<tr>
<td>Y</td>
<td>Y Button</td>
<td>Gamepad_FaceButton_Up</td>
<td>Key</td>
</tr>
<tr>
<td>A</td>
<td>A Button</td>
<td>Gamepad_FaceButton_Bottom</td>
<td>Key</td>
</tr>
<tr>
<td>B</td>
<td>B Button</td>
<td>Gamepad_FaceButton_Right</td>
<td>Key</td>
</tr>
</tbody></table>
<p>some of them are handled as not only Key but Axis, too.</p>
<img src="/2020/10/25/unreal-input-system-via-gamepad/08.png" class="">
</br>
<img src="/2020/10/25/unreal-input-system-via-gamepad/09.png" class="">

<ul>
<li>the <code>Gamepad_LeftY</code> is the one of cases</li>
</ul>
<h1 id="Gamepad-Non-Axis-Input-Handling-Process"><a href="#Gamepad-Non-Axis-Input-Handling-Process" class="headerlink" title="Gamepad Non-Axis Input Handling Process"></a><em>Gamepad Non-Axis Input Handling Process</em></h1><img src="/2020/10/25/unreal-input-system-via-gamepad/10.png" class="">

<p>focus the function <code>XInputInterface::SendControllerEvents()</code>. there is the logic to filter hardware input state.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">UnrealEngine/Engine/Source/Runtime/ApplicationCore/Private/Windows/XInputInterface.cpp</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">XInputInterface::SendControllerEvents</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">0</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_A);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">1</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_B);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">2</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_X);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">3</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_Y);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">4</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_LEFT_SHOULDER);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">5</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_RIGHT_SHOULDER);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">6</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_BACK);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">7</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_START);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">8</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_LEFT_THUMB);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">9</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_RIGHT_THUMB);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">10</span>]] = !!(XInputState.Gamepad.bLeftTrigger &gt; XINPUT_GAMEPAD_TRIGGER_THRESHOLD);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">11</span>]] = !!(XInputState.Gamepad.bRightTrigger &gt; XINPUT_GAMEPAD_TRIGGER_THRESHOLD);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">12</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_DPAD_UP);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">13</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_DPAD_DOWN);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">14</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_DPAD_LEFT);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">15</span>]] = !!(XInputState.Gamepad.wButtons &amp; XINPUT_GAMEPAD_DPAD_RIGHT);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">16</span>]] = !!(XInputState.Gamepad.sThumbLY &gt; XINPUT_GAMEPAD_LEFT_THUMB_DEADZONE);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">17</span>]] = !!(XInputState.Gamepad.sThumbLY &lt; -XINPUT_GAMEPAD_LEFT_THUMB_DEADZONE);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">18</span>]] = !!(XInputState.Gamepad.sThumbLX &lt; -XINPUT_GAMEPAD_LEFT_THUMB_DEADZONE);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">19</span>]] = !!(XInputState.Gamepad.sThumbLX &gt; XINPUT_GAMEPAD_LEFT_THUMB_DEADZONE);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">20</span>]] = !!(XInputState.Gamepad.sThumbRY &gt; XINPUT_GAMEPAD_RIGHT_THUMB_DEADZONE);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">21</span>]] = !!(XInputState.Gamepad.sThumbRY &lt; -XINPUT_GAMEPAD_RIGHT_THUMB_DEADZONE);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">22</span>]] = !!(XInputState.Gamepad.sThumbRX &lt; -XINPUT_GAMEPAD_RIGHT_THUMB_DEADZONE);</span><br><span class="line">    CurrentStates[X360ToXboxControllerMapping[<span class="number">23</span>]] = !!(XInputState.Gamepad.sThumbRX &gt; XINPUT_GAMEPAD_RIGHT_THUMB_DEADZONE);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>the next screenshot shows the value of <code>CurrentStates</code> when you press A button in Xbox One gamepad.</p>
<img src="/2020/10/25/unreal-input-system-via-gamepad/11.png" class="">

<p>we can see the key, deadzone or threshold macro in the code. the macros are defined at <code>XInput.h</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">C:/<span class="function">Program <span class="title">Files</span> <span class="params">(x86)</span>/Windows Kits/10/Include/10.0.18362.0/um/XInput.h</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">...</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">//</span></span></span><br><span class="line"><span class="function"><span class="comment">// Constants for gamepad buttons</span></span></span><br><span class="line"><span class="function"><span class="comment">//</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_DPAD_UP          0x0001</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_DPAD_DOWN        0x0002</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_DPAD_LEFT        0x0004</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_DPAD_RIGHT       0x0008</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_START            0x0010</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_BACK             0x0020</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_LEFT_THUMB       0x0040</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_RIGHT_THUMB      0x0080</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_LEFT_SHOULDER    0x0100</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_RIGHT_SHOULDER   0x0200</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_A                0x1000</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_B                0x2000</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_X                0x4000</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_Y                0x8000</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">//</span></span></span><br><span class="line"><span class="function"><span class="comment">// Gamepad thresholds</span></span></span><br><span class="line"><span class="function"><span class="comment">//</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_LEFT_THUMB_DEADZONE  7849</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_RIGHT_THUMB_DEADZONE 8689</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> XINPUT_GAMEPAD_TRIGGER_THRESHOLD    30</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">...</span></span><br></pre></td></tr></table></figure>

<p>there is an exception case for input smaller than deadzone. let us take an example with <code>Gamepad_LeftX</code> message. check out screenshots below.</p>
<img src="/2020/10/25/unreal-input-system-via-gamepad/12.png" class="">

<p>when you input a tiny change on left stick, <code>InputAxis()</code> is called. and the key will be accumulated in <code>EventAccumulator</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">UnrealEngine/Engine/Source/Runtime/Engine/Private/UserInterface/PlayerInput.cpp</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UPlayerInput::ProcessInputStack</span><span class="params">(...)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Exchange</span>(KeyState-&gt;EventCounts[EventIndex], KeyState-&gt;EventAccumulator[EventIndex]);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>after that, the key in <code>EventAccumulator</code> is moved to <code>EventCounts</code>.</p>
<img src="/2020/10/25/unreal-input-system-via-gamepad/13.png" class="">

<p>if you keep operating the stick, the key is regarded as down.</p>
<img src="/2020/10/25/unreal-input-system-via-gamepad/14.png" class="">

<p>in this situation, the key is regarded as released if all keys are flushed.</p>
<img src="/2020/10/25/unreal-input-system-via-gamepad/15.png" class="">

<h1 id="Gamepad-Axis-Input-Handling-Process"><a href="#Gamepad-Axis-Input-Handling-Process" class="headerlink" title="Gamepad Axis Input Handling Process"></a><em>Gamepad Axis Input Handling Process</em></h1><p>the callstack of Axis one is similar to the Non-Axis one. there is a difference of execution at <code>XInputInterface::SendControllerEvents()</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">UnrealEngine/Engine/Source/Runtime/ApplicationCore/Private/Windows/XInputInterface.cpp</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">XInputInterface::SendControllerEvents</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Send new analog data if it&#x27;s different or outside the platform deadzone.</span></span><br><span class="line">    <span class="keyword">auto</span> OnControllerAnalog = [<span class="keyword">this</span>, &amp;ControllerState](<span class="type">const</span> FName&amp; GamePadKey, <span class="type">const</span> <span class="keyword">auto</span> NewAxisValue, <span class="type">const</span> <span class="type">float</span> NewAxisValueNormalized, <span class="keyword">auto</span>&amp; OldAxisValue, <span class="type">const</span> <span class="keyword">auto</span> DeadZone) &#123;</span><br><span class="line">        <span class="keyword">if</span> (OldAxisValue != NewAxisValue || FMath::<span class="built_in">Abs</span>((int32)NewAxisValue) &gt; DeadZone)</span><br><span class="line">        &#123;</span><br><span class="line">            MessageHandler-&gt;<span class="built_in">OnControllerAnalog</span>(GamePadKey, ControllerState.ControllerId, NewAxisValueNormalized);</span><br><span class="line">        &#125;</span><br><span class="line">        OldAxisValue = NewAxisValue;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span>&amp; Gamepad = XInputState.Gamepad;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">OnControllerAnalog</span>(FGamepadKeyNames::LeftAnalogX, Gamepad.sThumbLX, <span class="built_in">ShortToNormalizedFloat</span>(Gamepad.sThumbLX), ControllerState.LeftXAnalog, XINPUT_GAMEPAD_LEFT_THUMB_DEADZONE);</span><br><span class="line">    <span class="built_in">OnControllerAnalog</span>(FGamepadKeyNames::LeftAnalogY, Gamepad.sThumbLY, <span class="built_in">ShortToNormalizedFloat</span>(Gamepad.sThumbLY), ControllerState.LeftYAnalog, XINPUT_GAMEPAD_LEFT_THUMB_DEADZONE);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">OnControllerAnalog</span>(FGamepadKeyNames::RightAnalogX, Gamepad.sThumbRX, <span class="built_in">ShortToNormalizedFloat</span>(Gamepad.sThumbRX), ControllerState.RightXAnalog, XINPUT_GAMEPAD_RIGHT_THUMB_DEADZONE);</span><br><span class="line">    <span class="built_in">OnControllerAnalog</span>(FGamepadKeyNames::RightAnalogY, Gamepad.sThumbRY, <span class="built_in">ShortToNormalizedFloat</span>(Gamepad.sThumbRY), ControllerState.RightYAnalog, XINPUT_GAMEPAD_RIGHT_THUMB_DEADZONE);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">OnControllerAnalog</span>(FGamepadKeyNames::LeftTriggerAnalog, Gamepad.bLeftTrigger, Gamepad.bLeftTrigger / <span class="number">255.f</span>, ControllerState.LeftTriggerAnalog, XINPUT_GAMEPAD_TRIGGER_THRESHOLD);</span><br><span class="line">    <span class="built_in">OnControllerAnalog</span>(FGamepadKeyNames::RightTriggerAnalog, Gamepad.bRightTrigger, Gamepad.bRightTrigger / <span class="number">255.f</span>, ControllerState.RightTriggerAnalog, XINPUT_GAMEPAD_TRIGGER_THRESHOLD);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>in this case, <code>OnControllerAnalog()</code> is called even a tiny change of input value exists. because the code compares with <code>OldAxisValue != NewAxisValue</code>. the function will not be called only when there is no change on input value.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baemincheon.github.io/2020/10/25/unreal-input-system-via-gamepad/" data-id="cmfidx74n001kcsqm4fdlc1mk" class="article-share-link">Share</a>
      
        <a href="https://baemincheon.github.io/2020/10/25/unreal-input-system-via-gamepad/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/" rel="tag">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/About/" rel="tag">About</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Animation/" rel="tag">Animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blueprint/" rel="tag">Blueprint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CPP/" rel="tag">CPP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cat/" rel="tag">Cat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Copy/" rel="tag">Copy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DigitalOcean/" rel="tag">DigitalOcean</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GCC/" rel="tag">GCC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GoogleAnalytics/" rel="tag">GoogleAnalytics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Home/" rel="tag">Home</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Iptime/" rel="tag">Iptime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lecture/" rel="tag">Lecture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MSVC/" rel="tag">MSVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Migration/" rel="tag">Migration</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Natvis/" rel="tag">Natvis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Network/" rel="tag">Network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Perforce/" rel="tag">Perforce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Retargeting/" rel="tag">Retargeting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Retrospection/" rel="tag">Retrospection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RichTextBlock/" rel="tag">RichTextBlock</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STL/" rel="tag">STL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TextBlock/" rel="tag">TextBlock</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TextWrap/" rel="tag">TextWrap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/" rel="tag">Ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UnrealEngine/" rel="tag">UnrealEngine</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WSL/" rel="tag">WSL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AI/" style="font-size: 10px;">AI</a> <a href="/tags/About/" style="font-size: 10px;">About</a> <a href="/tags/Animation/" style="font-size: 10px;">Animation</a> <a href="/tags/Blueprint/" style="font-size: 13.33px;">Blueprint</a> <a href="/tags/CPP/" style="font-size: 13.33px;">CPP</a> <a href="/tags/Cat/" style="font-size: 10px;">Cat</a> <a href="/tags/Copy/" style="font-size: 10px;">Copy</a> <a href="/tags/DigitalOcean/" style="font-size: 10px;">DigitalOcean</a> <a href="/tags/GCC/" style="font-size: 10px;">GCC</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/GoogleAnalytics/" style="font-size: 10px;">GoogleAnalytics</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Home/" style="font-size: 10px;">Home</a> <a href="/tags/Iptime/" style="font-size: 10px;">Iptime</a> <a href="/tags/Lecture/" style="font-size: 10px;">Lecture</a> <a href="/tags/Linux/" style="font-size: 13.33px;">Linux</a> <a href="/tags/MSVC/" style="font-size: 10px;">MSVC</a> <a href="/tags/Migration/" style="font-size: 10px;">Migration</a> <a href="/tags/Natvis/" style="font-size: 10px;">Natvis</a> <a href="/tags/Network/" style="font-size: 10px;">Network</a> <a href="/tags/Perforce/" style="font-size: 13.33px;">Perforce</a> <a href="/tags/Retargeting/" style="font-size: 10px;">Retargeting</a> <a href="/tags/Retrospection/" style="font-size: 16.67px;">Retrospection</a> <a href="/tags/RichTextBlock/" style="font-size: 10px;">RichTextBlock</a> <a href="/tags/STL/" style="font-size: 10px;">STL</a> <a href="/tags/TextBlock/" style="font-size: 13.33px;">TextBlock</a> <a href="/tags/TextWrap/" style="font-size: 10px;">TextWrap</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/UnrealEngine/" style="font-size: 20px;">UnrealEngine</a> <a href="/tags/WSL/" style="font-size: 13.33px;">WSL</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">September 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/09/09/introduction-to-ai-with-xor-problem/">introduction to AI with XOR problem</a>
          </li>
        
          <li>
            <a href="/2024/05/13/difference-between-copy-and-cat-in-combining-files/">Difference between copy and cat in combining files</a>
          </li>
        
          <li>
            <a href="/2023/12/04/migration-from-perforce-into-git-in-windows/">Migration from Perforce into Git in Windows</a>
          </li>
        
          <li>
            <a href="/2023/04/10/conversion-from-universal-analytics-into-google-analytics-4/">Conversion from UA into GA4</a>
          </li>
        
          <li>
            <a href="/2022/12/12/promotion-for-online-lecture-of-unrealengine-01/">The promotion for online lecture of UnrealEngine</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2025 MinCheon Bae<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/2020/02/03/home-page/index.html" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'let-us-go-abroad';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>